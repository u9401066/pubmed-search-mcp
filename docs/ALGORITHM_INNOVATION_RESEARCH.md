# PubMed Search MCP â€” æ¼”ç®—æ³•å‰µæ–°å·®è·åˆ†æèˆ‡æå‡ç ”ç©¶

> **æ–‡ä»¶æ€§è³ª**: å…§éƒ¨ç ”ç©¶æ–‡ä»¶  
> **ç‹€æ…‹**: åˆç¨¿ v1.3  
> **ç›®çš„**: èª å¯¦è©•ä¼°ç¾æœ‰æ¼”ç®—æ³•æ·±åº¦ï¼Œè­˜åˆ¥å­¸è¡“å‰µæ–°æ©Ÿæœƒï¼Œè¦åŠƒæå‡è·¯ç·š  
> **å»ºç«‹æ—¥æœŸ**: 2026-02-12  
> **æœ€å¾Œæ›´æ–°**: 2026-02-15  
> **ç¶­è­·è€…**: Eric

---

## ğŸ“‹ ç›®éŒ„

1. [å‹•æ©Ÿèˆ‡èƒŒæ™¯](#1-å‹•æ©Ÿèˆ‡èƒŒæ™¯)
2. [æ ¹æœ¬ç—›é»ï¼šçµæœä¸å¯æ¶ˆåŒ– Ã— æœå°‹é–“ç„¡è¨˜æ†¶](#2-æ ¹æœ¬ç—›é»çµæœä¸å¯æ¶ˆåŒ–--æœå°‹é–“ç„¡è¨˜æ†¶)
3. [ç¾ç‹€èª å¯¦è©•ä¼°](#3-ç¾ç‹€èª å¯¦è©•ä¼°)
4. [å­¸è¡“å‰µæ–°æ©Ÿæœƒ](#4-å­¸è¡“å‰µæ–°æ©Ÿæœƒ)
5. [æœå°‹è©å·®ç•°åˆ†æï¼šæ¼”ç®—æ³•æ·±å…¥æ¢è¨](#5-æœå°‹è©å·®ç•°åˆ†ææ¼”ç®—æ³•æ·±å…¥æ¢è¨)
6. [å¯¦æ–½è·¯ç·šåœ–](#6-å¯¦æ–½è·¯ç·šåœ–)
7. [é©—è­‰æ–¹æ³•è«–](#7-é©—è­‰æ–¹æ³•è«–)
8. [ç›¸é—œæ–‡ç»](#8-ç›¸é—œæ–‡ç»)
9. [Technical Specï¼šSearch Rank Fusion & Diff Engine](#9-technical-specsearch-rank-fusion--diff-engine)

---

## 1. å‹•æ©Ÿèˆ‡èƒŒæ™¯

### 1.1 æ ¸å¿ƒå•é¡Œ

> **ã€Œæˆ‘å€‘ç›®å‰é‚„æœ‰å“ªäº›æ˜¯å­¸è¡“å‰µæ–°ï¼Ÿåªæ˜¯åŒ…è£å¤šå€‹æœå°‹ API ä¸¦ä¸”è®“ Agent ä½¿ç”¨å°±ç®—ï¼Ÿæœå°‹æ–¹æ³•ä¹Ÿæ˜¯æ“´å……é—œéµå­— + é€šç”¨å­—è© â€” æœ‰æ¼”ç®—æ³•å¯ä»¥æ›´é«˜æ•ˆçš„æ‰¾å‡ºæœå°‹è©ä¹‹é–“çš„å·®ç•°ï¼Ÿã€**

é€™æ˜¯ä¸€å€‹å¿…é ˆèª å¯¦é¢å°çš„å•é¡Œã€‚æœ¬æ–‡ä»¶æ—¨åœ¨ï¼š

1. **å®¢è§€ç›¤é»**ç¾æœ‰ç³»çµ±ä¸­å“ªäº›çµ„ä»¶æœ‰æ¼”ç®—æ³•æ·±åº¦ã€å“ªäº›åªæ˜¯ API åŒ…è£
2. **è­˜åˆ¥å·®è·**èˆ‡å­¸è¡“æ°´æº–çš„è³‡è¨Šæª¢ç´¢ï¼ˆIRï¼‰ç ”ç©¶ä¹‹é–“çš„è·é›¢
3. **æå‡ºå…·é«”æ¼”ç®—æ³•**å¯ä»¥å¸¶ä¾†çœŸæ­£çš„å­¸è¡“å‰µæ–°
4. **èšç„¦æœå°‹è©å·®ç•°åˆ†æ**ä½œç‚ºä¸€å€‹è¢«å¿½è¦–ä½†é«˜åƒ¹å€¼çš„æ–¹å‘

### 1.2 ç«¶å“å°æ¯”ä¸­çš„å®šä½

| å·¥å…· | å¤šæºæ•´åˆ | æ¼”ç®—æ³•æ’åº | å¼•ç”¨åˆ†æ | æœå°‹è©åˆ†æ | æ™‚é–“è»¸ |
|------|:--------:|:---------:|:--------:|:---------:|:------:|
| paper-search-mcp (643â˜…) | âœ… 8æº | âŒ | âŒ | âŒ | âŒ |
| BioMCP (413â˜…) | âœ… 10æº | âŒ | âŒ | âŒ | âŒ |
| papersgpt-for-zotero (2kâ˜…) | âŒ | âœ… BM25 | âŒ | âŒ | âŒ |
| zotero-mcp (751â˜…) | âŒ | âœ… Embeddings | âŒ | âŒ | âŒ |
| **PubMed-Search-MCP** | âœ… 6æº | âš ï¸ term overlap | âš ï¸ BFS only | âŒ | âœ… |

**çµè«–**ï¼šæˆ‘å€‘åœ¨å¤šæºæ•´åˆå’Œæ™‚é–“è»¸ä¸Šé ˜å…ˆï¼Œä½†**æ’åºæ¼”ç®—æ³•å’Œå¼•ç”¨åˆ†ææ˜¯æ˜ç¢ºå¼±é»**ã€‚

---

## 2. æ ¹æœ¬ç—›é»ï¼šçµæœä¸å¯æ¶ˆåŒ– Ã— æœå°‹é–“ç„¡è¨˜æ†¶

> **ã€Œæœå°‹è¿”å›äº† 10,000 ç¯‡çµæœ â€” Agent ä¹Ÿä¸å¯èƒ½é¦¬ä¸Šè®€å®Œï¼›æ›ä¸€å€‹æœå°‹è©è¿”å› 5,000 ç¯‡ â€” Agent ä¹Ÿä¸çŸ¥é“å·®ç•°ã€‚æ‰€ä»¥æ¯æ¬¡çš„æœå°‹åªæ˜¯åœ¨ä¸åŒçš„å¤§æµ·ä¸­æ’ˆé‡ï¼ã€**

åœ¨è¨è«–æ¼”ç®—æ³•å‡ç´šä¹‹å‰ï¼Œå¿…é ˆå…ˆé¢å°ä¸€å€‹æ›´æ ¹æœ¬çš„å•é¡Œï¼š**å³ä½¿æ’åºåšåˆ°å®Œç¾ï¼ŒAgent ä¹Ÿç„¡æ³•æ¶ˆåŒ–å¤§é‡çµæœï¼Œè€Œå¤šè¼ªæœå°‹ä¹‹é–“æ²’æœ‰èªçŸ¥é€£çºŒæ€§**ã€‚é€™æ¯”ã€Œæ’åºä¸å¤ å¥½ã€æ›´æ ¹æœ¬ã€æ›´è‡´å‘½ã€‚

### 2.1 ç—›é»è§£å‰–ï¼šä¸‰å€‹å±¤æ¬¡çš„å•é¡Œ

#### ç—›é» 1ï¼šçµæœä¸å¯æ¶ˆåŒ–ï¼ˆInformation Overloadï¼‰

```
ç¾ç‹€çš„è’è¬¬ï¼š

æœå°‹ "remimazolam sedation" â†’ 10,247 ç¯‡
  â”œâ”€â”€ PubMed API è¿”å›å‰ 100 ç¯‡ PMID
  â”œâ”€â”€ æˆ‘å€‘ fetch å‰ 20 ç¯‡çš„ title + abstract
  â”œâ”€â”€ Agent çš„ context window èƒ½è£ ~10 ç¯‡å®Œæ•´ abstract
  â””â”€â”€ Agent å¯¦éš›ã€Œçœ‹åˆ°ã€çš„ï¼š10 / 10,247 = 0.097%

å•é¡Œï¼š
  â‘  99.9% çš„æœå°‹çµæœæ˜¯ã€Œä¸å­˜åœ¨ã€çš„ â€” Agent å®Œå…¨ä¸çŸ¥é“å®ƒå€‘
  â‘¡ å‰ 10 ç¯‡ä¸ä¸€å®šæ˜¯ã€Œæœ€è©²çœ‹çš„ã€ â€” PubMed çš„ relevance æ˜¯å…¨åŸŸæ’åï¼Œä¸é‡å°ä½ çš„ç ”ç©¶å•é¡Œ
  â‘¢ 10 ç¯‡çš„ title + abstract ä¹Ÿæ˜¯ç·šæ€§åˆ—è¡¨ â€” Agent æ²’æœ‰å…¨å±€æ¦‚è¦½
  â‘£ Agent ç„¡æ³•å›ç­”ã€Œé€™å€‹é ˜åŸŸå¤§æ¦‚åœ¨ç ”ç©¶ä»€éº¼ï¼Ÿã€åªèƒ½å›ç­”ã€Œé€™ 10 ç¯‡åœ¨ç ”ç©¶ä»€éº¼ã€
```

**é‡åŒ–å•é¡Œçš„åš´é‡åº¦**ï¼š

| æœå°‹çµæœé‡ | Agent å¯¦éš›çœ‹åˆ° | è¦†è“‹ç‡ | éºæ¼é¢¨éšª |
|:----------:|:--------------:|:------:|:--------:|
| 100 ç¯‡ | 10 ç¯‡ | 10% | ä¸­ |
| 1,000 ç¯‡ | 10 ç¯‡ | 1% | é«˜ |
| 10,000 ç¯‡ | 10 ç¯‡ | 0.1% | æ¥µé«˜ |
| 100,000 ç¯‡ | 10 ç¯‡ | 0.01% | è¿‘ä¹éš¨æ©Ÿ |

ç•¶çµæœè¶…é 1,000 ç¯‡æ™‚ï¼ŒAgent å±•ç¤ºçµ¦ç”¨æˆ¶çš„ 10 ç¯‡æœ¬è³ªä¸Šæ˜¯**ä¸€å€‹æœªç¶“é©—è­‰çš„æŠ½æ¨£**ï¼Œè€Œéæœ‰æ„ç¾©çš„ç²¾é¸ã€‚

#### ç—›é» 2ï¼šæœå°‹é–“ç„¡èªçŸ¥é€£çºŒæ€§ï¼ˆNo Cross-Search Memoryï¼‰

```
å ´æ™¯ï¼šç ”ç©¶è€…é€²è¡Œ 3 è¼ªæœå°‹

ç¬¬ 1 è¼ª: "remimazolam sedation"          â†’ 10,247 ç¯‡ â†’ Agent çœ‹ 10 ç¯‡
ç¬¬ 2 è¼ª: "CNS 7056 ICU"                  â†’  5,123 ç¯‡ â†’ Agent çœ‹ 10 ç¯‡
ç¬¬ 3 è¼ª: "remimazolam vs propofol safety" â†’  3,456 ç¯‡ â†’ Agent çœ‹ 10 ç¯‡

å•é¡Œï¼š
  â‘  ç¬¬ 2 è¼ªçš„ 10 ç¯‡ä¸­ï¼Œå¯èƒ½æœ‰ 6 ç¯‡ç¬¬ 1 è¼ªå·²ç¶“çœ‹é â†’ æµªè²» 60% çš„ context
  â‘¡ ç¬¬ 1 è¼ªæœ‰ 10,247 ç¯‡ã€ç¬¬ 2 è¼ªæœ‰ 5,123 ç¯‡ï¼Œé‡ç–Šå¤šå°‘ï¼Ÿâ€” ä¸çŸ¥é“
  â‘¢ ç¬¬ 2 è¼ªæ‰¾åˆ°äº†ä»€éº¼ã€Œæ–°çš„ã€ï¼Ÿâ€” ä¸çŸ¥é“
  â‘£ ä¸‰è¼ªæœå°‹åŠ èµ·ä¾†è¦†è“‹äº†å¤šå°‘ç¨ç«‹æ–‡ç« ï¼Ÿâ€” ä¸çŸ¥é“
  â‘¤ é‚„æœ‰å“ªäº›é¢å‘æ²’æœåˆ°ï¼Ÿâ€” å®Œå…¨ä¸çŸ¥é“
```

**ç¾æœ‰ Session ç³»çµ±çš„ä¸è¶³**ï¼š

ç›®å‰çš„ `SessionManager`ï¼ˆ`application/session/manager.py`ï¼‰å„²å­˜äº†ï¼š

| æœ‰å­˜ | æ²’å­˜ |
|------|------|
| âœ… æœå°‹æ­·å²ï¼ˆquery + PMIDsï¼‰ | âŒ è·¨æœå°‹ PMID é‡ç–Šåˆ†æ |
| âœ… æ–‡ç« å¿«å–ï¼ˆé¿å…é‡è¤‡ API å‘¼å«ï¼‰ | âŒ æœå°‹çµæœçš„ä¸»é¡Œåˆ†å¸ƒ |
| âœ… é–±è®€æ¸…å–® | âŒ ç´¯ç©è¦†è“‹ç‡è¿½è¹¤ |
| âœ… æ’é™¤çš„ PMID | âŒ æœå°‹ç­–ç•¥å·®ç•°å ±å‘Š |
| | âŒ ã€Œé‚„æœ‰ä»€éº¼æ²’æœéã€çš„ç¼ºå£åˆ†æ |

Session çš„å®šä½æ˜¯ã€Œé¿å…é‡è¤‡ API å‘¼å«ã€ï¼Œè€Œéã€Œè·¨æœå°‹èªçŸ¥æ•´åˆã€ã€‚å®ƒè¨˜ä½äº†ã€Œæ‰¾éä»€éº¼ã€ï¼Œä½†ä¸åˆ†æã€Œæ‰¾åˆ°çš„æ±è¥¿ä¹‹é–“æœ‰ä»€éº¼é—œä¿‚ã€ã€‚

#### ç—›é» 3ï¼šæ’åºèˆ‡ç ”ç©¶å•é¡Œè„«ç¯€ï¼ˆRelevance â‰  Usefulnessï¼‰

```
PubMed çš„ "relevance" æ’åºï¼š
  - åŸºæ–¼ query-document æ–‡å­—åŒ¹é…ï¼ˆTF-IDF è®Šé«”ï¼‰
  - å…¨åŸŸæ’å â€” å°æ‰€æœ‰äººã€æ‰€æœ‰å•é¡Œéƒ½ä¸€æ¨£
  - ä¸è€ƒæ…®ï¼šä½ çš„ç ”ç©¶éšæ®µã€å·²è®€æ–‡ç« ã€ç ”ç©¶å‡è¨­

æˆ‘å€‘çš„å…­ç¶­æ’åºï¼š
  - åŠ å…¥äº† qualityã€recencyã€impactã€source_trustã€entity_match
  - ä½† relevance ç¶­åº¦ä¾èˆŠç”¨ term overlapï¼ˆå’Œ PubMed æœ¬è³ªç›¸åŒï¼‰
  - æ’åºçµæœä»æ˜¯ä¸€å€‹ç·šæ€§åˆ—è¡¨ â€” æ²’æœ‰çµæ§‹ã€æ²’æœ‰åˆ†ç¾¤

æ ¹æœ¬å•é¡Œï¼š
  "æ’åº" å‡è¨­ç”¨æˆ¶è¦çœ‹ä¸€å€‹æœ‰åºåˆ—è¡¨
  ä½†ç”¨æˆ¶çœŸæ­£éœ€è¦çš„æ˜¯ "ç†è§£é€™å€‹é ˜åŸŸçš„çµæ§‹"

  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
  â•‘  åˆ—è¡¨æ€ç¶­ï¼š                                                  â•‘
  â•‘    1. Paper A (score: 0.95)                                  â•‘
  â•‘    2. Paper B (score: 0.93)  â† é€™å’Œ A ç ”ç©¶åŒä¸€å€‹å­ä¸»é¡Œ       â•‘
  â•‘    3. Paper C (score: 0.91)  â† é€™ä¹Ÿæ˜¯                        â•‘
  â•‘    4. Paper D (score: 0.89)  â† é€™è¨è«–å®Œå…¨ä¸åŒçš„é¢å‘ï¼Œæ›´æœ‰åƒ¹å€¼ â•‘
  â•‘                                                              â•‘
  â•‘  çµæ§‹æ€ç¶­ï¼š                                                  â•‘
  â•‘    Cluster 1ï¼ˆç¨‹åºæ€§é®éœï¼‰ï¼šA, B, C â†’ ä»£è¡¨ä½œï¼šA              â•‘
  â•‘    Cluster 2ï¼ˆICU é•·æœŸé®éœï¼‰ï¼šD, E â†’ ä»£è¡¨ä½œï¼šD               â•‘
  â•‘    Cluster 3ï¼ˆå®‰å…¨æ€§æ¯”è¼ƒï¼‰ï¼šF, G, H â†’ ä»£è¡¨ä½œï¼šF              â•‘
  â•‘    â†’ Agent çœ‹ 3 ç¯‡ä»£è¡¨ä½œå°±è¦†è“‹ 3 å€‹é¢å‘ï¼ˆvs çœ‹å‰ 3 ååªè¦†è“‹ 1 å€‹ï¼‰â•‘
  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 2.2 å•é¡Œçš„å­¸è¡“å®šä½

é€™ä¸‰å€‹ç—›é»å°æ‡‰è³‡è¨Šç§‘å­¸çš„ä¸‰å€‹å·²çŸ¥å•é¡Œï¼š

| ç—›é» | å­¸è¡“é ˜åŸŸ | ç¶“å…¸å•é¡Œåç¨± | å·²æœ‰æ–¹æ¡ˆ |
|------|---------|-------------|----------|
| çµæœä¸å¯æ¶ˆåŒ– | Information Retrieval | **Result Diversification** | MMR (Carbonell & Goldstein, 1998)ã€xQuAD (Santos et al., 2010) |
| æœå°‹é–“ç„¡è¨˜æ†¶ | Interactive IR | **Session Search** | TREC Session Track (2010-2014) |
| æ’åºèˆ‡å•é¡Œè„«ç¯€ | Personalized IR | **Task-based Retrieval** | TREC Tasks Track (2015-2017) |

é‡è¦ç™¼ç¾ï¼š**é€™ä¸‰å€‹å•é¡Œåœ¨å‚³çµ± IR ä¸­å·²æœ‰ç ”ç©¶ï¼Œä½†åœ¨ MCP/Agent å·¥å…·ç”Ÿæ…‹ä¸­å®Œå…¨æ²’æœ‰è¢«å¯¦ä½œ**ã€‚é€™æ˜¯çœŸæ­£çš„å‰µæ–°ç©ºé–“ã€‚

### 2.3 è§£æ³•æ¡†æ¶ï¼šå¾ã€Œåˆ—è¡¨è¿”å›ã€åˆ°ã€ŒçŸ¥è­˜æ‘˜è¦ã€

æ ¸å¿ƒæ€è·¯è½‰è®Šï¼š

```
ç•¶å‰æ¨¡å¼ï¼ˆList-orientedï¼‰ï¼š
  Query â†’ API â†’ 10,000 results â†’ å–å‰ 10 â†’ ä¸Ÿçµ¦ Agent â†’ Agent åªçŸ¥é“ 10 ç¯‡

ç›®æ¨™æ¨¡å¼ï¼ˆKnowledge-orientedï¼‰ï¼š
  Query â†’ API â†’ 10,000 results â†’ MCP é è™•ç† â†’ çµæ§‹åŒ–çŸ¥è­˜åŒ… â†’ Agent ç²å¾—å…¨å±€è¦–é‡
```

#### è§£æ³• 1ï¼šResult Digestï¼ˆçµæœæ‘˜è¦ï¼‰

æŠŠ 10,000 ç¯‡å£“ç¸®æˆ Agent èƒ½æ¶ˆåŒ–çš„**çµæ§‹åŒ–çŸ¥è­˜åŒ…**ï¼š

```json
{
  "query": "remimazolam sedation",
  "total_results": 10247,

  "topic_clusters": [
    {
      "label": "ç¨‹åºæ€§é®éœï¼ˆProcedural Sedationï¼‰",
      "count": 3200,
      "representative_pmids": ["PMID:111", "PMID:222"],
      "top_mesh_terms": ["Conscious Sedation", "Colonoscopy", "Endoscopy"],
      "year_range": "2017-2026",
      "trend": "growing"
    },
    {
      "label": "ICU é•·æœŸé®éœ",
      "count": 2100,
      "representative_pmids": ["PMID:333"],
      "top_mesh_terms": ["Intensive Care Units", "Respiration, Artificial"],
      "year_range": "2020-2026",
      "trend": "rapidly_growing"
    },
    {
      "label": "è—¥ç‰©å‹•åŠ›å­¸/è—¥ç†æ©Ÿåˆ¶",
      "count": 1800,
      "representative_pmids": ["PMID:444"],
      "top_mesh_terms": ["GABA Modulators", "Pharmacokinetics"],
      "year_range": "2014-2023",
      "trend": "stable"
    }
  ],

  "must_read": [
    {"pmid": "PMID:555", "reason": "æœ€é«˜ RCR (8.2) çš„ Meta-analysis", "rcr": 8.2},
    {"pmid": "PMID:666", "reason": "æœ€å¤šå¼•ç”¨çš„ Phase III RCT", "citations": 450},
    {"pmid": "PMID:777", "reason": "æœ€è¿‘(2025)çš„ Systematic Review", "year": 2025}
  ],

  "temporal_trend": {
    "first_publication": 2014,
    "peak_year": 2023,
    "current_trend": "plateau",
    "annual_counts": {"2014": 3, "2015": 8, "...": "...", "2025": 890, "2026": 124}
  },

  "evidence_pyramid": {
    "meta_analyses": 45,
    "systematic_reviews": 120,
    "rcts": 230,
    "observational": 3500,
    "case_reports": 2100,
    "other": 4252
  }
}
```

**æŠ€è¡“æ–¹æ¡ˆ**ï¼šMeSH term å…±ç¾çŸ©é™£ â†’ åˆ†ç¾¤ï¼ˆk-means æˆ– hierarchical clusteringï¼‰â†’ æ¯ç¾¤å– iCite RCR æœ€é«˜çš„ä½œç‚ºä»£è¡¨

**ä¸éœ€è¦ ML æ¨¡å‹**ï¼šMeSH terms å·²ç¶“æ˜¯æ¨™æº–åŒ–åˆ†é¡ï¼Œå¯ä»¥ç›´æ¥ç”¨æ–¼åˆ†ç¾¤ã€‚

#### è§£æ³• 2ï¼šSearch Deltaï¼ˆæœå°‹å¢é‡å ±å‘Šï¼‰

æ¯æ¬¡æ–°æœå°‹æ™‚ï¼Œè‡ªå‹•èˆ‡ Session ä¸­æ‰€æœ‰å…ˆå‰æœå°‹åšæ¯”è¼ƒï¼š

```
ç¬¬ 2 æ¬¡æœå°‹ "CNS 7056 ICU" å®Œæˆå¾Œè‡ªå‹•ç”¢ç”Ÿï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”„ Search Delta Report                                 â”‚
â”‚  æœå°‹ #2 vs ç´¯ç©çµæœ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  ğŸ“Š é›†åˆåˆ†æï¼š                                           â”‚
â”‚  â”œâ”€â”€ æœå°‹ #2 çµæœ: 5,123 ç¯‡                              â”‚
â”‚  â”œâ”€â”€ èˆ‡æœå°‹ #1 é‡ç–Š: 2,847 ç¯‡ (55.6%)                    â”‚
â”‚  â”œâ”€â”€ æœå°‹ #2 æ–°ç™¼ç¾: 2,276 ç¯‡ â† çœŸæ­£çš„å¢é‡åƒ¹å€¼           â”‚
â”‚  â””â”€â”€ ç´¯ç©ç¨ç«‹æ–‡ç« : 12,523 ç¯‡ (10,247 + 2,276)            â”‚
â”‚                                                          â”‚
â”‚  ğŸ†• æ–°ç™¼ç¾çš„ä¸»é¡Œåˆ†å¸ƒ (2,276 ç¯‡)ï¼š                        â”‚
â”‚  â”œâ”€â”€ æ—©æœŸè‡¨åºŠå‰ç ”ç©¶ (CNS 7056 å‘½åæ™‚æœŸ): 812 ç¯‡           â”‚
â”‚  â”‚   â””â”€â”€ ä»£è¡¨: PMID:888 "CNS 7056: a novel..." (2014)    â”‚
â”‚  â”œâ”€â”€ æ—¥æœ¬å¸‚å ´è‡¨åºŠæ•¸æ“š: 623 ç¯‡                             â”‚
â”‚  â”‚   â””â”€â”€ ä»£è¡¨: PMID:999 "Remimazolam in Japanese..."      â”‚
â”‚  â””â”€â”€ ICU å°ˆç§‘ç‰¹ç•°æ–‡ç»: 841 ç¯‡                             â”‚
â”‚      â””â”€â”€ ä»£è¡¨: PMID:101 "Prolonged sedation with..."      â”‚
â”‚                                                          â”‚
â”‚  âš ï¸ è¦†è“‹ç¼ºå£ï¼ˆå°šæœªæœåˆ°çš„é¢å‘ï¼‰ï¼š                         â”‚
â”‚  â”œâ”€â”€ å°å…’ç§‘ä½¿ç”¨ (å»ºè­°æœå°‹: "remimazolam pediatric")       â”‚
â”‚  â”œâ”€â”€ è‚è…åŠŸèƒ½ä¸å…¨ (å»ºè­°: "remimazolam hepatic impairment")â”‚
â”‚  â””â”€â”€ èˆ‡å…¶ä»– benzodiazepines æ¯”è¼ƒ (å»ºè­°: "remimazolam vs   â”‚
â”‚      midazolam")                                         â”‚
â”‚                                                          â”‚
â”‚  ğŸ’¡ å»ºè­°ï¼š                                               â”‚
â”‚  æœå°‹ #2 ä¸»è¦è£œå……äº†ã€Œæ—©æœŸç ”ç©¶ã€å’Œã€Œæ—¥æœ¬æ•¸æ“šã€ã€‚            â”‚
â”‚  å¦‚æœç ”ç©¶é‡é»æ˜¯ ICU é®éœï¼Œå»ºè­°ä¸‹ä¸€è¼ªæœå°‹èšç„¦             â”‚
â”‚  ã€Œè‚è…åŠŸèƒ½ä¸å…¨æ‚£è€…ã€å’Œã€Œé•·æœŸé®éœå®‰å…¨æ€§ã€ã€‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŠ€è¡“æ–¹æ¡ˆ**ï¼š

```python
# SessionManager æ“´å±•
class SearchDeltaAnalyzer:
    """åˆ†æå¤šè¼ªæœå°‹ä¹‹é–“çš„å¢é‡å·®ç•°"""

    def analyze_delta(
        self,
        new_pmids: set[str],
        session: ResearchSession,
    ) -> SearchDeltaReport:
        # 1. é›†åˆé‹ç®—
        all_previous = set()
        for record in session.search_history:
            all_previous.update(record['pmids'])

        overlap = new_pmids & all_previous
        new_only = new_pmids - all_previous
        cumulative = all_previous | new_pmids

        # 2. æ–°ç™¼ç¾çš„ MeSH åˆ†å¸ƒ
        new_mesh_distribution = self._analyze_mesh_distribution(new_only)

        # 3. è¦†è“‹ç¼ºå£æ¨æ¸¬
        #    - å¾ MeSH tree ä¸­æ‰¾ã€Œç›¸é„°ä½†æœªè¦†è“‹çš„å­æ¨¹ã€
        gaps = self._detect_coverage_gaps(cumulative)

        return SearchDeltaReport(
            new_count=len(new_only),
            overlap_count=len(overlap),
            overlap_rate=len(overlap) / len(new_pmids),
            cumulative_total=len(cumulative),
            new_topic_distribution=new_mesh_distribution,
            coverage_gaps=gaps,
        )
```

#### è§£æ³• 3ï¼šSmart Top-Kï¼ˆå¤šæ¨£æ€§é¸å–ï¼‰

å–ä»£ã€ŒæŒ‰åˆ†æ•¸å–å‰ Kã€çš„ç·šæ€§é¸å–ï¼Œæ”¹ç”¨**åˆ†ç¾¤å¾Œæ¯ç¾¤å–ä»£è¡¨**ï¼š

```
å‚³çµ± Top-10ï¼ˆåŒè³ªåŒ–å•é¡Œï¼‰ï¼š
  1. RCT:  remimazolam ç¨‹åºæ€§é®éœ (score: 0.95)   â† Cluster 1
  2. RCT:  remimazolam çµè…¸é¡é®éœ (score: 0.93)   â† Cluster 1
  3. RCT:  remimazolam å…§è¦–é¡é®éœ (score: 0.91)   â† Cluster 1
  4. Meta:  remimazolam ç¨‹åºæ€§é®éœ (score: 0.90)   â† Cluster 1
  5. RCT:  remimazolam æ”¯æ°£ç®¡é¡ (score: 0.88)      â† Cluster 1
  ...å‰ 5 åå…¨æ˜¯ã€Œç¨‹åºæ€§é®éœã€ï¼å…¶ä»–é¢å‘å®Œå…¨ç¼ºå¤±ã€‚

Smart Top-10ï¼ˆå¤šæ¨£æ€§ä¿è­‰ï¼‰ï¼š
  Cluster 1 (ç¨‹åºæ€§é®éœ, 3200ç¯‡):
    1. PMID:AAA - Meta-analysis (æœ€é«˜ RCR)
    2. PMID:BBB - æœ€æ–° RCT (2025)
  Cluster 2 (ICU é®éœ, 2100ç¯‡):
    3. PMID:CCC - Phase III (æœ€é«˜å¼•ç”¨)
    4. PMID:DDD - å®‰å…¨æ€§åˆ†æ
  Cluster 3 (è—¥ç†æ©Ÿåˆ¶, 1800ç¯‡):
    5. PMID:EEE - æ©Ÿåˆ¶ç¶œè¿°
  Cluster 4 (å®‰å…¨æ€§, 1500ç¯‡):
    6. PMID:FFF - ä¸è‰¯äº‹ä»¶è–ˆèƒ
  Cluster 5 (è—¥ç‰©æ¯”è¼ƒ, 1647ç¯‡):
    7. PMID:GGG - vs propofol meta-analysis
    8. PMID:HHH - vs midazolam RCT
  é¡å¤–ï¼ˆè·¨ç¾¤é«˜å½±éŸ¿åŠ›ï¼‰ï¼š
    9. PMID:III  - ç³»çµ±æ€§å›é¡§ (RCR=8.2)
    10. PMID:JJJ - FDA å¯©æŸ¥æ–‡ä»¶
  â†’ Agent çœ‹ 10 ç¯‡å°±è¦†è“‹ 5 å€‹é¢å‘ï¼
```

**æŠ€è¡“æ–¹æ¡ˆ**ï¼š**Maximal Marginal Relevance (MMR)**ï¼ˆCarbonell & Goldstein, 1998ï¼‰

$$\text{MMR} = \arg\max_{d_i \in R \setminus S} \Big[ \lambda \cdot \text{Sim}(d_i, q) - (1-\lambda) \cdot \max_{d_j \in S} \text{Sim}(d_i, d_j) \Big]$$

å…¶ä¸­ï¼š
- $R$ = å€™é¸æ–‡ä»¶é›†åˆï¼ˆæœå°‹çµæœï¼‰
- $S$ = å·²é¸æ–‡ä»¶é›†åˆï¼ˆç›®å‰çš„ top-Kï¼‰
- $\lambda$ = relevance å’Œ diversity çš„å¹³è¡¡åƒæ•¸ï¼ˆ0.5-0.7ï¼‰
- $\text{Sim}(d_i, q)$ = æ–‡ä»¶èˆ‡æŸ¥è©¢çš„ç›¸é—œæ€§
- $\text{Sim}(d_i, d_j)$ = æ–‡ä»¶ä¹‹é–“çš„ç›¸ä¼¼åº¦

æ¯æ¬¡é¸ä¸€ç¯‡**æ—¢èˆ‡æŸ¥è©¢ç›¸é—œã€åˆèˆ‡å·²é¸æ–‡ä»¶ä¸åŒ**çš„æ–‡ç« ï¼Œè‡ªç„¶ä¿è­‰äº†å¤šæ¨£æ€§ã€‚

åœ¨ç”Ÿé†«é ˜åŸŸï¼Œ$\text{Sim}(d_i, d_j)$ å¯ä»¥ç”¨ **MeSH term å…±ç¾** ä¾†è¨ˆç®—ï¼ˆä¸éœ€è¦åµŒå…¥æ¨¡å‹ï¼‰ï¼š

```python
def mesh_similarity(article_a, article_b) -> float:
    """åŸºæ–¼ MeSH terms çš„æ–‡ç« ç›¸ä¼¼åº¦"""
    mesh_a = set(article_a.mesh_terms)
    mesh_b = set(article_b.mesh_terms)
    if not mesh_a or not mesh_b:
        return 0.0
    return len(mesh_a & mesh_b) / len(mesh_a | mesh_b)  # Jaccard
```

#### è§£æ³• 4ï¼šCumulative Coverage Trackerï¼ˆç´¯ç©è¦†è“‹ç‡è¿½è¹¤ï¼‰

å›ç­”ã€Œæœå…¨äº†æ²’ï¼Ÿã€é€™å€‹é—œéµå•é¡Œã€‚

```
æœå°‹é€²åº¦å„€è¡¨æ¿ï¼š

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ Research Coverage Dashboard                          â”‚
â”‚  ä¸»é¡Œ: remimazolam                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  ç´¯ç©æœå°‹: 3 æ¬¡ | ç´¯ç©ç¨ç«‹æ–‡ç« : 14,789 ç¯‡                â”‚
â”‚                                                          â”‚
â”‚  MeSH å­æ¨¹è¦†è“‹ç‡:                                        â”‚
â”‚  â”œâ”€â”€ D03.383.129 (Benzodiazepines)     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 95%  â”‚
â”‚  â”œâ”€â”€ E01.370.225 (Conscious Sedation)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 72%  â”‚
â”‚  â”œâ”€â”€ E03.155.197 (Critical Care)       â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 55%  â”‚
â”‚  â”œâ”€â”€ C23.888.592 (Drug-Related Effects)â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 38%  â”‚
â”‚  â””â”€â”€ E05.318.308 (Clinical Trials)     â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 28%  â”‚
â”‚                                                          â”‚
â”‚  âš ï¸ ä½è¦†è“‹é¢å‘:                                         â”‚
â”‚  â”œâ”€â”€ N05.300 (Health Services)              â–‘â–‘â–‘â–‘â–‘â–‘ 5%    â”‚
â”‚  â”œâ”€â”€ F02.463.425 (Learning/Memory)          â–‘â–‘â–‘â–‘â–‘â–‘ 3%    â”‚
â”‚  â””â”€â”€ G07.690.773 (Pharmacokinetics, ç‰¹æ®Šæ—ç¾¤)â–‘â–‘â–‘â–‘â–‘ 2%    â”‚
â”‚                                                          â”‚
â”‚  å»ºè­°ä¸‹ä¸€æ­¥æœå°‹:                                         â”‚
â”‚  "remimazolam pharmacokinetics special populations"       â”‚
â”‚  "remimazolam cognitive outcomes"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æŠ€è¡“æ–¹æ¡ˆ**ï¼š

1. å–å¾—æœå°‹ä¸»é¡Œåœ¨ MeSH æ¨¹ä¸­çš„**ç›¸é—œå­æ¨¹**ï¼ˆä¾‹å¦‚ "remimazolam" çš„ MeSH é„°åŸŸï¼‰
2. è¿½è¹¤ç´¯ç©æœå°‹çµæœè¦†è“‹äº†å“ªäº› MeSH terms
3. è¨ˆç®—æ¯å€‹å­æ¨¹çš„è¦†è“‹ç‡ = å·²æ‰¾åˆ°çš„æ–‡ç« å«æ­¤ MeSH / è©² MeSH ä¸‹çš„å·²çŸ¥æ–‡ç« ç¸½æ•¸
4. ä½è¦†è“‹çš„å­æ¨¹ â†’ è‡ªå‹•å»ºè­°æœå°‹ç­–ç•¥

### 2.4 å››å€‹è§£æ³•çš„æ¯”è¼ƒèˆ‡å„ªå…ˆç´š

| è§£æ³• | è§£æ±ºç—›é» | æŠ€è¡“é›£åº¦ | ä¾è³´ | Agent åƒ¹å€¼ | è«–æ–‡æ½›åŠ› | å„ªå…ˆç´š |
|------|---------|:--------:|------|:----------:|:--------:|:------:|
| **Search Delta** | æœå°‹é–“ç„¡è¨˜æ†¶ | â­ ä½ | Session ç³»çµ±å·²æœ‰åŸºç¤ | â­â­â­â­â­ | â­â­â­ | ğŸ¥‡ ç¬¬ä¸€ |
| **Smart Top-K (MMR)** | çµæœåŒè³ªåŒ– | â­â­ ä½-ä¸­ | MeSH terms å·²æœ‰ | â­â­â­â­â­ | â­â­â­â­ | ğŸ¥ˆ ç¬¬äºŒ |
| **Result Digest** | çµæœä¸å¯æ¶ˆåŒ– | â­â­â­ ä¸­ | MeSH åˆ†ç¾¤ + iCite | â­â­â­â­â­ | â­â­â­â­ | ğŸ¥‰ ç¬¬ä¸‰ |
| **Coverage Tracker** | ä¸çŸ¥æœå…¨æ²’ | â­â­â­â­ ä¸­-é«˜ | MeSH æ¨¹çµæ§‹ + çµ±è¨ˆ | â­â­â­â­ | â­â­â­â­â­ | ç¬¬å›› |

**æ¨è–¦è·¯ç·š**ï¼šSearch Delta â†’ Smart Top-K â†’ Result Digest â†’ Coverage Tracker

ç†ç”±ï¼š
- **Search Delta** æŠ•å…¥æœ€å°‘ï¼ˆSession å·²å­˜ PMIDï¼‰ã€æ•ˆæœæœ€ç›´æ¥ï¼ˆAgent ç«‹å³çŸ¥é“ã€Œæ–°ç™¼ç¾äº†ä»€éº¼ã€ï¼‰
- **Smart Top-K (MMR)** æ”¹å–„æœ€æ˜é¡¯çš„ç—›é»ï¼ˆå‰ 10 ç¯‡ä¸å†æ˜¯åŒé¡æ–‡ç« çš„é‡è¤‡ï¼‰
- **Result Digest** éœ€è¦å¯¦ä½œ MeSH åˆ†ç¾¤ï¼Œä½†æä¾›ã€Œå…¨å±€è¦–é‡ã€
- **Coverage Tracker** æœ€æœ‰å­¸è¡“æ·±åº¦ï¼Œä½†éœ€è¦ MeSH æ¨¹çµæ§‹å’Œçµ±è¨ˆæ¨¡å‹

### 2.5 é€™äº›è§£æ³•èˆ‡ Â§4-Â§6 æ¼”ç®—æ³•çš„é—œä¿‚

ç—›é»åˆ†æï¼ˆæœ¬ç¯€ï¼‰å’Œæ¼”ç®—æ³•å‰µæ–°ï¼ˆÂ§4-Â§6ï¼‰æ˜¯**äº’è£œçš„å…©å€‹ç¶­åº¦**ï¼š

```
                    æ¼”ç®—æ³•æ·±åº¦
                       â†‘
        Â§4 BM25+RRF    â”‚    Â§4 Citation Burst
        Â§4 PRF         â”‚    Â§4 Main Path
                       â”‚
     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ¶æ§‹å‰µæ–°
                       â”‚
        ç¾ç‹€           â”‚    Â§2 Search Delta
        (term overlap, â”‚    Â§2 Smart Top-K (MMR)
         ç·šæ€§ top-10)  â”‚    Â§2 Result Digest
                       â”‚    Â§2 Coverage Tracker

  å·¦ä¸‹è§’ = ç¾ç‹€ï¼ˆæ·ºæ¼”ç®—æ³• + ç·šæ€§åˆ—è¡¨ï¼‰
  å³ä¸‹è§’ = æ¶æ§‹å‰µæ–°ï¼ˆæ”¹è®Šçµæœå‘ˆç¾æ–¹å¼ï¼Œä½†æ¼”ç®—æ³•ç°¡å–®ï¼‰â† æœ¬ç¯€
  å·¦ä¸Šè§’ = æ¼”ç®—æ³•å‡ç´šï¼ˆBM25 ç­‰ï¼Œä½†ä»è¿”å›åˆ—è¡¨ï¼‰â† Â§4-Â§6
  å³ä¸Šè§’ = çµ‚æ¥µç›®æ¨™ï¼ˆBM25 æ’åº + MMR å¤šæ¨£æ€§ + åˆ†ç¾¤æ‘˜è¦ + å¢é‡åˆ†æï¼‰
```

**é—œéµæ´å¯Ÿ**ï¼šåªåšæ¼”ç®—æ³•å‡ç´šï¼ˆÂ§4-Â§6ï¼‰è€Œä¸æ”¹çµæœå‘ˆç¾æ–¹å¼ï¼ŒAgent ä»ç„¶åªçœ‹åˆ° 10 ç¯‡åˆ—è¡¨ã€‚åªæ”¹å‘ˆç¾æ–¹å¼è€Œä¸å‡ç´šæ¼”ç®—æ³•ï¼Œåˆ†ç¾¤å’Œæ’åºå“è³ªä¸å¤ å¥½ã€‚**å…©è€…å¿…é ˆåŒæ™‚æ¨é€²**ã€‚

### 2.6 å°è«–æ–‡å®šä½çš„å½±éŸ¿

é€™å€‹ç—›é»åˆ†æå¯ä»¥æˆç‚ºè«–æ–‡ï¼ˆ`paper-draft.md`ï¼‰çš„**å¦ä¸€å€‹æ ¸å¿ƒè²¢ç»**ï¼š

| åŸæœ‰è²¢ç» | æœ¬ç¯€æ–°å¢è²¢ç» |
|---------|-------------|
| Research Timeline Construction | **Agent-Digestible Result Summarization** |
| Milestone Detection | **Cross-Search Delta Analysis** |
| Multi-Source Integration | **Diversity-Aware Top-K Selection (MMR)** |
| | **Cumulative Coverage Tracking** |

è«–æ–‡è§’åº¦å¯ä»¥é‡æ–°å®šç¾©ç‚ºï¼š

> *ã€Œå¾ List-based Retrieval åˆ° Knowledge-oriented Retrievalï¼šä¸€å€‹ä»¥ AI Agent ç‚ºä¸­å¿ƒçš„æ–‡ç»æª¢ç´¢æ–°ç¯„å¼ã€*

é€™æ¯”ã€Œå¤šæºæ•´åˆ + æ™‚é–“è»¸ã€æ›´æœ‰å­¸è¡“æ·±åº¦ï¼Œå› ç‚ºå®ƒæŒ‘æˆ°äº†å‚³çµ± IR çš„ã€Œè¿”å›æ’åºåˆ—è¡¨ã€å‡è¨­ã€‚

---

## 3. ç¾ç‹€èª å¯¦è©•ä¼°

### 2.1 æœ‰æ¼”ç®—æ³•åƒ¹å€¼çš„çµ„ä»¶

#### 2.1.1 Union-Find å»é‡ï¼ˆâ­â­â­ æœ€ä½³æ¼”ç®—æ³•é¸æ“‡ï¼‰

**ä½ç½®**: `application/search/result_aggregator.py`

```
ä¸‰é€šé“åŒ¹é…: DOI â†’ PMID â†’ æ¨™é¡Œæ­£è¦åŒ–
è¤‡é›œåº¦: O(nÂ·Î±(n)) â‰ˆ O(n)ï¼Œæ¯”æš´åŠ› O(nÂ²) å¤§å¹…æ”¹å–„
ç­–ç•¥: STRICT / MODERATE / AGGRESSIVE ä¸‰ç´šå¯èª¿
åˆä½µ: åŸºæ–¼ identifier æ•¸é‡ + å…ƒè³‡æ–™å®Œæ•´åº¦ + ä¾†æºä¿¡ä»»åº¦
```

**è©•åƒ¹**: é€™æ˜¯å°ˆæ¡ˆä¸­æœ€å¥½çš„æ¼”ç®—æ³•é¸æ“‡ã€‚Union-Find åœ¨å­¸è¡“ä¸Šæ˜¯æ¨™æº–åšæ³•ï¼Œä½†åœ¨ MCP å·¥å…·ç”Ÿæ…‹ä¸­æ¥µå°‘è¦‹ã€‚

**é™åˆ¶**: æ¨™é¡ŒåŒ¹é…æ˜¯**ç²¾ç¢ºåŒ¹é…**ï¼ˆæ­£è¦åŒ–å¾Œï¼‰ï¼Œç„¡æ³•è™•ç†å¾®å°å·®ç•°ï¼ˆ"vs" vs "versus"ã€æ‹¼å¯«è®Šé«”ï¼‰ã€‚

#### 2.1.2 å…­ç¶­åŠ æ¬Šæ’åºï¼ˆâ­â­ åˆç†ä½†åç°¡å–®ï¼‰

**ä½ç½®**: `application/search/result_aggregator.py`

| ç¶­åº¦ | æ¼”ç®—æ³• | æ¬Šé‡ | è©•åƒ¹ |
|------|--------|:----:|------|
| **relevance** | term overlapï¼ˆé›†åˆäº¤é›†æ¯”ä¾‹ï¼‰ | 0.25 | âŒ æœ€å¼±ç’°ç¯€ â€” bag-of-words |
| **quality** | æ–‡ç« é¡å‹æŸ¥è¡¨ + å®Œæ•´åº¦ + OAåŠ åˆ† | 0.20 | âœ… åˆç† |
| **recency** | æŒ‡æ•¸è¡°æ¸› `0.5^(age/half_life)` | 0.15 | âœ… æ¨™æº–åšæ³• |
| **impact** | RCR sigmoid `rcr/(rcr+2)` + citation log10 | 0.20 | âœ… å¥½çš„é£½å’Œæ›²ç·š |
| **source_trust** | ä¾†æºä¿¡ä»»æŸ¥è¡¨ + å¤šæºé©—è­‰åŠ åˆ† | 0.10 | âœ… å¯¦ç”¨ |
| **entity_match** | PubTator3 å¯¦é«”åœ¨æ–‡ç« ä¸­å‡ºç¾æ¯”ä¾‹ | 0.10 | âš ï¸ ä¾è³´å¤–éƒ¨ API |

**æ ¸å¿ƒå•é¡Œ**: `relevance` ç”¨ **ç´” term overlap**ï¼ˆbag-of-wordsï¼‰ï¼Œä¸è€ƒæ…®ï¼š
- è©é » (TF) â€” "cancer" å‡ºç¾ 10 æ¬¡ vs 1 æ¬¡
- é€†æ–‡ä»¶é »ç‡ (IDF) â€” "the" vs "remimazolam" çš„å€åˆ†åŠ›
- æ–‡ä»¶é•·åº¦æ­£è¦åŒ– â€” é•· abstract è‡ªç„¶å‘½ä¸­æ›´å¤šè©

#### 2.1.3 å¤šç­–ç•¥æ·±åº¦æœå°‹ï¼ˆâ­â­ å¥½çš„ç³»çµ±è¨­è¨ˆï¼‰

**ä½ç½®**: `presentation/mcp_server/tools/unified.py`

```
ç­–ç•¥: SemanticEnhancer ç”¢ç”Ÿå¤šå€‹ SearchPlan â†’ asyncio.gather() ä¸¦è¡ŒåŸ·è¡Œ
è¯åˆå¬å›ç‡: 1 - âˆ(1 - recall_i)  (æ¦‚ç‡ä¸¦é›†)
åŠ æ¬Šç²¾ç¢ºåº¦: Î£(precision_i Ã— count_i) / total_count
```

**å•é¡Œ**: recall/precision æ˜¯**ç¡¬ç·¨ç¢¼ä¼°ç®—å€¼**ï¼ˆå¦‚ `expected_precision=0.7`ï¼‰ï¼Œä¸æ˜¯å¾çµæœè¨ˆç®—çš„ã€‚

#### 2.1.4 å…­å±¤æ¼¸é€²æ”¾å¯¬ï¼ˆâ­â­ å¯¦ç”¨å·¥ç¨‹æ–¹æ¡ˆï¼‰

**ä½ç½®**: `presentation/mcp_server/tools/unified.py`

```
Level 1: ç§»é™¤é€²éšç¯©é¸ (age_group, clinical_query)
Level 2: ç§»é™¤å¹´ä»½é™åˆ¶
Level 3: ç§»é™¤å‡ºç‰ˆé¡å‹ç¯©é¸ (RCT, Meta-analysis)  
Level 4: ç§»é™¤ PubMed æ¬„ä½æ¨™ç±¤ ([Title], [MeSH Terms])
Level 5: AND â†’ OR
Level 6: èƒå–æ ¸å¿ƒé—œéµå­—ï¼ˆæœ€å¤š 3 å€‹ï¼‰
```

**è©•åƒ¹**: æœå°‹å¼•æ“å·¥ç¨‹ä¸­å¸¸è¦‹çš„ query relaxation ç­–ç•¥ï¼Œç³»çµ±åŒ–åšå¾—ä¸éŒ¯ï¼Œä½†éå­¸è¡“å‰µæ–°ã€‚

#### 2.1.5 é‡Œç¨‹ç¢‘åµæ¸¬ï¼ˆâ­â­ æœ‰æ•ˆçš„è¦å‰‡å¼•æ“ï¼‰

**ä½ç½®**: `application/timeline/milestone_detector.py`

```
å››ç´šç®¡ç·š: ç¬¬ä¸€ç¯‡ â†’ PubMed å‡ºç‰ˆç‰©é¡å‹ â†’ æ¨™é¡Œæ­£å‰‡ (17ç¨®) â†’ å¼•ç”¨æ•¸é–¾å€¼
è­‰æ“šç­‰ç´š: æ˜ å°„åˆ° Oxford CEBM Level 1-4
æ™‚æœŸåˆ†çµ„: Discovery â†’ Clinical Development â†’ Regulatory â†’ Evidence Synthesis â†’ Post-Market
```

**é™åˆ¶**:
- å¼•ç”¨é–¾å€¼æ˜¯**å›ºå®šçš„**ï¼ˆâ‰¥500/200ï¼‰ï¼Œä¸å› é ˜åŸŸèª¿æ•´
- ç„¡æ³•åµæ¸¬ã€Œéš±å«çš„é‡Œç¨‹ç¢‘ã€ï¼ˆä¸å« "FDA" ä½†æè¿°äº†æ‰¹å‡†çš„æ–‡ç« ï¼‰
- ç¬¬ä¸€ç¯‡åµæ¸¬ä¾è³´æœå°‹æ’åºï¼Œå¯èƒ½ä¸æ˜¯çœŸæ­£æœ€æ—©çš„

### 2.2 æœ¬è³ªä¸Šæ˜¯ API åŒ…è£çš„çµ„ä»¶

| çµ„ä»¶ | ä½ç½® | å¯¦éš›åšæ³• | ç‚ºä»€éº¼ä¸ç®—å‰µæ–° |
|------|------|---------|---------------|
| **QueryAnalyzer** | `application/search/query_analyzer.py` | ç¡¬ç·¨ç¢¼é—œéµå­—é›†åˆ + æ­£å‰‡ | é›¶ NLPï¼Œå­¸è¡“ä¸Šç”¨ BioBERT åˆ†é¡å¯é” 95%+ |
| **SemanticEnhancer** | `application/search/semantic_enhancer.py` | PubTator3 autocomplete API è–„åŒ…è£ + å›ºå®š 5 ç¨®ç­–ç•¥æ¨¡æ¿ | åªç”¨ autocompleteï¼ˆé annotateï¼‰ï¼Œç­–ç•¥æ˜¯éœæ…‹çš„ |
| **Citation Tree** | `presentation/mcp_server/tools/citation_tree.py` | BFS + è³‡æ–™æ ¼å¼è½‰æ› | é›¶åœ–è«–åˆ†æï¼ˆæ²’æœ‰ PageRankã€community detectionï¼‰ |
| **Similarity Scores** | `presentation/mcp_server/tools/unified.py` | `1.0 - (position Ã— 0.9 / (total-1))` + source_boost | **åç¨±èª¤å°** â€” åªæ˜¯æ’åä½ç½®çš„ç·šæ€§è½‰æ› |
| **precision/recall ä¼°ç®—** | å¤šè™• | ç¡¬ç·¨ç¢¼å¸¸æ•¸ï¼ˆå¦‚ 0.7/0.5ï¼‰ | éå¯¦æ¸¬å€¼ï¼Œç„¡çµ±è¨ˆæ„ç¾© |
| **ICD-MeSH è½‰æ›** | å„è™• | éœæ…‹æŸ¥è¡¨æ˜ å°„ | æ¨™æº–è³‡æ–™è½‰æ› |
| **æ‰€æœ‰ Source Clients** | `infrastructure/sources/` | HTTP API â†’ response mapping | ç´”è³‡æ–™ä¸­ä»‹å±¤ |

### 2.3 ç¾ç‹€ç¸½çµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            PubMed Search MCP â€” æ¼”ç®—æ³•æ·±åº¦åˆ†å¸ƒ             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                          â”‚
â”‚  API åŒ…è£å±¤        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  60%         â”‚
â”‚  (Source Clients, ICD, Similarity Scores)                â”‚
â”‚                                                          â”‚
â”‚  è¦å‰‡å¼•æ“          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ         30%         â”‚
â”‚  (QueryAnalyzer, MilestoneDetector, Relaxation)         â”‚
â”‚                                                          â”‚
â”‚  æ¼”ç®—æ³•å¯¦ä½œ        â–ˆâ–ˆâ–ˆâ–ˆ                      10%         â”‚
â”‚  (Union-Find, å…­ç¶­æ’åº, æ¦‚ç‡å¬å›ç‡)                       â”‚
â”‚                                                          â”‚
â”‚  å­¸è¡“å‰µæ–°          â–‘                          0%         â”‚
â”‚  (ç„¡çªç ´æ€§æ¼”ç®—æ³•)                                         â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¸€å¥è©±çµè«–**ï¼šå·¥ç¨‹æ•´åˆå“è³ªé«˜ï¼Œæ¼”ç®—æ³•æ·±åº¦ä¸è¶³ã€‚

---

## 4. å­¸è¡“å‰µæ–°æ©Ÿæœƒ

### 4.1 Tier 1ï¼šé«˜å½±éŸ¿åŠ› + å¯ç™¼è«–æ–‡

#### ğŸ† 3.1.1 æ™ºèƒ½ç›¸é—œæ€§æ’åºï¼šBM25 + Reciprocal Rank Fusion

**å•é¡Œ**: ç¾æœ‰ relevance è¨ˆç®—æ˜¯ term overlapï¼ˆbag-of-wordsï¼‰ï¼Œé€™æ˜¯è³‡è¨Šæª¢ç´¢é ˜åŸŸ 1960 å¹´ä»£çš„æ°´æº–ã€‚

**æ–¹æ¡ˆ**: å…©éšæ®µå‡ç´š

**Stage 1: BM25 (Okapi BM25)**

BM25 æ˜¯è³‡è¨Šæª¢ç´¢çš„äº‹å¯¦æ¨™æº–ï¼ˆRobertson & Zaragoza, 2009ï¼‰ï¼Œè€ƒæ…®ï¼š
- **è©é » (TF)**: é£½å’Œæ›²ç·šï¼Œé¿å…é«˜é »è©ä¸»å°
- **é€†æ–‡ä»¶é »ç‡ (IDF)**: ç¨€æœ‰è©ç²å¾—æ›´é«˜æ¬Šé‡
- **æ–‡ä»¶é•·åº¦æ­£è¦åŒ–**: æ¶ˆé™¤é•·æ–‡åè¦‹

$$\text{BM25}(q, d) = \sum_{t \in q} \text{IDF}(t) \cdot \frac{f(t,d) \cdot (k_1 + 1)}{f(t,d) + k_1 \cdot (1 - b + b \cdot \frac{|d|}{avgdl})}$$

å…¶ä¸­ $k_1=1.2$, $b=0.75$ æ˜¯æ¨™æº–åƒæ•¸ã€‚

```python
# é ä¼°å¯¦ä½œï¼ˆ~100 è¡Œï¼‰
from rank_bm25 import BM25Okapi

def bm25_relevance(query: str, articles: list[UnifiedArticle]) -> list[float]:
    """BM25 æ›¿ä»£ term overlap åšç›¸é—œæ€§æ’åº"""
    # å°‡æ¯ç¯‡æ–‡ç« çš„ title + abstract åš tokenization
    corpus = [tokenize(a.title + " " + (a.abstract or "")) for a in articles]
    bm25 = BM25Okapi(corpus)
    return bm25.get_scores(tokenize(query))
```

**Stage 2: Reciprocal Rank Fusion (RRF)**

å¤šæºçµæœåˆä½µæ™‚ï¼Œç”¨ RRF æ›¿ä»£ã€Œæ’åä½ç½®ç·šæ€§è½‰æ›ã€ï¼š

$$\text{RRF}(d) = \sum_{r \in R} \frac{1}{k + r(d)}$$

å…¶ä¸­ $R$ æ˜¯å„ä¾†æºçš„æ’ååˆ—è¡¨ï¼Œ$k=60$ æ˜¯å¸¸æ•¸ã€‚

RRF çš„å„ªå‹¢ï¼ˆCormack et al., 2009ï¼‰ï¼š
- **ä¸éœ€è¦åˆ†æ•¸æ ¡æº–** â€” ä¸åŒä¾†æºçš„åˆ†æ•¸é‡ç¶±ä¸åŒï¼ŒRRF åªç”¨æ’å
- **æ•ˆæœç©©å®š** â€” åœ¨ TREC å¤šæ¬¡è©•æ¸¬ä¸­è¡¨ç¾å„ªç•°
- **é›¶è¨“ç·´** â€” ä¸éœ€è¦ä»»ä½•æ¨™è¨»è³‡æ–™

```python
# é ä¼°å¯¦ä½œï¼ˆ~30 è¡Œï¼‰
def reciprocal_rank_fusion(
    ranked_lists: list[list[str]],  # å„ä¾†æºçš„ PMID æ’ååˆ—è¡¨
    k: int = 60
) -> dict[str, float]:
    """RRF èåˆå¤šä¾†æºæ’å"""
    scores = {}
    for ranked in ranked_lists:
        for rank, pmid in enumerate(ranked, 1):
            scores[pmid] = scores.get(pmid, 0) + 1 / (k + rank)
    return dict(sorted(scores.items(), key=lambda x: x[1], reverse=True))
```

**é æœŸæ•ˆæœ**: åŸºæ–¼ TREC PM benchmarkï¼ŒBM25+RRF ç›¸æ¯” term overlap é è¨ˆæå‡ nDCG@10 é” **20-30%**ã€‚

**å¯¦ä½œé›£åº¦**: ä½ï¼ˆ`rank_bm25` å¥—ä»¶ + 30 è¡Œ RRFï¼‰

---

#### ğŸ† 3.1.2 å¼•ç”¨ç¶²è·¯é€²éšåˆ†æï¼šMain Path Analysis + Community Detection

**å•é¡Œ**: Citation Tree ç›®å‰åªåš BFS éæ­· + æ ¼å¼è½‰æ›ï¼Œæ²’æœ‰ä»»ä½•åœ–è«–åˆ†æã€‚

**æ–¹æ¡ˆ**: ä¸‰å€‹ç¶“å…¸å¼•æ–‡å­¸æ¼”ç®—æ³•

**Algorithm 1: Main Path Analysis (Hummon & Doreian, 1989)**

åœ¨å¼•ç”¨ç¶²è·¯ä¸­æ‰¾å‡ºã€Œç ”ç©¶ç™¼å±•çš„ä¸»å¹¹é“ã€â€”â€” å¾è©²é ˜åŸŸæœ€åˆçš„è«–æ–‡åˆ°æœ€æ–°çš„è«–æ–‡ä¹‹é–“ï¼Œæœ€é‡è¦çš„çŸ¥è­˜å‚³æ‰¿è·¯å¾‘ã€‚

æ­¥é©Ÿï¼š
1. å»ºæ§‹å¼•ç”¨ DAGï¼ˆæœ‰å‘ç„¡ç’°åœ–ï¼‰
2. è¨ˆç®—æ¯æ¢é‚Šçš„ **Search Path Count (SPC)** æˆ– **Search Path Link Count (SPLC)**
3. å¾ sourceï¼ˆæœ€æ—©è«–æ–‡ï¼‰åˆ° sinkï¼ˆæœ€æ–°è«–æ–‡ï¼‰ï¼Œé¸æ“‡ SPC æœ€å¤§çš„è·¯å¾‘

$$\text{SPC}(e_{ij}) = \text{paths}_{\text{source} \to i} \times \text{paths}_{j \to \text{sink}}$$

```python
# æ¦‚å¿µï¼ˆnetworkx å¯¦ä½œï¼Œ~150 è¡Œï¼‰
import networkx as nx

def main_path_analysis(G: nx.DiGraph) -> list[str]:
    """æ‰¾å‡ºå¼•ç”¨ç¶²è·¯ä¸­çš„ç ”ç©¶ä¸»å¹¹é“"""
    # 1. è¨ˆç®—æ‰€æœ‰é‚Šçš„ SPC
    spc = {}
    sources = [n for n in G if G.in_degree(n) == 0]
    sinks = [n for n in G if G.out_degree(n) == 0]

    for u, v in G.edges():
        paths_to_u = sum(nx.has_path(G, s, u) for s in sources)
        paths_from_v = sum(nx.has_path(G, v, s) for s in sinks)
        spc[(u, v)] = paths_to_u * paths_from_v

    # 2. è²ªå¿ƒè¿½è¹¤æœ€å¤§ SPC è·¯å¾‘
    main_path = greedy_forward_path(G, spc, sources)
    return main_path
```

**å‰µæ–°é»**: å°‡å¼•æ–‡å­¸ç¶“å…¸æ¼”ç®—æ³•é¦–æ¬¡æ•´åˆé€² AI Agent å¯æ“ä½œçš„ MCP å·¥å…·ã€‚Agent å¯ä»¥ç›´æ¥å‘Šè¨´ç”¨æˆ¶ã€Œé€™å€‹é ˜åŸŸçš„ç ”ç©¶ä¸»ç·šæ˜¯ï¼šA (2010) â†’ B (2013) â†’ C (2018) â†’ D (2024)ã€ã€‚

**Algorithm 2: Community Detection (Louvain, Blondel et al. 2008)**

åœ¨å¼•ç”¨/è¢«å¼•ç”¨ç¶²è·¯ä¸­ç™¼ç¾ç ”ç©¶å­ç¤¾ç¾¤ï¼š

```python
from networkx.algorithms.community import louvain_communities

def detect_research_communities(G: nx.Graph) -> list[set]:
    """ç™¼ç¾å¼•ç”¨ç¶²è·¯ä¸­çš„ç ”ç©¶å­ç¤¾ç¾¤"""
    communities = louvain_communities(G, resolution=1.0)
    # æ¯å€‹ç¤¾ç¾¤ä»£è¡¨ä¸€å€‹ç ”ç©¶å­é ˜åŸŸ
    return sorted(communities, key=len, reverse=True)
```

**Algorithm 3: PageRank**

æ‰¾å‡ºå¼•ç”¨ç¶²è·¯ä¸­æœ€ã€Œé‡è¦ã€çš„ç¯€é»ï¼ˆä¸åªæ˜¯å¼•ç”¨æ•¸æœ€é«˜ï¼‰ï¼š

$$\text{PR}(p) = \frac{1-d}{N} + d \sum_{q \in B_p} \frac{\text{PR}(q)}{L(q)}$$

```python
pagerank = nx.pagerank(G, alpha=0.85)
key_papers = sorted(pagerank.items(), key=lambda x: x[1], reverse=True)[:10]
```

**å¯¦ä½œé›£åº¦**: ä¸­ï¼ˆ`networkx` å·²æœ‰ Louvain å’Œ PageRank å¯¦ä½œï¼Œéœ€è¦åŒ…è£å’Œ MCP å·¥å…·åŒ–ï¼‰

---

#### ğŸ† 3.1.3 Citation Burst Detectionï¼ˆå¼•ç”¨çªç™¼åµæ¸¬ï¼‰

**å•é¡Œ**: Milestone Detection ç”¨å›ºå®šå¼•ç”¨é–¾å€¼ï¼ˆâ‰¥500/200ï¼‰ï¼Œç„¡æ³•å€åˆ†ã€Œç©©å®šé«˜å¼•ç”¨ã€å’Œã€Œçªç„¶çˆ†ç™¼ã€ã€‚

**æ–¹æ¡ˆ**: Kleinberg (2003) Burst Detection

Kleinberg æ¨¡å‹å°‡æ™‚é–“åºåˆ—å»ºæ¨¡ç‚ºä¸€å€‹**å…©æ…‹è‡ªå‹•æ©Ÿ**ï¼š
- **æ­£å¸¸æ…‹ (q=0)**: å¼•ç”¨ä»¥åŸºæœ¬é€Ÿç‡ $\hat{p}$ åˆ°é”
- **çªç™¼æ…‹ (q=1)**: å¼•ç”¨ä»¥åŠ é€Ÿé€Ÿç‡ $s \cdot \hat{p}$ åˆ°é”ï¼ˆ$s > 1$ï¼‰

ç”¨ Viterbi æ¼”ç®—æ³•æ‰¾å‡ºæœ€å¯èƒ½çš„ç‹€æ…‹åºåˆ—ï¼Œè­˜åˆ¥çªç™¼æ™‚æ®µã€‚

$$\text{cost}(i, q) = -\ln \binom{d_i}{r_i} p_q^{r_i} (1-p_q)^{d_i - r_i}$$

å…¶ä¸­ $d_i$ æ˜¯ç¬¬ $i$ æ™‚æ®µçš„ç¸½æ–‡ç»æ•¸ï¼Œ$r_i$ æ˜¯è¢«å¼•æ¬¡æ•¸ã€‚

**æ‡‰ç”¨å ´æ™¯**:
- è¼¸å…¥ï¼šæŸä¸»é¡Œæ¯å¹´è¢«å¼•æ¬¡æ•¸åºåˆ— `[3, 5, 4, 7, 45, 120, 89, 30, 15, ...]`
- è¼¸å‡ºï¼šçªç™¼æ™‚æ®µ `[{start: 2019, end: 2021, strength: 4.2}]`
- æ„ç¾©ï¼šã€Œè©²é ˜åŸŸåœ¨ 2019-2021 å¹´ç¶“æ­·äº†å¼•ç”¨çªç™¼ï¼Œå¯èƒ½å°æ‡‰é‡å¤§ç™¼ç¾æˆ–çˆ­è­°ã€

```python
def detect_citation_bursts(
    yearly_citations: dict[int, int],
    s: float = 2.0,      # çªç™¼é€Ÿç‡å€æ•¸
    gamma: float = 1.0,  # ç‹€æ…‹åˆ‡æ›æ‡²ç½°
) -> list[BurstPeriod]:
    """Kleinberg burst detection on yearly citation counts"""
    years = sorted(yearly_citations.keys())
    counts = [yearly_citations[y] for y in years]

    # Viterbi on 2-state automaton
    states = viterbi_two_state(counts, s, gamma)

    # Extract burst periods (consecutive q=1 states)
    bursts = extract_burst_periods(years, states, counts)
    return bursts
```

**èˆ‡ç¾æœ‰ Milestone Detection çš„çµåˆ**:

| | ç¾æœ‰æ–¹æ¡ˆ | + Burst Detection |
|---|---------|-------------------|
| è¼¸å…¥ | å–®ç¯‡æ–‡ç« çš„æ¨™é¡Œ/é¡å‹ | æ™‚é–“åºåˆ—ï¼ˆæ•´å€‹é ˜åŸŸï¼‰ |
| æ–¹æ³• | æ­£å‰‡åŒ¹é… | çµ±è¨ˆæ¨¡å‹ (HMM) |
| èƒ½åµæ¸¬ | æ˜ç¢ºçš„äº‹ä»¶ï¼ˆ"FDA approved"ï¼‰ | éš±å«çš„è¶¨å‹¢è½‰æŠ˜ |
| ç„¡æ³•åµæ¸¬ | é ˜åŸŸç´šè¶¨å‹¢è®ŠåŒ– | å…·é«”äº‹ä»¶é¡å‹ |

å…©è€…äº’è£œï¼šMilestone å›ç­”ã€Œç™¼ç”Ÿäº†ä»€éº¼ã€ï¼ŒBurst å›ç­”ã€Œä»€éº¼æ™‚å€™é ˜åŸŸçªç„¶é—œæ³¨ã€ã€‚

**å¯¦ä½œé›£åº¦**: ä¸­ï¼ˆ~200 è¡Œï¼ŒViterbi æ¼”ç®—æ³•éœ€è¦å¯¦ä½œæˆ–ä½¿ç”¨ `burst_detection` å¥—ä»¶ï¼‰

**è«–æ–‡æ½›åŠ›**: â­â­â­ æœ€é«˜ã€‚ã€ŒAgent-Assisted Citation Burst Detection for Research Milestone Discoveryã€å¯ç¨ç«‹ç™¼è¡¨ã€‚

---

### 4.2 Tier 2ï¼šä¸­ç­‰å½±éŸ¿åŠ› + å·¥ç¨‹æå‡

#### ğŸ¥ˆ 3.2.1 Pseudo-Relevance Feedback (PRF)

**å•é¡Œ**: æŸ¥è©¢æ“´å±•åªä¾è³´ PubTator3 autocomplete â†’ MeSH æ˜ å°„ â†’ å›ºå®šç­–ç•¥æ¨¡æ¿ã€‚

**æ–¹æ¡ˆ**: Rocchio (1971) / Lavrenko-Croft (2001) çš„ PRFï¼š

1. åŸ·è¡Œåˆå§‹æŸ¥è©¢ï¼Œå–å‰ $N$ ç¯‡çµæœï¼ˆå‡è¨­å®ƒå€‘æ˜¯ç›¸é—œçš„ï¼Œ"pseudo-relevance"ï¼‰
2. å¾é€™äº›çµæœä¸­æå–**é«˜ TF-IDF çš„æ–°è©å½™**
3. ç”¨æ–°è©å½™æ“´å±•æŸ¥è©¢ï¼Œé‡æ–°æœå°‹

$$\vec{q}_{\text{new}} = \alpha \vec{q}_{\text{orig}} + \frac{\beta}{|D_r|} \sum_{d \in D_r} \vec{d}$$

å¯¦éš›æ“´å±•æ™‚ä¸éœ€è¦å®Œæ•´å‘é‡ç©ºé–“ï¼Œåªéœ€ï¼š

```python
from collections import Counter
import math

def pseudo_relevance_feedback(
    original_query: str,
    top_results: list[UnifiedArticle],
    num_expansion_terms: int = 10,
    top_n: int = 10,
) -> str:
    """PRF: å¾é¦–è¼ªæœå°‹çš„ top-N çµæœä¸­æå–æ“´å±•è©"""
    # 1. æ”¶é›†æ‰€æœ‰ top-N æ–‡ç« çš„ title + abstract è©å½™
    doc_freqs = Counter()
    term_freqs = Counter()
    for article in top_results[:top_n]:
        text = f"{article.title} {article.abstract or ''}"
        terms = tokenize(text)
        unique_terms = set(terms)
        for t in terms:
            term_freqs[t] += 1
        for t in unique_terms:
            doc_freqs[t] += 1

    # 2. è¨ˆç®— TF-IDF
    n_docs = len(top_results[:top_n])
    tfidf = {}
    for term, tf in term_freqs.items():
        idf = math.log(n_docs / (1 + doc_freqs[term]))
        tfidf[term] = tf * idf

    # 3. æ’é™¤åŸå§‹æŸ¥è©¢å·²æœ‰çš„è© + åœç”¨è©
    query_terms = set(tokenize(original_query))
    expansion = [
        (term, score) for term, score in tfidf.items()
        if term not in query_terms and term not in STOPWORDS and len(term) > 3
    ]
    expansion.sort(key=lambda x: x[1], reverse=True)

    # 4. æ§‹å»ºæ“´å±•æŸ¥è©¢
    new_terms = [t for t, _ in expansion[:num_expansion_terms]]
    expanded_query = f"({original_query}) AND ({' OR '.join(new_terms)})"
    return expanded_query
```

**æ•ˆæœ**: å­¸è¡“æ–‡ç»é¡¯ç¤º PRF å¯æå‡ recall@100 é” **15-25%**ï¼Œåœ¨ç”Ÿé†«é ˜åŸŸå°¤ç‚ºæœ‰æ•ˆã€‚

**å¯¦ä½œé›£åº¦**: ä½ï¼ˆ~150 è¡Œï¼Œç´”çµ±è¨ˆæ–¹æ³•ï¼‰

---

#### ğŸ¥ˆ 3.2.2 MinHash æ¨¡ç³Šå»é‡

**å•é¡Œ**: æ¨™é¡ŒåŒ¹é…æ˜¯ç²¾ç¢ºåŒ¹é…ï¼ˆæ­£è¦åŒ–å¾Œï¼‰ï¼Œç„¡æ³•è™•ç†ï¼š
- "propofol vs dexmedetomidine" â‰  "propofol versus dexmedetomidine"
- "A randomized trial of X" â‰  "A randomised trial of X"ï¼ˆç¾å¼/è‹±å¼æ‹¼å¯«ï¼‰
- å‰¯æ¨™é¡Œå·®ç•°ï¼š"X: a systematic review" vs "X â€” a systematic review"

**æ–¹æ¡ˆ**: MinHash + LSH (Broder, 1997)

```python
from datasketch import MinHash, MinHashLSH

def fuzzy_dedup(articles: list[UnifiedArticle], threshold: float = 0.85):
    """MinHash LSH æ¨¡ç³Šå»é‡"""
    lsh = MinHashLSH(threshold=threshold, num_perm=128)

    for i, article in enumerate(articles):
        m = MinHash(num_perm=128)
        # Character n-grams (3-grams) æ¯” word-level æ›´æŠ—æ‹¼å¯«è®ŠåŒ–
        title_normalized = normalize_title(article.title)
        for ngram in ngrams(title_normalized, n=3):
            m.update(ngram.encode('utf8'))
        lsh.insert(str(i), m)

    # æŸ¥è©¢æ¯ç¯‡æ–‡ç« çš„è¿‘ä¼¼é‡è¤‡
    duplicates = []
    for i, article in enumerate(articles):
        m = create_minhash(article.title)
        results = lsh.query(m)
        # results åŒ…å«æ‰€æœ‰ Jaccard â‰¥ threshold çš„æ–‡ç« 
        ...
```

**èˆ‡ç¾æœ‰ Union-Find çš„æ•´åˆ**: MinHash ä½œç‚º Union-Find çš„**ç¬¬å››é€šé“**ï¼ˆDOI â†’ PMID â†’ Exact Title â†’ **Fuzzy Title**ï¼‰ï¼Œåªåœ¨å‰ä¸‰é€šé“æœªå‘½ä¸­æ™‚è§¸ç™¼ã€‚

**å¯¦ä½œé›£åº¦**: ä½ï¼ˆ`datasketch` å¥—ä»¶ï¼Œ~80 è¡Œï¼‰

---

#### ğŸ¥ˆ 3.2.3 æœå°‹è©å·®ç•°åˆ†æï¼ˆQuery Term Differentiationï¼‰

è©³è¦‹ [Â§5 å°ˆç¯€](#5-æœå°‹è©å·®ç•°åˆ†ææ¼”ç®—æ³•æ·±å…¥æ¢è¨)ã€‚

---

### 4.3 Tier 3ï¼šæœ‰ç”¨ä½†åå·¥ç¨‹

#### ğŸ¥‰ 3.3.1 Learning-to-Rank (LTR)

ç”¨ç¾æœ‰å…­ç¶­ç‰¹å¾µè¨“ç·´ LambdaMART æ¨¡å‹ï¼š
- è¨“ç·´è³‡æ–™ï¼šiCite percentile åšå¼±ç›£ç£ï¼ˆé«˜ percentile = é«˜å“è³ªæ’åï¼‰
- å·¥å…·ï¼š`xgboost` + `scikit-learn`
- å•é¡Œï¼šéœ€è¦è¶³å¤ çš„æ¨™è¨»è³‡æ–™ï¼Œå†·å•Ÿå‹•å›°é›£

**å¯¦ä½œé›£åº¦**: é«˜ | **å„ªå…ˆç´š**: ä½

#### ğŸ¥‰ 3.3.2 Dynamic Topic Models (DTM)

è¿½è¹¤ä¸»é¡Œéš¨æ™‚é–“çš„èªç¾©æ¼”åŒ–ï¼ˆä¸åªæ˜¯æ–‡ç« æ•¸é‡ï¼‰ï¼š
- å·¥å…·ï¼š`gensim.models.LdaSeqModel`
- è¼¸å‡ºï¼šã€Œ2015 å¹´æ­¤é ˜åŸŸä¸»è¦è¨è«– Aã€Bã€â†’ã€Œ2020 å¹´è½‰å‘ Cã€Dã€

**å¯¦ä½œé›£åº¦**: é«˜ | **å„ªå…ˆç´š**: ä½

#### ğŸ¥‰ 3.3.3 SPECTER2 èªæ„æ’åº

Allen AI çš„è«–æ–‡åµŒå…¥æ¨¡å‹ï¼Œå°ˆç‚ºæ–‡ç»ç›¸ä¼¼åº¦è¨­è¨ˆï¼š
- éœ€è¦ä¸‹è¼‰æ¨¡å‹ï¼ˆ~400MBï¼‰
- æ¨è«–éœ€è¦ GPU æˆ–è¼ƒé•· CPU æ™‚é–“
- æ•ˆæœæœ€å¥½ä½†éƒ¨ç½²é–€æª»é«˜

**å¯¦ä½œé›£åº¦**: é«˜ | **å„ªå…ˆç´š**: ä½

---

## 5. æœå°‹è©å·®ç•°åˆ†æï¼šæ¼”ç®—æ³•æ·±å…¥æ¢è¨

> é€™æ˜¯åŸå§‹å•é¡Œçš„æ ¸å¿ƒï¼š**æœ‰æ¼”ç®—æ³•å¯ä»¥æ›´é«˜æ•ˆçš„æ‰¾å‡ºæœå°‹è©ä¹‹é–“çš„å·®ç•°å—ï¼Ÿ**

### 5.1 å•é¡Œå®šç¾©

ç›®å‰çš„æœå°‹æ“´å±•æµç¨‹ï¼š

```
ç”¨æˆ¶è¼¸å…¥ "remimazolam ICU sedation"
    â†’ PubTator3 autocomplete å¾—åˆ° MeSH ID
    â†’ å›ºå®šç­–ç•¥æ¨¡æ¿: original / mesh_expanded / entity_semantic / fulltext_epmc / broad_tiab
    â†’ å„ç­–ç•¥ç¨ç«‹æœå°‹ â†’ çµæœåˆä½µ
```

**å•é¡Œ**: æˆ‘å€‘ä¸çŸ¥é“ï¼š
1. é€™äº›ç­–ç•¥ä¹‹é–“åˆ°åº•æœ‰å¤šå¤§å·®ç•°ï¼Ÿ
2. åŠ å…¥åŒç¾©è© "CNS 7056" æ˜¯å¦çœŸçš„æ‰¾åˆ°äº†ä¸åŒçš„æ–‡ç« ï¼Œé‚„æ˜¯é«˜åº¦é‡ç–Šï¼Ÿ
3. ç”¨ "[MeSH Terms]" vs "[Title/Abstract]" æœå°‹ï¼Œå„è‡ªçš„ç›²å€åœ¨å“ªï¼Ÿ

### 5.2 æ–¹æ¡ˆ Aï¼šæœå°‹çµæœé›†åˆå·®ç•°åˆ†æï¼ˆSet Difference Analysisï¼‰

**æœ€ç›´è§€ã€æœ€æœ‰åƒ¹å€¼çš„æ–¹æ³•**ã€‚

çµ¦å®šå…©å€‹æœå°‹ç­–ç•¥ $A$ å’Œ $B$ï¼ˆå„è¿”å›ä¸€çµ„æ–‡ç«  PMIDï¼‰ï¼Œè¨ˆç®—ï¼š

| æŒ‡æ¨™ | å…¬å¼ | æ„ç¾© |
|------|------|------|
| **Jaccard** ç›¸ä¼¼åº¦ | $J(A,B) = \frac{|A \cap B|}{|A \cup B|}$ | å…©ç­–ç•¥çµæœé‡ç–Šåº¦ |
| **A ç¨ä½”ç‡** | $\text{Excl}_A = \frac{|A \setminus B|}{|A|}$ | A èƒ½æ‰¾åˆ°ä½† B æ‰¾ä¸åˆ°çš„æ¯”ä¾‹ |
| **B ç¨ä½”ç‡** | $\text{Excl}_B = \frac{|B \setminus A|}{|B|}$ | B èƒ½æ‰¾åˆ°ä½† A æ‰¾ä¸åˆ°çš„æ¯”ä¾‹ |
| **å°ç¨±å·®ç•°** | $\Delta(A,B) = |A \triangle B| = |A \setminus B| + |B \setminus A|$ | å…©ç­–ç•¥çš„ä¸åŒæ–‡ç« ç¸½æ•¸ |
| **å¢ç›Šç‡** | $\text{Gain}_{A \to B} = \frac{|B \setminus A|}{|A|}$ | å¾ç­–ç•¥ A åˆ‡æ›åˆ° Bï¼Œé¡å¤–ç²å¾—çš„æ–‡ç« æ¯”ä¾‹ |

**é€²éšåˆ†æ**: å°ç¨ä½”æ–‡ç« åš MeSH term åˆ†å¸ƒåˆ†æ

```python
def analyze_strategy_difference(
    results_a: list[str],  # ç­–ç•¥ A çš„ PMIDs
    results_b: list[str],  # ç­–ç•¥ B çš„ PMIDs
    articles_cache: dict,  # PMID â†’ article å¿«å–
) -> StrategyDiffReport:
    """åˆ†æå…©å€‹æœå°‹ç­–ç•¥çš„çµæœå·®ç•°"""
    set_a, set_b = set(results_a), set(results_b)

    overlap = set_a & set_b
    only_a = set_a - set_b
    only_b = set_b - set_a

    # åŸºæœ¬çµ±è¨ˆ
    jaccard = len(overlap) / len(set_a | set_b) if set_a | set_b else 0

    # MeSH åˆ†å¸ƒå·®ç•°: ç¨ä½”æ–‡ç« ç”¨äº†å“ªäº› MeSHï¼Ÿ
    mesh_only_a = extract_mesh_terms(only_a, articles_cache)
    mesh_only_b = extract_mesh_terms(only_b, articles_cache)
    mesh_unique_to_a = mesh_only_a - mesh_only_b  # A ç¨æœ‰çš„ MeSH ä¸»é¡Œ
    mesh_unique_to_b = mesh_only_b - mesh_only_a  # B ç¨æœ‰çš„ MeSH ä¸»é¡Œ

    # ç™¼è¡¨å¹´åˆ†å¸ƒ: ç¨ä½”æ–‡ç« æ˜¯æ–°çš„é‚„æ˜¯èˆŠçš„ï¼Ÿ
    years_only_a = [articles_cache[p].year for p in only_a if p in articles_cache]
    years_only_b = [articles_cache[p].year for p in only_b if p in articles_cache]

    return StrategyDiffReport(
        jaccard=jaccard,
        overlap_count=len(overlap),
        only_a_count=len(only_a),
        only_b_count=len(only_b),
        mesh_unique_to_a=mesh_unique_to_a,
        mesh_unique_to_b=mesh_unique_to_b,
        year_distribution_a=years_only_a,
        year_distribution_b=years_only_b,
        recommendation=generate_recommendation(jaccard, only_a, only_b),
    )

def generate_recommendation(jaccard, only_a, only_b) -> str:
    """æ ¹æ“šåˆ†æçµæœç”Ÿæˆå»ºè­°"""
    if jaccard > 0.9:
        return "å…©å€‹ç­–ç•¥é«˜åº¦é‡ç–Š â€” å»ºè­°åªä¿ç•™å…¶ä¸­ä¸€å€‹ä»¥ç¯€çœ API é…é¡"
    elif jaccard > 0.6:
        return "ä¸­åº¦é‡ç–Š â€” å…©ç­–ç•¥äº’è£œï¼Œå»ºè­°åˆä½µä½¿ç”¨"
    elif jaccard < 0.3:
        return "ä½é‡ç–Š â€” å…©ç­–ç•¥æœå°‹ç¯„åœå·®ç•°å¤§ï¼Œå¯èƒ½éœ€è¦æª¢æŸ¥æ˜¯å¦æœ‰ä¸€å€‹éæ–¼åé›¢ä¸»é¡Œ"
```

**MCP å·¥å…·åŒ–**:

```python
@mcp_tool
async def analyze_search_strategies(
    query_a: str,
    query_b: str,
    limit: int = 100,
) -> StrategyDiffReport:
    """åˆ†æå…©å€‹æœå°‹ç­–ç•¥çš„å·®ç•°ï¼šå“ªå€‹æ‰¾åˆ°äº†ä»€éº¼ã€éŒ¯éäº†ä»€éº¼"""
```

### 5.3 æ–¹æ¡ˆ Bï¼šMeSH éšå±¤èªæ„è·é›¢

MeSH æ˜¯ä¸€æ£µ**æœ‰ 18 å€‹ä¸»è¦åˆ†æ”¯çš„éšå±¤æ¨¹**ï¼Œå¯ä»¥è¨ˆç®—ä»»æ„å…©å€‹ MeSH è¡“èªçš„èªæ„è·é›¢ã€‚

```
Tree Structure (excerpt):
D - Chemicals and Drugs
â”œâ”€â”€ D02 - Organic Chemicals
â”‚   â”œâ”€â”€ D02.455 - Hydrocarbons
â”‚   â””â”€â”€ D02.886 - Sulfur Compounds
â”œâ”€â”€ D03 - Heterocyclic Compounds
â”‚   â””â”€â”€ D03.383 - Heterocyclic, 1-Ring
â”‚       â””â”€â”€ D03.383.129 - Benzodiazepines
â”‚           â”œâ”€â”€ ...remimazolam...
â”‚           â””â”€â”€ ...midazolam...
â””â”€â”€ D27 - Chemical Actions and Uses
    â””â”€â”€ D27.505 - Pharmacologic Actions
        â””â”€â”€ D27.505.696 - Physiological Effects of Drugs
            â””â”€â”€ ...propofol...
```

**è·é›¢è¨ˆç®—æ–¹æ³•**:

| æ–¹æ³• | å…¬å¼ | ç‰¹é» |
|------|------|------|
| **Path Length** | $\text{dist}(a,b) = \text{shortest\_path}(a, b)$ | æœ€ç°¡å–®ï¼Œä¸è€ƒæ…®æ·±åº¦ |
| **Wu-Palmer** | $\text{sim}(a,b) = \frac{2 \cdot \text{depth}(\text{LCA})}{depth(a) + depth(b)}$ | è€ƒæ…®æœ€è¿‘å…¬å…±ç¥–å…ˆæ·±åº¦ |
| **Lin** | $\text{sim}(a,b) = \frac{2 \cdot IC(\text{LCA})}{IC(a) + IC(b)}$ | åŸºæ–¼ Information Content |
| **Resnik** | $\text{sim}(a,b) = IC(\text{LCA})$ | åªçœ‹ LCA çš„ Information Content |

å…¶ä¸­ LCA = Lowest Common Ancestorï¼ˆæœ€è¿‘å…¬å…±ç¥–å…ˆï¼‰ï¼Œ$IC(c) = -\log P(c)$ æ˜¯èªæ–™åº«é »ç‡çš„ä¿¡æ¯é‡ã€‚

```python
# ä½¿ç”¨ NCBI MeSH API å–å¾—æ¨¹è™Ÿ
async def mesh_semantic_distance(
    term_a: str,
    term_b: str,
    method: str = "wu_palmer",
) -> float:
    """è¨ˆç®—å…©å€‹ MeSH è¡“èªçš„èªæ„è·é›¢"""
    # 1. æŸ¥è©¢ MeSH æ¨¹è™Ÿ
    tree_a = await get_mesh_tree_numbers(term_a)  # e.g., ["D03.383.129.xxx"]
    tree_b = await get_mesh_tree_numbers(term_b)  # e.g., ["D03.383.129.yyy"]

    # 2. è¨ˆç®—æœ€è¿‘å…¬å…±ç¥–å…ˆ
    lca = lowest_common_ancestor(tree_a, tree_b)

    # 3. Wu-Palmer ç›¸ä¼¼åº¦
    if method == "wu_palmer":
        depth_lca = len(lca.split("."))
        depth_a = len(tree_a[0].split("."))
        depth_b = len(tree_b[0].split("."))
        return (2 * depth_lca) / (depth_a + depth_b)
```

**æ‡‰ç”¨**: ç•¶ SemanticEnhancer ç”¢ç”Ÿå¤šå€‹åŒç¾©è©æ™‚ï¼Œè¨ˆç®—å®ƒå€‘ä¹‹é–“çš„èªæ„è·é›¢ï¼š
- è·é›¢è¿‘ï¼ˆå¦‚ remimazolam å’Œ CNS 7056ï¼‰â†’ è¿‘åŒç¾©è©ï¼ŒOR é€£æ¥å³å¯
- è·é›¢ä¸­ï¼ˆå¦‚ remimazolam å’Œ midazolamï¼‰â†’ åŒé¡è—¥ç‰©ï¼Œæœ‰æ„ç¾©çš„æ“´å±•
- è·é›¢é ï¼ˆå¦‚ remimazolam å’Œ propofolï¼‰â†’ ä¸åŒé¡åˆ¥ï¼Œæ¯”è¼ƒæ€§æœå°‹

### 5.4 æ–¹æ¡ˆ Cï¼šæœå°‹è©å‘é‡è·é›¢ï¼ˆBioWordVecï¼‰

ä½¿ç”¨é è¨“ç·´çš„ç”Ÿé†«è©å‘é‡è¨ˆç®—æœå°‹è©ä¹‹é–“çš„èªæ„è·é›¢ï¼š

```python
# BioWordVec: Zhang et al. (2019), åŸºæ–¼ PubMed + MIMIC-III è¨“ç·´
import gensim

model = gensim.models.KeyedVectors.load("BioWordVec_PubMed_MIMICIII_d200.bin")

def query_semantic_distance(query_a: str, query_b: str) -> float:
    """è¨ˆç®—å…©å€‹æœå°‹æŸ¥è©¢çš„èªæ„è·é›¢"""
    vec_a = average_word_vectors(tokenize(query_a), model)
    vec_b = average_word_vectors(tokenize(query_b), model)
    return cosine_similarity(vec_a, vec_b)
```

**å•é¡Œ**: éœ€è¦ä¸‹è¼‰ ~4GB çš„æ¨¡å‹æª”æ¡ˆï¼Œä¸é©åˆè¼•é‡éƒ¨ç½²ã€‚

**æ›¿ä»£æ–¹æ¡ˆ**: ä½¿ç”¨ NCBI API ç·šä¸Šè¨ˆç®—èªæ„ç›¸ä¼¼åº¦ï¼Œæˆ–ç”¨æ›´è¼•é‡çš„ TF-IDF å‘é‡ã€‚

### 5.5 æ–¹æ¡ˆæ¯”è¼ƒ

| æ–¹æ¡ˆ | éœ€è¦æ¨¡å‹ï¼Ÿ | éœ€è¦æœå°‹ï¼Ÿ | ç²¾ç¢ºåº¦ | å¯è§£é‡‹æ€§ | å¯¦ä½œé›£åº¦ |
|------|:---------:|:---------:|:------:|:--------:|:--------:|
| **A. é›†åˆå·®ç•°** | âŒ | âœ… éœ€åŸ·è¡Œæœå°‹ | â­â­â­ | â­â­â­ æœ€ä½³ | ä½ |
| **B. MeSH è·é›¢** | âŒ | âŒ | â­â­ | â­â­â­ | ä¸­ |
| **C. è©å‘é‡** | âœ… 4GB | âŒ | â­â­â­ | â­ | é«˜ |

**æ¨è–¦**: å…ˆå¯¦ä½œæ–¹æ¡ˆ Aï¼ˆé›†åˆå·®ç•°ï¼‰ï¼Œå› ç‚ºå®ƒï¼š
1. ä¸éœ€è¦æ¨¡å‹
2. çµæœæœ€ç›´è§€ã€å¯è§£é‡‹ï¼ˆã€Œç­–ç•¥ A æ¯”ç­–ç•¥ B å¤šæ‰¾åˆ° 15 ç¯‡é—œæ–¼ XXX çš„æ–‡ç« ã€ï¼‰
3. å¯ä»¥ç›´æ¥æ•´åˆé€²ç¾æœ‰çš„ Deep Search æµç¨‹

ç„¶å¾Œç”¨æ–¹æ¡ˆ Bï¼ˆMeSH è·é›¢ï¼‰åš**å…ˆé©—åˆ†æ**ï¼ˆæœå°‹å‰åˆ¤æ–·è©çš„å·®ç•°æœ‰å¤šå¤§ï¼‰ï¼Œæ–¹æ¡ˆ A åš**å¾Œé©—åˆ†æ**ï¼ˆæœå°‹å¾Œçœ‹çµæœå·®ç•°æœ‰å¤šå¤§ï¼‰ã€‚

---

## 6. å¯¦æ–½è·¯ç·šåœ–

### Phase Aï¼šå¿«é€Ÿå‹åˆ©ï¼ˆ1-2 é€±ï¼‰â€” ç„¡éœ€ ML æ¨¡å‹

| # | ä»»å‹™ | æ›¿æ›ç›®æ¨™ | é ä¼°è¡Œæ•¸ | ä¾è³´ |
|---|------|---------|:--------:|------|
| A1 | BM25 æ’åº | `_calculate_relevance()` çš„ term overlap | ~100 | `rank_bm25` |
| A2 | Reciprocal Rank Fusion | `_enrich_with_similarity_scores()` | ~30 | ç„¡ |
| A3 | Pseudo-Relevance Feedback | SemanticEnhancer ç­–ç•¥ç”Ÿæˆ | ~150 | ç„¡ |
| A4 | MinHash æ¨¡ç³Šå»é‡ | Union-Find ç¬¬å››é€šé“ | ~80 | `datasketch` |

**Phase A çš„é©—è­‰**: é¸ 10 å€‹ TREC PM ä¸»é¡Œï¼Œæ¯”è¼ƒæ”¹é€²å‰å¾Œçš„ nDCG@10ã€‚

### Phase Bï¼šæ ¸å¿ƒæ¼”ç®—æ³•ï¼ˆ2-4 é€±ï¼‰â€” ç¶“å…¸æ¼”ç®—æ³•å¯¦ä½œ

| # | ä»»å‹™ | æ–°å¢ MCP å·¥å…· | é ä¼°è¡Œæ•¸ | ä¾è³´ |
|---|------|-------------|:--------:|------|
| B1 | Main Path Analysis | `analyze_citation_network` | ~300 | `networkx` |
| B2 | Citation Burst Detection | å¢å¼· `build_research_timeline` | ~200 | ç„¡ï¼ˆè‡ªè¡Œå¯¦ä½œ Viterbiï¼‰ |
| B3 | MeSH èªæ„è·é›¢ | `compare_search_terms` | ~200 | NCBI MeSH API |
| B4 | æœå°‹ç­–ç•¥å·®ç•°åˆ†æ | `analyze_search_strategies` | ~150 | ç„¡ |
| B5 | Community Detection | å¢å¼· `build_citation_tree` | ~100 | `networkx` |

**Phase B çš„é©—è­‰**:
- Main Path: èˆ‡ CiteSpace çš„ Main Path çµæœäº¤å‰é©—è­‰
- Burst: èˆ‡ CiteSpace çš„ Burst Detection çµæœäº¤å‰é©—è­‰
- MeSH è·é›¢: èˆ‡ UMLS Similarity æœå‹™çš„çµæœç›¸é—œæ€§åˆ†æ

### Phase Cï¼šML å¢å¼·ï¼ˆ4-8 é€±ï¼‰â€” éœ€è¦æ¨¡å‹

| # | ä»»å‹™ | é ä¼°è¡Œæ•¸ | ä¾è³´ |
|---|------|:--------:|------|
| C1 | SPECTER2 èªæ„æ’åº | ~400 | `transformers`, GPU |
| C2 | PubMedBERT æ„åœ–åˆ†é¡ | ~300 | `transformers` |
| C3 | Dynamic Topic Models | ~500 | `gensim` |

### é‡Œç¨‹ç¢‘

```
2026-02 â”€â”€â”€ Phase A é–‹å§‹ (BM25 + RRF + PRF + MinHash)
   â”‚
2026-03 â”€â”€â”€ Phase A å®Œæˆ + é©—è­‰
   â”‚        Phase B é–‹å§‹ (Main Path + Burst + MeSH Distance)
   â”‚
2026-04 â”€â”€â”€ Phase B å®Œæˆ + é©—è­‰
   â”‚        è«–æ–‡ Evaluation ç« ç¯€å¯æ’°å¯«
   â”‚
2026-05 â”€â”€â”€ Phase C (å¯é¸) + è«–æ–‡æŠ•ç¨¿æº–å‚™
```

---

## 7. é©—è­‰æ–¹æ³•è«–

### 7.1 æ’åºå“è³ªï¼ˆPhase Aï¼‰

**Benchmark**: TREC Precision Medicine (2017-2020)

| æŒ‡æ¨™ | èªªæ˜ |
|------|------|
| **nDCG@10** | å‰ 10 åçš„ Normalized Discounted Cumulative Gain |
| **P@10** | å‰ 10 åçš„ç²¾ç¢ºç‡ |
| **MAP** | Mean Average Precision |

**å°æ¯”çµ„**:
- Baseline: ç¾æœ‰ term overlapï¼ˆbag-of-wordsï¼‰
- BM25: åƒ… BM25
- BM25+RRF: BM25 æ’åº + å¤šæº RRF èåˆ
- BM25+RRF+PRF: åŠ å…¥ Pseudo-Relevance Feedback

### 7.2 å»é‡å“è³ªï¼ˆPhase Aï¼‰

**æ–¹æ³•**: äººå·¥æ¨™è¨» 200 å°è·¨ä¾†æºæ–‡ç« ï¼ˆæ˜¯å¦ç‚ºåŒä¸€ç¯‡ï¼‰

| æŒ‡æ¨™ | èªªæ˜ |
|------|------|
| **Precision** | è¢«åˆ¤å®šç‚ºé‡è¤‡çš„æ–‡ç« å°ä¸­ï¼ŒçœŸæ­£é‡è¤‡çš„æ¯”ä¾‹ |
| **Recall** | æ‰€æœ‰çœŸæ­£é‡è¤‡çš„æ–‡ç« å°ä¸­ï¼Œè¢«æ­£ç¢ºè­˜åˆ¥çš„æ¯”ä¾‹ |
| **F1** | Precision å’Œ Recall çš„èª¿å’Œå¹³å‡ |

### 7.3 ç¶²è·¯åˆ†æï¼ˆPhase Bï¼‰

**æ–¹æ³•**: é¸ 5 å€‹å·²è¢« CiteSpace åˆ†æéçš„ä¸»é¡Œï¼Œæ¯”è¼ƒçµæœä¸€è‡´æ€§

| æŒ‡æ¨™ | èªªæ˜ |
|------|------|
| **Main Path å»åˆç‡** | ç³»çµ±æ‰¾åˆ°çš„ main path ç¯€é»èˆ‡ CiteSpace çµæœçš„ Jaccard |
| **Burst æ™‚æ®µé‡ç–Š** | burst period çš„ temporal IoU (Intersection over Union) |
| **Community ä¸€è‡´æ€§** | NMI (Normalized Mutual Information) |

### 7.4 æœå°‹ç­–ç•¥å·®ç•°ï¼ˆPhase Bï¼‰

**æ–¹æ³•**: å®šæ€§æ¡ˆä¾‹ç ”ç©¶ï¼ˆ5 å€‹ä¸»é¡Œï¼‰ï¼Œå±•ç¤ºå·®ç•°åˆ†æå¦‚ä½•å¹«åŠ©ç”¨æˆ¶ç†è§£æœå°‹çµæœ

---

## 8. ç›¸é—œæ–‡ç»

### è³‡è¨Šæª¢ç´¢ (Information Retrieval)

| æ–‡ç» | å¹´ä»½ | è²¢ç» |
|------|:----:|------|
| Robertson & Zaragoza, "The Probabilistic Relevance Framework: BM25 and Beyond" | 2009 | BM25 æ¼”ç®—æ³•çš„æ¬Šå¨ç¶œè¿° |
| Cormack et al., "Reciprocal Rank Fusion outperforms Condorcet and individual Rank Learning Methods" | 2009 | RRF çš„æå‡ºå’Œé©—è­‰ |
| Rocchio, "Relevance Feedback in Information Retrieval" | 1971 | ç›¸é—œæ€§åé¥‹çš„å…ˆé©…å·¥ä½œ |
| Lavrenko & Croft, "Relevance-Based Language Models" | 2001 | PRF çš„èªè¨€æ¨¡å‹æ–¹æ³• |
| Broder, "On the Resemblance and Containment of Documents" | 1997 | MinHash å’Œæ–‡ä»¶ç›¸ä¼¼åº¦ |

### å¼•æ–‡å­¸ (Bibliometrics)

| æ–‡ç» | å¹´ä»½ | è²¢ç» |
|------|:----:|------|
| Hummon & Doreian, "Connectivity in a citation network" | 1989 | Main Path Analysis çš„æå‡º |
| Liu & Lu, "An integrated approach for main path analysis" | 2012 | Main Path çš„æ”¹é€²æ–¹æ³• |
| Blondel et al., "Fast unfolding of communities in large networks" | 2008 | Louvain ç¤¾ç¾¤åµæ¸¬ç®—æ³• |
| Kleinberg, "Bursty and Hierarchical Structure in Streams" | 2003 | çªç™¼åµæ¸¬æ¼”ç®—æ³• |
| Page et al., "The PageRank Citation Ranking" | 1999 | PageRank æ¼”ç®—æ³• |

### èªæ„ç›¸ä¼¼åº¦ (Semantic Similarity)

| æ–‡ç» | å¹´ä»½ | è²¢ç» |
|------|:----:|------|
| Pedersen et al., "Measures of semantic similarity and relatedness in the biomedical domain" | 2007 | UMLS èªæ„ç›¸ä¼¼åº¦è©•ä¼° |
| Resnik, "Using information content to evaluate semantic similarity in a taxonomy" | 1995 | IC-based èªæ„è·é›¢ |
| Lin, "An information-theoretic definition of similarity" | 1998 | Lin ç›¸ä¼¼åº¦ |
| Wu & Palmer, "Verb semantics and lexical selection" | 1994 | Wu-Palmer ç›¸ä¼¼åº¦ |

### ç”Ÿé†« NLP (Biomedical NLP)

| æ–‡ç» | å¹´ä»½ | è²¢ç» |
|------|:----:|------|
| Gu et al., "Domain-Specific Language Model Pretraining for Biomedical NLP" | 2021 | PubMedBERT |
| Singh et al., "SciRepEval: A Multi-Format Benchmark for Scientific Document Representations" | 2023 | SPECTER2 |
| Zhang et al., "BioWordVec: Improving Biomedical Word Embeddings" | 2019 | BioWordVec |

---

## é™„éŒ„ Aï¼šèˆ‡æ—¢æœ‰ paper-draft.md çš„é—œä¿‚

| paper-draft.md å®šä½ | æœ¬æ–‡ä»¶å®šä½ |
|--------------------|--------------------|
| å°å¤–è«–æ–‡ï¼ˆæŠ•ç¨¿ç”¨ï¼‰ | å…§éƒ¨ç ”ç©¶æ–‡ä»¶ |
| èšç„¦ Timeline åŠŸèƒ½ | èšç„¦å…¨é¢çš„æ¼”ç®—æ³•å‡ç´š |
| å·²æœ‰æ¶æ§‹ä½†ç¼ºé©—è­‰ | æä¾›é©—è­‰æ–¹æ³•è«– |
| Abstract å·²æˆå½¢ | è£œå……æ ¸å¿ƒ IR æ¼”ç®—æ³•å‰µæ–° |

**å»ºè­°**: è«–æ–‡çš„ Section 2 (Architecture) å¯å¢åŠ æœ¬æ–‡ä»¶çš„æ’åºå’Œå»é‡æ¼”ç®—æ³•æè¿°ï¼ŒSection 4 (Evaluation) å¯æ¡ç”¨æœ¬æ–‡ä»¶çš„é©—è­‰æ–¹æ³•è«–ã€‚BM25+RRF å’Œ PRF æ˜¯è«–æ–‡ä¸­æœ€å®¹æ˜“é‡åŒ–å±•ç¤ºçš„è²¢ç»ã€‚

---

## é™„éŒ„ Bï¼šèª å¯¦é¢¨éšªè©•ä¼°

| é¢¨éšª | åš´é‡åº¦ | å°ç­– |
|------|:------:|------|
| BM25 å·²æ˜¯ 30 å¹´å‰çš„æ¼”ç®—æ³•ï¼Œreviewers å¯èƒ½èªç‚ºä¸å¤ æ–° | ä¸­ | çµåˆ RRF + å¤šæº + ç”Ÿé†«é ˜åŸŸå®šåˆ¶ï¼Œå¼·èª¿ã€Œç³»çµ±å±¤é¢çš„å‰µæ–°ã€ |
| Citation Burst èˆ‡ CiteSpace åŠŸèƒ½é‡ç–Š | ä¸­ | å¼·èª¿ã€ŒAgent-accessibleã€â€”â€” CiteSpace æ˜¯æ¡Œé¢è»Ÿé«”ï¼Œæˆ‘å€‘æ˜¯ API |
| æ²’æœ‰çœŸæ­£çš„ ML æ¨¡å‹ | ä½ | Phase A+B å®Œå…¨ä¸éœ€ MLï¼Œåè€Œæ˜¯å„ªå‹¢ï¼ˆè¼•é‡éƒ¨ç½²ã€ç„¡ GPU ä¾è³´ï¼‰ |
| MinHash çš„ `datasketch` å¢åŠ éƒ¨ç½²é«”ç© | ä½ | datasketch æ˜¯ç´” Pythonï¼Œé«”ç©å° |
| MeSH è·é›¢ä¾è³´ NCBI API ç©©å®šæ€§ | ä½ | å¯å¿«å– MeSH æ¨¹çµæ§‹åˆ°æœ¬åœ° |

---
---

## 9. Technical Specï¼šSearch Rank Fusion & Diff Engine

> **ç‹€æ…‹**: è¨­è¨ˆè¨è«–ä¸­ (v0.1)  
> **å‰ç½®ä¾è³´**: æœ¬æ–‡ä»¶ Â§2ï¼ˆç—›é»åˆ†æï¼‰ã€Â§4.1ï¼ˆBM25 + RRFï¼‰  
> **ç›®æ¨™**: å°‡ Â§2 + Â§4.1 çš„ç†è«–æ–¹æ¡ˆè½åœ°ç‚ºå¯å¯¦ä½œçš„æŠ€è¡“è¦æ ¼  
> **å»ºç«‹æ—¥æœŸ**: 2026-02-15

### 9.1 æ¦‚è¿° (Overview)

æœ¬æ¨¡çµ„è² è²¬æ¥æ”¶ä¾†è‡ªå¤šå€‹ç•°è³ªå­¸è¡“æœå°‹ APIï¼ˆå¦‚ OpenAlex, CrossRef, Europe PMC, Semantic Scholar, PubMedï¼‰çš„åŸå§‹çµæœï¼ŒåŸ·è¡Œ**æ¨™æº–åŒ–ã€å»é‡ã€æ’åèåˆï¼ˆRRFï¼‰**ï¼Œä¸¦èˆ‡åŒä¸€ Session ä¸­çš„ä¸Šä¸€æ¬¡æœå°‹ç‹€æ…‹é€²è¡Œæ¯”å°ã€‚æœ€çµ‚è¼¸å‡ºä¸€å€‹ç²¾ç°¡çš„ã€å…·å‚™ã€Œæ–°ç©æ€§ã€èˆ‡ã€Œè¶¨å‹¢æ€§ã€çš„ JSON å ±å‘Šçµ¦ AI Agentã€‚

**æ ¸å¿ƒåƒ¹å€¼**ï¼šè§£æ±º Â§2 è­˜åˆ¥çš„ä¸‰å¤§ç—›é» â€”â€” çµæœä¸å¯æ¶ˆåŒ–ã€æœå°‹é–“ç„¡è¨˜æ†¶ã€æ’åºèˆ‡ç ”ç©¶å•é¡Œè„«ç¯€ã€‚

### 9.2 ç³»çµ±æ¶æ§‹èˆ‡è³‡æ–™æµ (Architecture)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Fusion Engine Pipeline                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ OpenAlex â”‚  â”‚ CrossRef â”‚  â”‚  Europe  â”‚  â”‚ Semantic â”‚  ... more   â”‚
â”‚  â”‚ Top 100  â”‚  â”‚ Top 100  â”‚  â”‚   PMC    â”‚  â”‚ Scholar  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚
â”‚       â”‚              â”‚              â”‚              â”‚                 â”‚
â”‚       â–¼              â–¼              â–¼              â–¼                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Stage 1: Normalization & Deduplication              â”‚            â”‚
â”‚  â”‚  UID = DOI > PMID > Title Hash                       â”‚            â”‚
â”‚  â”‚  Union-Find O(n) å»é‡ (ç¾æœ‰ ResultAggregator åŸºç¤)   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                         â”‚ List[UnifiedDoc]                          â”‚
â”‚                         â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Stage 2: RRF Score Calculation                      â”‚            â”‚
â”‚  â”‚  RRF(d) = Î£ 1/(k + rank_source(d))                  â”‚            â”‚
â”‚  â”‚  k = 60 (configurable)                               â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                         â”‚ Sorted by rrf_score                       â”‚
â”‚                         â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Stage 3: Quality Re-ranking (Optional)              â”‚            â”‚
â”‚  â”‚  Blend: Î±Â·rrf_score + (1-Î±)Â·quality_score            â”‚            â”‚
â”‚  â”‚  quality = f(recency, impact, article_type, ...)     â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                         â”‚ Final ranked list                         â”‚
â”‚                         â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Stage 4: Differential Analysis                      â”‚            â”‚
â”‚  â”‚  Compare with Session fusion_history[-1]             â”‚            â”‚
â”‚  â”‚  Categorize: NEW / HIGH_RISER / STAGNANT / DROPPING  â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                         â”‚                                           â”‚
â”‚                         â–¼                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚  Stage 5: Insight Generation                         â”‚            â”‚
â”‚  â”‚  global_consensus_new / high_risers / source_gems    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                         â”‚                                           â”‚
â”‚                         â–¼                                           â”‚
â”‚              AgentSummary (JSON) + Session Update                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.3 è³‡æ–™çµæ§‹å®šç¾© (Data Structures)

#### 9.3.1 åŸå§‹è¼¸å…¥ç‰©ä»¶ (Raw Search Result)

```python
@dataclass
class RawSearchResult:
    """å–®ä¸€ä¾†æº API è¿”å›çš„åŸå§‹çµæœ"""
    source: str          # e.g., "openalex", "crossref", "europe_pmc", "semantic_scholar"
    original_rank: int   # 1-based rank from API
    title: str
    doi: str | None      # Normalized DOI (lowercase, no prefix)
    pmid: str | None     # PubMed ID (å¦‚æœ‰)
    year: int | None
    snippet: str         # Title + abstract å‰ 200 å­—
```

> **èˆ‡ç¾æœ‰ç³»çµ±çš„é—œä¿‚**: ç¾æœ‰ `UnifiedArticle` çš„å·¥å» æ–¹æ³• (`from_openalex`, `from_crossref` ç­‰) å·²ç¶“åšäº†å¤§éƒ¨åˆ†æ¬„ä½æ˜ å°„ã€‚`RawSearchResult` æ˜¯ `UnifiedArticle` çš„**ç²¾ç°¡æŠ•å½±**ï¼Œåƒ…ä¿ç•™ RRF èåˆæ‰€éœ€çš„æ¬„ä½ã€‚å¯ä»¥å¾ `UnifiedArticle` ç›´æ¥å»ºæ§‹ã€‚

#### 9.3.2 çµ±ä¸€æ–‡æª”ç‰©ä»¶ (Unified Document)

ç³»çµ±å…§éƒ¨çš„è™•ç†å–®å…ƒï¼Œç¶“å»é‡å¾Œç”¢ç”Ÿã€‚

```python
@dataclass
class UnifiedDoc:
    uid: str                    # Unique ID (è¦‹ Â§9.4.1 UID ç­–ç•¥)
    title: str
    rrf_score: float            # Calculated RRF Score
    rrf_rank: int               # Final rank after RRF (1-based)
    sources: list[str]          # e.g., ["openalex:2", "crossref:5"]
    source_count: int           # len(unique sources) â€” å¿«é€Ÿå­˜å–
    metadata: dict              # Merged metadata (year, authors, doi, pmid, etc.)
    quality_score: float | None # Optional: from Stage 3 re-ranking
    blended_score: float | None # Optional: Î±Â·rrf + (1-Î±)Â·quality
```

> **èˆ‡ç¾æœ‰ç³»çµ±çš„é—œä¿‚**: `UnifiedDoc` ä¸æ›¿ä»£ `UnifiedArticle`ï¼Œè€Œæ˜¯ RRF èåˆæµç¨‹çš„**ä¸­é–“ç”¢ç‰©**ã€‚æœ€çµ‚çµæœä»è½‰æ›å› `UnifiedArticle` è¿”å›çµ¦ MCP å·¥å…·å±¤ã€‚

#### 9.3.3 Session ç‹€æ…‹æ“´å±• (Fusion History)

**è¨­è¨ˆæ±ºç­–**: ä¸æ–°å»º `SessionState`ï¼Œè€Œæ˜¯æ“´å±•ç¾æœ‰ `ResearchSession`ã€‚

```python
@dataclass
class FusionTurn:
    """æ¯ä¸€è¼ªæœå°‹çš„ RRF èåˆç‹€æ…‹å¿«ç…§"""
    query: str
    timestamp: float
    rank_map: dict[str, int]        # {uid: final_rank} â€” åƒ… Top 100
    rrf_scores: dict[str, float]    # {uid: rrf_score} â€” åƒ… Top 100
    source_breakdown: dict[str, int]  # {"openalex": 45, "crossref": 38, ...}
    total_fused: int                  # å»é‡å¾Œç¸½æ•¸

class ResearchSession:
    # ... ç¾æœ‰æ¬„ä½ä¿æŒä¸è®Š ...
    # article_cache: dict[str, dict]
    # search_history: list[dict]
    # reading_list: dict[str, dict]
    # excluded_pmids: list[str]

    fusion_history: list[FusionTurn] = field(default_factory=list)  # â† æ–°å¢
```

> **è¨˜æ†¶é«”æ§åˆ¶**: `rank_map` å’Œ `rrf_scores` åƒ…å„²å­˜ Top 100ï¼ˆç”± `TOP_N_PROCESS` æ§åˆ¶ï¼‰ï¼Œæ¯è¼ªç´„ 100 Ã— 2 Ã— 50 bytes â‰ˆ 10 KBã€‚å³ä½¿ 50 è¼ªæœå°‹ä¹Ÿåƒ…ä½” 500 KBã€‚

### 9.4 æ ¸å¿ƒæ¼”ç®—æ³•é‚è¼¯ (Core Algorithms)

#### 9.4.1 UID ç­–ç•¥ï¼šä¸‰ç´šè­˜åˆ¥ç¬¦ (Normalization)

**ç›®çš„**: ç¢ºä¿åŒä¸€ç¯‡è«–æ–‡åœ¨ä¸åŒ API ä¸­è¢«è¦–ç‚ºåŒä¸€å€‹å¯¦é«”ã€‚

**è¨­è¨ˆæ±ºç­–**: æ¡ç”¨ **DOI > PMID > Title Hash** ä¸‰ç´šç­–ç•¥ï¼Œèˆ‡ç¾æœ‰ `ResultAggregator` çš„ä¸‰é€šé“åŒ¹é…ä¿æŒä¸€è‡´ã€‚

```python
import hashlib
import re

def compute_uid(article: RawSearchResult) -> str:
    """ä¸‰ç´š UID è¨ˆç®—ç­–ç•¥

    å„ªå…ˆç´š:
    1. DOI â€” å…¨çƒå”¯ä¸€ã€è·¨ä¾†æºæ¨™æº–åŒ–
    2. PMID â€” PubMed ç©©å®š IDï¼Œæ¶ˆé™¤èªè¨€/ç‰¹æ®Šå­—å…ƒå•é¡Œ
    3. Title Hash â€” æœ€å¾Œæ‰‹æ®µï¼Œsha256(æ­£è¦åŒ–æ¨™é¡Œ)[:16]
    """
    if article.doi:
        # ç§»é™¤å‰ç¶´ã€å°å¯«ã€å»ç©ºæ ¼
        doi = article.doi.lower().strip()
        doi = re.sub(r'^https?://(dx\.)?doi\.org/', '', doi)
        return f"doi:{doi}"
    if article.pmid:
        return f"pmid:{article.pmid.strip()}"
    # Fallback: title hash
    normalized = re.sub(r'[^a-z0-9]', '', article.title.lower())
    title_hash = hashlib.sha256(normalized.encode()).hexdigest()[:16]
    return f"hash:{title_hash}"
```

**å»é‡æ•´åˆ**: UID ç›¸åŒçš„æ–‡ç« æœƒè¢«åˆä½µ â€” æ–°çš„ `source:rank` è¿½åŠ åˆ° `sources` åˆ—è¡¨ï¼Œmetadata åš union åˆä½µï¼ˆä¿ç•™è³‡è¨Šé‡æœ€è±å¯Œçš„æ¬„ä½ï¼‰ã€‚é€™èˆ‡ç¾æœ‰ `ResultAggregator` çš„ Union-Find é‚è¼¯ä¸€è‡´ã€‚

#### 9.4.2 å€’æ•¸æ’åèåˆ (Reciprocal Rank Fusion, RRF)

**ç›®çš„**: ä¸ä¾è³´ API çš„çµ•å°åˆ†æ•¸ï¼ˆå„ä¾†æºåˆ†æ•¸é‡ç¶±ä¸åŒï¼‰ï¼Œåƒ…ä¾è³´æ’åä¾†è¨ˆç®—æ¬Šé‡ã€‚

**å…¬å¼**:

$$\text{RRF}(d) = \sum_{s \in S_d} \frac{1}{k + \text{rank}_s(d)}$$

å…¶ä¸­ï¼š
- $k = 60$ï¼ˆç¶“é©—å¸¸æ•¸ï¼Œé¿å…æ’åç¬¬ 1 çš„æ¬Šé‡éå¤§ï¼‰
- $S_d$ æ˜¯æ–‡ä»¶ $d$ å‡ºç¾çš„ä¾†æºé›†åˆ
- $\text{rank}_s(d)$ æ˜¯æ–‡ä»¶ $d$ åœ¨ä¾†æº $s$ ä¸­çš„æ’åï¼ˆ1-basedï¼‰

**Implementation**:

```python
def reciprocal_rank_fusion(
    source_rankings: dict[str, list[str]],  # {source_name: [uid1, uid2, ...]}
    k: int = 60,
) -> dict[str, float]:
    """RRF èåˆå¤šä¾†æºæ’å

    Args:
        source_rankings: æ¯å€‹ä¾†æºçš„ UID æ’ååˆ—è¡¨ (1-based implicit)
        k: å¹³æ»‘å¸¸æ•¸ (é è¨­ 60)

    Returns:
        {uid: rrf_score}ï¼Œç”±é«˜è‡³ä½æ’åº
    """
    scores: dict[str, float] = {}
    for source, ranked_uids in source_rankings.items():
        for rank_0based, uid in enumerate(ranked_uids):
            rank = rank_0based + 1  # è½‰ç‚º 1-based
            scores[uid] = scores.get(uid, 0.0) + 1.0 / (k + rank)
    return dict(sorted(scores.items(), key=lambda x: x[1], reverse=True))
```

**æœªå‡ºç¾ä¾†æºçš„è™•ç† â€” âš ï¸ æ ¸å¿ƒè¨­è¨ˆè­°é¡Œ (å¾…å®š)**:

è‹¥æŸæ–‡ä»¶åªåœ¨ 1 å€‹ä¾†æºçš„ Rank 1 å‡ºç¾ï¼Œå…¶ RRF åˆ†æ•¸ç‚ºï¼š

$$\text{RRF}_{\text{single}} = \frac{1}{60 + 1} = 0.0164$$

è‹¥å¦ä¸€æ–‡ä»¶åœ¨ 3 å€‹ä¾†æºéƒ½æ’ Rank 50ï¼š

$$\text{RRF}_{\text{multi}} = 3 \times \frac{1}{60 + 50} = 0.0273$$

å¤šä¾†æºä½æ’å > å–®ä¾†æºé«˜æ’åã€‚é€™å¼•å‡ºå…©å€‹å°ç«‹çš„è¨­è¨ˆå“²å­¸ï¼š

**æ–¹æ¡ˆ Aï¼šStandard RRFï¼ˆå…±è­˜å„ªå…ˆï¼‰**

```
å“²å­¸: ã€Œå¤šä¾†æºéƒ½èªç‚ºç›¸é—œã€æ¯”ã€Œå–®ä¸€ä¾†æºå¼·æ¨ã€æ›´å¯ä¿¡
å„ªé»: æŠ—å™ªèƒ½åŠ›å¼· â€” å–®ä¸€ API çš„æ’åºåå·®è¢«ç¨€é‡‹
ç¼ºé»: å¯èƒ½åŸ‹æ²’ã€Œç¨å®¶ç™¼ç¾ã€â€” åƒ…åœ¨æŸç‰¹å®šä¾†æºé ‚éƒ¨å‡ºç¾çš„è«–æ–‡
é©ç”¨: ä¸€èˆ¬æœå°‹ï¼ˆè¿½æ±‚ç©©å®šã€å¯é çš„çµæœï¼‰
```

**æ–¹æ¡ˆ Bï¼šSource-Boosted RRFï¼ˆç¨å®¶åŠ æ¬Šï¼‰**

å°åªå‡ºç¾åœ¨ 1 å€‹ä¾†æºçš„é«˜æ’åæ–‡ç« çµ¦äºˆè£œå„Ÿï¼š

```python
def source_boosted_rrf(
    source_rankings: dict[str, list[str]],
    k: int = 60,
    single_source_boost: float = 1.5,  # å–®ä¾†æº top-10 çš„åŠ æˆ
    boost_rank_threshold: int = 10,     # åªæœ‰ top-N æ‰åŠ æˆ
) -> dict[str, float]:
    scores: dict[str, float] = {}
    uid_source_count: dict[str, int] = {}  # è¿½è¹¤æ¯å€‹ UID å‡ºç¾åœ¨å¹¾å€‹ä¾†æº

    # Pass 1: æ¨™æº– RRF
    for source, ranked_uids in source_rankings.items():
        for rank_0based, uid in enumerate(ranked_uids):
            rank = rank_0based + 1
            scores[uid] = scores.get(uid, 0.0) + 1.0 / (k + rank)
            uid_source_count[uid] = uid_source_count.get(uid, 0) + 1

    # Pass 2: å–®ä¾†æºé«˜æ’ååŠ æˆ
    for source, ranked_uids in source_rankings.items():
        for rank_0based, uid in enumerate(ranked_uids[:boost_rank_threshold]):
            if uid_source_count[uid] == 1:  # åƒ…å‡ºç¾åœ¨æ­¤ä¾†æº
                rank = rank_0based + 1
                original_contribution = 1.0 / (k + rank)
                scores[uid] += original_contribution * (single_source_boost - 1.0)

    return dict(sorted(scores.items(), key=lambda x: x[1], reverse=True))
```

```
å“²å­¸: ã€Œç¨å®¶é«˜æ’åã€å¯èƒ½æ˜¯è©²ä¾†æºçš„ç¨ç‰¹å„ªå‹¢ï¼ˆå¦‚ Europe PMC çš„å…¨æ–‡æœå°‹ï¼‰
å„ªé»: ä¸åŸ‹æ²’å¯èƒ½çš„ Preprint æˆ–å†·é–€é ˜åŸŸè«–æ–‡
ç¼ºé»: å¯èƒ½æ”¾å¤§å–®ä¸€ API çš„æ’åºåå·®
é©ç”¨: æ¢ç´¢æ€§æœå°‹ï¼ˆè¿½æ±‚è¦†è“‹é¢å’Œæ–°ç©æ€§ï¼‰
```

**æ–¹æ¡ˆ Cï¼šHybridï¼ˆæ ¹æ“š Insight é¡å‹å€åˆ†è™•ç†ï¼‰**

```
å“²å­¸: ä¸ä¿®æ”¹ RRF åˆ†æ•¸æœ¬èº«ï¼Œè€Œæ˜¯åœ¨ Insight åˆ†é¡éšæ®µå–®ç¨æ‰“æ’ˆ
åšæ³•:
  - RRF æ’åºä»ç”¨æ¨™æº–æ–¹æ¡ˆ A
  - ä½† source_specific_gems é¡åˆ¥å°ˆé–€æ”¶é›†ã€Œå–®ä¾†æº Top-10 ä½† RRF æ’ååå¾Œã€çš„æ–‡ç« 
  - ç­‰æ–¼åœ¨æœ€çµ‚è¼¸å‡ºä¸­çµ¦é€™äº›æ–‡ç« ä¸€å€‹ã€Œæ•—éƒ¨å¾©æ´»ã€çš„å±•ç¤ºæ©Ÿæœƒ
å„ªé»: RRF æ•¸å­¸æ€§è³ªä¸è¢«æ±¡æŸ“ï¼ŒåŒæ™‚ä¿ç•™ç¨å®¶ç™¼ç¾
ç¼ºé»: insights ä¸­çš„ source_gems å¯èƒ½ç´”ç²¹æ˜¯æŸ API çš„æ’åºé›œè¨Š
```

**å…·é«”æ•¸å€¼åˆ†æ**ï¼ˆä»¥ k=60, 5 å€‹ä¾†æºç‚ºä¾‹ï¼‰ï¼š

| å ´æ™¯ | ä¾†æºåˆ†å¸ƒ | Standard RRF | Boosted RRF (1.5x) | æ’å |
|------|---------|:------------:|:-------------------:|:----:|
| A: è·¨æºå…±è­˜ | OA:5, CR:8, EPMC:3, SS:12, PM:6 | 0.0736 | 0.0736 (ä¸è§¸ç™¼) | #1 |
| B: é›™æºå¼·æ¨ | OA:1, CR:2 | 0.0327 | 0.0327 (â‰¥2 æº) | #2 |
| C: ä¸‰æºä½æ’å | OA:50, CR:45, EPMC:55 | 0.0273 | 0.0273 (â‰¥2 æº) | #3 |
| D: å–®æº #1 | EPMC:1 | 0.0164 | **0.0246** (+50%) | #4â†’#3? |
| E: å–®æº #5 | SS:5 | 0.0154 | **0.0231** (+50%) | #5â†’#4? |
| F: å–®æº #50 | OA:50 | 0.0091 | 0.0091 (>10 ä½) | #6 |

**å¾…æ±ºäº‹é …**: æ–¹æ¡ˆ A/B/C çš„é¸æ“‡éœ€è¦åŸºæ–¼å¯¦éš›æœå°‹æ•¸æ“šé©—è­‰ã€‚å»ºè­°å…ˆå¯¦ä½œæ–¹æ¡ˆ A + Cï¼ˆæ¨™æº– RRF + å¾Œç½®æ‰“æ’ˆï¼‰ï¼Œè‹¥é©—è­‰é¡¯ç¤ºç¨å®¶ç™¼ç¾ç¢ºå¯¦æœ‰åƒ¹å€¼ï¼Œå†è€ƒæ…®æ–¹æ¡ˆ Bã€‚

> ğŸ“Œ **æ­¤è­°é¡Œå°‡åœ¨ Â§9.10 ä¸­æ·±å…¥è¨è«–ï¼Œæ˜¯ç³»çµ±è¨­è¨ˆçš„æ ¸å¿ƒå–æ¨ä¹‹ä¸€ã€‚**

#### 9.4.3 å“è³ªå†æ’åº (Quality Re-ranking) â€” Stage 3 (Optional)

**è¨­è¨ˆæ±ºç­–**: RRF èˆ‡ç¾æœ‰å…­ç¶­æ’åºæ˜¯**äº’è£œè€Œéæ›¿ä»£**ã€‚

```
å±¤æ¬¡ 1 (RRF):   è·¨ä¾†æºèåˆæ’åº â€” "åŒä¸€ç¯‡æ–‡ç« åœ¨ä¸åŒ API çš„æ’åå¦‚ä½•åˆä½µï¼Ÿ"
å±¤æ¬¡ 2 (å“è³ª):  å“è³ªç¶­åº¦æ’åº   â€” "æ–‡ç« æœ¬èº«çš„å“è³ª (RCRã€æ–‡ç« é¡å‹ã€æ™‚æ•ˆ) å¦‚ä½•æ¯”è¼ƒï¼Ÿ"
```

**å…©éšæ®µ Pipeline**:

```python
def fuse_and_rank(
    source_rankings: dict[str, list[str]],
    articles: dict[str, UnifiedArticle],
    alpha: float = 0.6,  # RRF æ¬Šé‡ (vs å“è³ª)
    ranking_config: RankingConfig | None = None,
) -> list[UnifiedDoc]:
    """å…©éšæ®µèåˆ + å“è³ªæ’åº

    Stage 2: RRF â†’ cross-source consensus score
    Stage 3: Quality â†’ article intrinsic quality score
    Blend:   final = Î±Â·rrf_normalized + (1-Î±)Â·quality_normalized
    """
    # Stage 2: RRF
    rrf_scores = reciprocal_rank_fusion(source_rankings)

    # Normalize RRF scores to [0, 1]
    max_rrf = max(rrf_scores.values()) if rrf_scores else 1.0
    rrf_normalized = {uid: s / max_rrf for uid, s in rrf_scores.items()}

    # Stage 3: Quality scoring (reuse existing ResultAggregator dimensions)
    # quality = f(recency, impact, article_type, source_trust, entity_match)
    # åªç”¨åŸå§‹å…­ç¶­ä¸­çš„ 5 å€‹ç¶­åº¦ï¼ˆæ’é™¤ relevanceï¼Œå› ç‚º RRF å·²å–ä»£ï¼‰
    quality_scores = calculate_quality_scores(rrf_scores.keys(), articles, ranking_config)

    # Blend
    blended = {}
    for uid in rrf_scores:
        rrf_n = rrf_normalized.get(uid, 0.0)
        qual_n = quality_scores.get(uid, 0.0)
        blended[uid] = alpha * rrf_n + (1 - alpha) * qual_n

    # Sort and assign final ranks
    sorted_uids = sorted(blended.keys(), key=lambda u: blended[u], reverse=True)
    results = []
    for rank, uid in enumerate(sorted_uids, 1):
        doc = UnifiedDoc(
            uid=uid,
            title=articles[uid].title,
            rrf_score=rrf_scores[uid],
            rrf_rank=rank,
            sources=get_sources(uid),
            source_count=count_sources(uid),
            metadata=articles[uid].to_dict(),
            quality_score=quality_scores.get(uid),
            blended_score=blended[uid],
        )
        results.append(doc)
    return results
```

**`alpha` çš„èªæ„**:
- `alpha=1.0` â€” ç´” RRFï¼ˆåªçœ‹è·¨ä¾†æºå…±è­˜ï¼‰
- `alpha=0.5` â€” å¹³è¡¡ï¼ˆRRF + å“è³ªå„åŠï¼‰
- `alpha=0.0` â€” ç´”å“è³ªæ’åºï¼ˆå¿½ç•¥ä¾†æºæ’åï¼Œå›æ­¸ç¾æœ‰è¡Œç‚ºï¼‰
- **é è¨­ `alpha=0.6`** â€” RRF ç•¥ç‚ºä¸»å°ï¼Œå“è³ªä½œç‚ºæ ¡æ­£

#### 9.4.4 å·®ç•°åˆ†æ (Differential Analysis) â€” Stage 4

**ç›®çš„**: è¨ˆç®—æœ¬æ¬¡æœå°‹ (Turn $t$) èˆ‡ä¸Šä¸€æ¬¡æœå°‹ (Turn $t-1$) çš„è®ŠåŒ–ã€‚

```python
from enum import Enum

class RankChangeType(Enum):
    NEW = "new"                # é¦–æ¬¡å‡ºç¾
    HIGH_RISER = "high_riser"  # æ’åå¤§å¹…æå‡
    STAGNANT = "stagnant"      # æ’åè®ŠåŒ–ä¸å¤§
    DROPPING = "dropping"      # æ’åä¸‹é™

@dataclass
class RankDelta:
    uid: str
    current_rank: int
    previous_rank: int | None  # None = NEW
    delta: int | None          # positive = improved
    change_type: RankChangeType

def differential_analysis(
    current_rank_map: dict[str, int],   # {uid: rank} from current RRF
    previous_rank_map: dict[str, int] | None,  # {uid: rank} from last turn
    config: FusionConfig,
) -> list[RankDelta]:
    """è¨ˆç®—æ’åå·®ç•°

    å° Current Top N çš„æ¯ä¸€ç¯‡æ–‡ä»¶ï¼š
    1. è‹¥ä¸åœ¨ previous â†’ NEW
    2. è‹¥å­˜åœ¨ä¸” rank_delta >= threshold â†’ HIGH_RISER
    3. è‹¥å­˜åœ¨ä¸” |rank_delta| < threshold â†’ STAGNANT
    4. è‹¥å­˜åœ¨ä¸” rank_delta < -threshold â†’ DROPPING
    """
    deltas = []
    for uid, current_rank in current_rank_map.items():
        if current_rank > config.top_n_display:
            continue  # åªåˆ†æ Top N

        if previous_rank_map is None or uid not in previous_rank_map:
            deltas.append(RankDelta(
                uid=uid,
                current_rank=current_rank,
                previous_rank=None,
                delta=None,
                change_type=RankChangeType.NEW,
            ))
        else:
            prev_rank = previous_rank_map[uid]
            delta = prev_rank - current_rank  # positive = improved
            if delta >= config.high_riser_threshold:
                change_type = RankChangeType.HIGH_RISER
            elif delta <= -config.high_riser_threshold:
                change_type = RankChangeType.DROPPING
            else:
                change_type = RankChangeType.STAGNANT
            deltas.append(RankDelta(
                uid=uid,
                current_rank=current_rank,
                previous_rank=prev_rank,
                delta=delta,
                change_type=change_type,
            ))
    return deltas
```

#### 9.4.5 Insight åˆ†é¡ (Insight Categorization) â€” Stage 5

```python
@dataclass
class FusionInsights:
    global_consensus_new: list[dict]    # å¤šä¾†æºæ¨è–¦ + æ–°ç™¼ç¾
    high_risers: list[dict]             # æ’åå¤§å¹…æå‡
    source_specific_gems: list[dict]    # å–®ä¾†æºç¨å®¶ç™¼ç¾

def categorize_insights(
    docs: list[UnifiedDoc],
    deltas: list[RankDelta],
    config: FusionConfig,
) -> FusionInsights:
    delta_map = {d.uid: d for d in deltas}

    consensus_new = []
    high_risers = []
    source_gems = []

    for doc in docs[:config.top_n_display]:
        delta = delta_map.get(doc.uid)
        if not delta:
            continue

        # Global Consensus: â‰¥2 sources + NEW + Top N
        if doc.source_count >= 2 and delta.change_type == RankChangeType.NEW:
            consensus_new.append({
                "uid": doc.uid,
                "title": doc.title,
                "rrf_rank": doc.rrf_rank,
                "found_in": doc.sources,
            })

        # High Riser: rank improved â‰¥ threshold
        if delta.change_type == RankChangeType.HIGH_RISER:
            high_risers.append({
                "uid": doc.uid,
                "title": doc.title,
                "rank_change": f"+{delta.delta} (Prev: {delta.previous_rank} â†’ Curr: {delta.current_rank})",
                "reason": "Relevance spiked for current query context",
            })

    # Source Gems: å–®ä¾†æº + åœ¨è©²ä¾†æº Top 10 (wider net than top_n_display)
    for doc in docs[:config.top_n_display * 2]:  # æƒææ›´å»£çš„ç¯„åœ
        if doc.source_count == 1:
            # è§£æè©²ä¾†æºä¸­çš„æ’å
            source_rank_str = doc.sources[0]  # e.g., "europepmc:3"
            source_name, rank_in_source = source_rank_str.rsplit(":", 1)
            if int(rank_in_source) <= 10:  # åœ¨ä¾†æºä¸­ Top 10
                source_gems.append({
                    "uid": doc.uid,
                    "title": doc.title,
                    "source": source_rank_str,
                    "rrf_rank": doc.rrf_rank,
                    "note": "Unique to this source â€” may be preprint or niche finding",
                })

    return FusionInsights(
        global_consensus_new=consensus_new,
        high_risers=high_risers,
        source_specific_gems=source_gems,
    )
```

### 9.5 Agent è¼¸å‡ºæ ¼å¼ (JSON Output Spec)

ç¶“éé«˜åº¦å£“ç¸®èˆ‡èªæ„åŒ–çš„æœ€çµ‚ Payloadï¼š

```json
{
  "meta": {
    "query": "current search query",
    "sources": ["openalex", "crossref", "europepmc", "semantic_scholar", "pubmed"],
    "total_fused": 150,
    "overlap_vs_last": 0.35,
    "overlap_vs_all": 0.72,
    "novelty_rate": 0.28,
    "warning": null
  },
  "insights": {
    "global_consensus_new": [
      {
        "description": "å¤šå€‹ä¾†æºä¸€è‡´æ¨è–¦çš„æ–°ç™¼ç¾",
        "items": [
          {
            "uid": "doi:10.1038/s41591-xxx",
            "title": "Large language models encode clinical knowledge",
            "rrf_rank": 1,
            "found_in": ["openalex:2", "europepmc:1", "semantic_scholar:5"]
          }
        ]
      }
    ],
    "high_risers": [
      {
        "description": "åœ¨ç•¶å‰é—œéµå­—ä¸‹æ’åé¡¯è‘—æå‡çš„èˆŠè«–æ–‡",
        "items": [
          {
            "uid": "doi:10.1145/3442188.xxx",
            "title": "On the Dangers of Stochastic Parrots",
            "rank_change": "+45 (Prev: 50 â†’ Curr: 5)",
            "reason": "Relevance spiked for current query context"
          }
        ]
      }
    ],
    "source_specific_gems": [
      {
        "description": "å–®ä¸€ä¾†æºç¨å®¶ç™¼ç¾çš„é«˜æ’åè«–æ–‡ï¼ˆå¯èƒ½æ˜¯ Preprint æˆ–å†·é–€é ˜åŸŸï¼‰",
        "items": [
          {
            "uid": "doi:10.1101/2024.01.xxx",
            "title": "Benchmarking Medical Hallucinations",
            "source": "europepmc:3",
            "rrf_rank": 28,
            "note": "Unique to this source â€” may be preprint or niche finding"
          }
        ]
      }
    ]
  }
}
```

**Overlap è¨ˆç®—é‚è¼¯**:

```python
def calculate_overlaps(
    current_uids: set[str],
    fusion_history: list[FusionTurn],
    config: FusionConfig,
) -> dict[str, float]:
    """è¨ˆç®—ä¸‰ç¨®é‡ç–ŠæŒ‡æ¨™"""
    result = {"overlap_vs_last": 0.0, "overlap_vs_all": 0.0, "novelty_rate": 1.0, "warning": None}

    if not fusion_history:
        return result  # Cold start: å…¨éƒ¨éƒ½æ˜¯æ–°çš„

    # vs Last Turn (Jaccard)
    last_uids = set(fusion_history[-1].rank_map.keys())
    if current_uids | last_uids:
        result["overlap_vs_last"] = len(current_uids & last_uids) / len(current_uids | last_uids)

    # vs All History (ç´¯ç©é‡ç–Šç‡)
    all_previous = set()
    for turn in fusion_history:
        all_previous.update(turn.rank_map.keys())
    if current_uids:
        overlap_count = len(current_uids & all_previous)
        result["overlap_vs_all"] = overlap_count / len(current_uids)
        result["novelty_rate"] = 1.0 - result["overlap_vs_all"]

    # Warning: æœå°‹ç­–ç•¥éæ–¼é‡è¤‡
    if result["overlap_vs_last"] > config.jaccard_warning_threshold:
        result["warning"] = (
            f"âš ï¸ èˆ‡ä¸Šæ¬¡æœå°‹çš„é‡ç–Šç‡ ({result['overlap_vs_last']:.0%}) è¶…éé–¾å€¼ "
            f"({config.jaccard_warning_threshold:.0%})ã€‚"
            f"å»ºè­°èª¿æ•´æœå°‹ç­–ç•¥ä»¥ç²å¾—æ›´å¤šæ–°çµæœã€‚"
        )

    return result
```

### 9.6 é…ç½®åƒæ•¸ (Configuration)

```python
@dataclass
class FusionConfig:
    """Fusion Engine é…ç½®"""
    # RRF
    rrf_k: int = 60                       # RRF å¹³æ»‘å¸¸æ•¸ã€‚å€¼è¶Šå°ï¼ŒTop 1 çš„å½±éŸ¿åŠ›è¶Šå¤§
    top_n_process: int = 100              # æ¯å€‹ API ä¾†æºåªå–å‰ N ç­†é€²å…¥èåˆæµç¨‹
    top_n_display: int = 20               # æœ€çµ‚å›å‚³çµ¦ Agent çš„åˆ—è¡¨é•·åº¦

    # Quality Re-ranking
    alpha: float = 0.6                    # RRF vs Quality çš„æ··åˆæ¯”ä¾‹ (1.0=ç´”RRF)
    enable_quality_reranking: bool = True # æ˜¯å¦å•Ÿç”¨ Stage 3

    # Differential Analysis
    high_riser_threshold: int = 15        # æ’åæå‡è¶…éæ­¤æ•¸å€¼æ‰è¢«è¦–ç‚º High Riser

    # Overlap Detection
    jaccard_warning_threshold: float = 0.85  # é‡ç–Šç‡è¶…éæ­¤å€¼æ™‚è­¦å‘Š Agent

    # Source Gems
    gem_source_rank_threshold: int = 10   # åœ¨ä¾†æºä¸­æ’å Top N æ‰è¦–ç‚º Gem

    @classmethod
    def default(cls) -> "FusionConfig":
        return cls()

    @classmethod
    def exploration_mode(cls) -> "FusionConfig":
        """æ¢ç´¢æ¨¡å¼ï¼šæ›´é‡è¦–å¤šæ¨£æ€§å’Œæ–°ç©æ€§"""
        return cls(
            alpha=0.4,            # é™ä½ RRF æ¬Šé‡ï¼Œå“è³ªæ›´é‡è¦
            top_n_display=30,     # é¡¯ç¤ºæ›´å¤šçµæœ
            high_riser_threshold=10,  # æ›´éˆæ•çš„ High Riser åµæ¸¬
            gem_source_rank_threshold=20,  # æ›´å¯¬çš„ Gem ç¯„åœ
        )

    @classmethod
    def precision_mode(cls) -> "FusionConfig":
        """ç²¾æº–æ¨¡å¼ï¼šæ›´é‡è¦–å…±è­˜å’Œå¯é æ€§"""
        return cls(
            alpha=0.8,            # RRF ä¸»å°ï¼Œå…±è­˜æœ€é‡è¦
            top_n_display=10,     # åªé¡¯ç¤ºæœ€å¯é çš„
            high_riser_threshold=20,  # æ›´é«˜çš„ High Riser é–€æª»
            gem_source_rank_threshold=5,  # æ›´åš´æ ¼çš„ Gem æ¢ä»¶
        )
```

### 9.7 é‚Šç·£æ¡ˆä¾‹è™•ç† (Edge Cases)

| # | å ´æ™¯ | è™•ç†ç­–ç•¥ |
|---|------|----------|
| 1 | **Cold Start** â€” é¦–æ¬¡æœå°‹ï¼ŒSession ç‚ºç©º | æ‰€æœ‰çµæœæ¨™è¨˜ç‚º `NEW`ï¼›çœç•¥ `high_risers`ï¼›Jaccard overlap = 0 |
| 2 | **API Failure** â€” æŸä¾†æº Timeout/Error | Log warning ä½†ç¹¼çºŒèåˆ (Degraded Mode)ã€‚RRF å¤©ç”Ÿæ”¯æ´ç¼ºæ¼è³‡æ–™ â€” å°‘ä¸€å€‹åŠ é …è€Œå·² |
| 3 | **No Results** â€” æ‰€æœ‰ API éƒ½å›å‚³ 0 ç­† | è¿”å› `{"meta": {"total_fused": 0}, "insights": null}`ï¼ŒAgent æ‡‰å˜—è©¦æ”¾å¯¬é—œéµå­— |
| 4 | **Single Source** â€” åªæœ‰ 1 å€‹ä¾†æºæœ‰çµæœ | RRF é€€åŒ–ç‚ºè©²ä¾†æºçš„åŸå§‹æ’åï¼›`source_specific_gems` ç„¡æ„ç¾©ï¼Œçœç•¥ |
| 5 | **Metadata Mismatch** â€” åŒç¯‡è«–æ–‡åœ¨ä¸åŒä¾†æºçš„ metadata ä¸ä¸€è‡´ | Union åˆä½µç­–ç•¥ï¼šä¿ç•™è³‡è¨Šé‡æœ€è±å¯Œçš„æ¬„ä½ã€‚å¹´ä»½å–æœ€æ—©ä¸ç‚ºç©ºçš„å€¼ |
| 6 | **å¾ˆçŸ­çš„æ’ååˆ—è¡¨** â€” æŸä¾†æºåªè¿”å› 5 ç¯‡ | æ­£å¸¸è™•ç†ï¼Œé€™äº›æ–‡ç« åœ¨è©²ä¾†æºçš„æ’åå°±æ˜¯ 1-5 |
| 7 | **å®Œå…¨é‡ç–Š** â€” æ‰€æœ‰ä¾†æºè¿”å›å®Œå…¨ç›¸åŒçš„æ–‡ç«  | overlap = 1.0ï¼Œè§¸ç™¼ warningï¼›æ‰€æœ‰æ–‡ç« çš„ source_count éƒ½å¾ˆé«˜ï¼Œconsensus å¾ˆå¼· |

### 9.8 DDD åˆ†å±¤è¨­è¨ˆ (Architecture Placement)

```
src/pubmed_search/
â”œâ”€â”€ domain/entities/
â”‚   â””â”€â”€ fusion.py                     # FusionConfig, UnifiedDoc, FusionTurn,
â”‚                                     # RankDelta, RankChangeType, FusionInsights
â”‚                                     # (Pure data structures, no logic)
â”‚
â”œâ”€â”€ application/
â”‚   â””â”€â”€ fusion/                       # â† æ–°æ¨¡çµ„
â”‚       â”œâ”€â”€ __init__.py               # Public API: FusionEngine
â”‚       â”œâ”€â”€ rrf_engine.py             # reciprocal_rank_fusion()
â”‚       â”‚                             # source_boosted_rrf() (if adopted)
â”‚       â”‚                             # fuse_and_rank() â€” Stage 2+3
â”‚       â”œâ”€â”€ diff_engine.py            # differential_analysis() â€” Stage 4
â”‚       â”‚                             # calculate_overlaps()
â”‚       â””â”€â”€ insight_categorizer.py    # categorize_insights() â€” Stage 5
â”‚                                     # format_agent_summary()
â”‚
â”œâ”€â”€ application/session/
â”‚   â””â”€â”€ manager.py                    # ä¿®æ”¹ï¼šResearchSession æ–°å¢ fusion_history
â”‚                                     # SessionManager æ–°å¢ update_fusion_state()
â”‚
â””â”€â”€ presentation/mcp_server/tools/
    â””â”€â”€ unified.py                    # ä¿®æ”¹ï¼šåœ¨ unified_search ä¸­æ•´åˆ Fusion Pipeline
                                      # result_aggregator â†’ fusion_engine â†’ session_update
```

**ä¾è³´æ–¹å‘** (DDD åš´æ ¼åˆ†å±¤):

```
presentation â†’ application â†’ domain
     â†“              â†“           â†“
  unified.py    fusion/     fusion.py
  (MCP tool)    rrf_engine  (entities)
                diff_engine
                insight_cat
```

`application/fusion/` ä¸ä¾è³´ `presentation/`ï¼Œä¸ä¾è³´ `infrastructure/`ã€‚
æ‰€æœ‰å¤–éƒ¨ API å‘¼å«å·²åœ¨ unified.py å®Œæˆï¼Œfusion æ¨¡çµ„åªè™•ç†**å…§éƒ¨è³‡æ–™**ã€‚

### 9.9 èˆ‡ç¾æœ‰ç³»çµ±çš„æ•´åˆç­–ç•¥

#### 9.9.1 ResultAggregator çš„è§’è‰²è½‰è®Š

```
ç¾ç‹€: ResultAggregator = å»é‡ + å…­ç¶­æ’åº (å…¨åŒ…)
ç›®æ¨™: ResultAggregator = Stage 1 (å»é‡)
      FusionEngine     = Stage 2-5 (RRF + å“è³ª + Diff + Insights)
```

**ä¸ç ´å£ç¾æœ‰ API**: `ResultAggregator.aggregate()` ä»ç„¶å¯ç”¨ï¼Œä½† `unified_search` åœ¨å…¶å¾Œæ’å…¥ Fusion Pipelineï¼š

```python
# unified.py (ä¿®æ”¹å¾Œ)
async def unified_search(query: str, ...):
    # 1. ä¸¦è¡Œæœå°‹ (ç¾æœ‰)
    raw_results = await asyncio.gather(
        openalex.search(query),
        crossref.search(query),
        europepmc.search(query),
        ...
    )

    # 2. å»é‡ (ç¾æœ‰ ResultAggregator)
    aggregated = result_aggregator.aggregate(raw_results)

    # 3. â† æ–°å¢ï¼šFusion Pipeline
    fusion_engine = FusionEngine(config=FusionConfig.default())
    fused_results, insights = fusion_engine.fuse(
        source_rankings=extract_rankings(raw_results),
        articles=aggregated.articles,
        session=session_manager.get_current_session(),
    )

    # 4. æ›´æ–° Session fusion_history
    session_manager.update_fusion_state(query, fused_results)

    # 5. æ ¼å¼åŒ–è¼¸å‡º (åœ¨ç¾æœ‰ Markdown è¼¸å‡ºä¸­é™„åŠ  insights)
    return format_output(fused_results, insights)
```

#### 9.9.2 å°ç¾æœ‰ MCP å·¥å…·çš„å½±éŸ¿

| å·¥å…· | å½±éŸ¿ | èªªæ˜ |
|------|------|------|
| `unified_search` | **ä¸»è¦ä¿®æ”¹** | æ•´åˆ Fusion Pipeline |
| `get_session_summary` | è¼•å¾®ä¿®æ”¹ | å¢åŠ  fusion_history æ‘˜è¦ |
| `get_session_pmids` | ç„¡è®ŠåŒ– | PMID å„²å­˜ä¸å—å½±éŸ¿ |
| å…¶ä»–æ‰€æœ‰å·¥å…· | ç„¡è®ŠåŒ– | Fusion åªå½±éŸ¿æœå°‹è·¯å¾‘ |

### 9.10 RRF æœªå‡ºç¾ä¾†æºç­–ç•¥ï¼šæ·±å…¥åˆ†æ (Open Discussion)

> **é€™æ˜¯æ•´å€‹è¨­è¨ˆä¸­æœ€é—œéµçš„å–æ¨æ±ºç­–ï¼Œå€¼å¾—ç¨ç«‹å±•é–‹ã€‚**

#### 9.10.1 å•é¡Œæœ¬è³ª

RRF çš„æ•¸å­¸ç‰¹æ€§ä½¿å¾—**å¤šä¾†æºä½æ’å > å–®ä¾†æºé«˜æ’å**ã€‚é€™æ˜¯ feature é‚„æ˜¯ bugï¼Ÿ

```
å ´æ™¯åŒ–æ€è€ƒï¼š

å‡è¨­æœå°‹ "remimazolam pharmacokinetics elderly"

æ–‡ç«  X: åªå‡ºç¾åœ¨ Europe PMC Rank #3
  â”œâ”€â”€ å¯èƒ½åŸå›  A: Europe PMC å…¨æ–‡æœå°‹èƒ½åŠ›å¼·ï¼Œæ‰¾åˆ°å…¶ä»–ä¾†æºç´¢å¼•ä¸åˆ°çš„æ–‡ç» â†’ æœ‰åƒ¹å€¼
  â”œâ”€â”€ å¯èƒ½åŸå›  B: Europe PMC çš„ relevance æ’åºéŒ¯èª¤ï¼Œå…¶ä»–ä¾†æºæ­£ç¢ºåœ°æ²’æ¨è–¦å®ƒ â†’ å™ªéŸ³
  â””â”€â”€ å¯èƒ½åŸå›  C: è©²æ–‡ç« å¤ªæ–°ï¼ˆpreprintï¼‰ï¼Œå°šæœªè¢«å…¶ä»–ä¾†æºç´¢å¼• â†’ æœ‰åƒ¹å€¼ä½†éœ€æ¨™è¨»

æ–‡ç«  Y: å‡ºç¾åœ¨ OpenAlex #40, CrossRef #35, Semantic Scholar #50
  â”œâ”€â”€ ä¸‰å€‹ç¨ç«‹ä¾†æºéƒ½èªç‚ºå®ƒæœ‰ä¸€å®šç›¸é—œæ€§ï¼ˆé›–ç„¶æ’åä¸é«˜ï¼‰â†’ å¯ä¿¡çš„ä¸­ç­‰ç›¸é—œ
  â””â”€â”€ ä½†æ’å 35-50 åœ¨æ¯å€‹ä¾†æºä¸­å¯èƒ½å·²ç¶“æ˜¯ "noise range" â†’ å¯èƒ½åªæ˜¯å·§åˆ
```

#### 9.10.2 ä¸‰æ–¹æ¡ˆæ¯”è¼ƒçŸ©é™£

| ç¶­åº¦ | A: Standard RRF | B: Source-Boosted | C: Hybrid (A + å¾Œç½®æ‰“æ’ˆ) |
|------|:---:|:---:|:---:|
| æ•¸å­¸ç´”ç²¹æ€§ | âœ… æ¨™æº– | âŒ å¼•å…¥å•Ÿç™¼å¼ | âœ… RRF ä¸å—æ±¡æŸ“ |
| å…±è­˜å¯é åº¦ | âœ… æœ€ä½³ | âš ï¸ å¯èƒ½è¢«å–®æºåå·®æ”¾å¤§ | âœ… ä¸»æ’åå¯é  |
| ç¨å®¶ç™¼ç¾èƒ½åŠ› | âŒ å¯èƒ½åŸ‹æ²’ | âœ… æœ‰è£œå„Ÿ | âœ… åœ¨ gems ä¸­å±•ç¤º |
| å¯¦ä½œè¤‡é›œåº¦ | â­ æœ€ä½ | â­â­ éœ€è¦é¡å¤– pass | â­â­ éœ€è¦åˆ†é¡é‚è¼¯ |
| å¯è§£é‡‹æ€§ | âœ… ã€Œå¤šä¾†æºå…±è­˜ã€ | âš ï¸ ã€Œç‚ºä»€éº¼é€™ç¯‡è¢« boostï¼Ÿã€ | âœ… ã€Œä¸»æ’å + ç¨å®¶æ¨è–¦ã€ |
| åƒæ•¸æ•æ„Ÿæ€§ | åªæœ‰ k | k + boost + threshold | k + gem_threshold |
| é©åˆå ´æ™¯ | ä¸€èˆ¬æœå°‹ | æ¢ç´¢æ€§æœå°‹ | **é€šç”¨** |

#### 9.10.3 å„æ–¹æ¡ˆå° Agent è¡Œç‚ºçš„å½±éŸ¿

```
æ–¹æ¡ˆ A çš„ Agent é«”é©—:
  Agent: "ä»¥ä¸‹æ˜¯å¤šå€‹å­¸è¡“ä¾†æºå…±åŒæ¨è–¦çš„è«–æ–‡..."
  â†’ Agent åªå±•ç¤ºé«˜å…±è­˜æ–‡ç« ï¼Œè¡Œç‚ºä¿å®ˆ
  â†’ é¢¨éšª: ç¨å®¶ preprint æˆ–å†·é–€ç™¼ç¾å¯èƒ½æ°¸é ä¸è¢«å±•ç¤º

æ–¹æ¡ˆ B çš„ Agent é«”é©—:
  Agent: "ä»¥ä¸‹è«–æ–‡ä¸­ï¼Œ#1-#15 ç‚ºå¤šä¾†æºå…±è­˜ï¼Œ#16-#20 ç‚ºç‰¹å®šä¾†æºå¼·çƒˆæ¨è–¦..."
  â†’ Agent éœ€è¦è§£é‡‹ç‚ºä»€éº¼æŸäº›æ–‡ç« æ’åè¢«äººç‚ºæå‡
  â†’ é¢¨éšª: boost å°è‡´ä¸€äº›ã€ŒAPI æ’åº bugã€çš„æ–‡ç« è«åå‡ºç¾åœ¨é«˜ä½

æ–¹æ¡ˆ C çš„ Agent é«”é©—:
  Agent: "ä»¥ä¸‹æ˜¯ä¸»è¦æ¨è–¦è«–æ–‡(æ’ååŸºæ–¼è·¨ä¾†æºå…±è­˜)..."
  Agent: "æ­¤å¤–ï¼Œä»¥ä¸‹è«–æ–‡åƒ…åœ¨ç‰¹å®šä¾†æºè¢«é«˜åº¦æ¨è–¦ï¼Œå¯èƒ½å€¼å¾—é¡å¤–é—œæ³¨ï¼š..."
  â†’ æœ€è‡ªç„¶çš„å±•ç¤ºæ–¹å¼ â€” ä¸»çµæœ + è£œå……æ¨è–¦
  â†’ é¢¨éšª: gems å€å¡Šå¯èƒ½è¢« Agent å¿½ç•¥æˆ–é¸æ“‡æ€§å±•ç¤º
```

#### 9.10.4 å»ºè­°èˆ‡å¾…é©—è­‰å‡è¨­

**åˆæ­¥å»ºè­°**: æ–¹æ¡ˆ C (Hybrid) ä½œç‚ºé è¨­

**ç†ç”±**:
1. RRF æ•¸å­¸æ€§è³ªæ˜¯å…¶æ ¸å¿ƒåƒ¹å€¼ï¼Œä¸æ‡‰è©²è¢«å•Ÿç™¼å¼ä¿®æ”¹
2. `source_specific_gems` ä½œç‚ºç¨ç«‹ insight é¡åˆ¥å·²ç¶“è¦†è“‹äº†ã€Œç¨å®¶ç™¼ç¾ã€çš„å±•ç¤ºéœ€æ±‚
3. Agent å¯ä»¥è‡ªä¸»æ±ºå®šæ˜¯å¦å±•ç¤º gemsï¼ˆè€Œéè¢«å¼·åˆ¶å°‡ boosted æ–‡ç« æ··å…¥ä¸»æ’åï¼‰
4. è‹¥æœªä¾†æ•¸æ“šé¡¯ç¤º gems ä¸­æœ‰é«˜åƒ¹å€¼æ–‡ç« é•·æœŸè¢« RRF ä½ä¼°ï¼Œå¯ä»¥å‡ç´šåˆ°æ–¹æ¡ˆ B

**å¾…é©—è­‰å‡è¨­** (éœ€è¦ç”¨å¯¦éš›æœå°‹æ•¸æ“š):

| å‡è¨­ | é©—è­‰æ–¹æ³• | è‹¥å‡è¨­æˆç«‹ | è‹¥å‡è¨­ä¸æˆç«‹ |
|------|---------|-----------|-------------|
| å‡è¨­ | é©—è­‰æ–¹æ³• | è‹¥å‡è¨­æˆç«‹ | è‹¥å‡è¨­ä¸æˆç«‹ |
|------|---------|-----------|-------------|
| H1: å–®ä¾†æº Top-10 ä¸­æœ‰ â‰¥20% æ˜¯å…¶ä»–ä¾†æºå®Œå…¨æ²’æœ‰çš„ | çµ±è¨ˆ 5 å€‹ä¸»é¡Œçš„ä¾†æºåˆ†å¸ƒ | Source Gems æœ‰æ„ç¾© | Source Gems å¯èƒ½æ˜¯ç©ºé›†åˆï¼Œç„¡éœ€ç‰¹æ®Šè™•ç† |
| H2: é€™äº›ç¨å®¶æ–‡ç« ä¸­æœ‰ â‰¥50% ç¢ºå¯¦èˆ‡æŸ¥è©¢é«˜åº¦ç›¸é—œ | äººå·¥è©•å¯© | æ–¹æ¡ˆ C è¶³å¤ ä¸”æ­£ç¢º | éœ€è¦æ›´åš´æ ¼çš„ gem ç¯©é¸æˆ–æ”¾æ£„ |
| H3: ç¨å®¶æ–‡ç« ä¸»è¦å‡ºç¾åœ¨ Europe PMCï¼ˆå…¨æ–‡æœå°‹ï¼‰å’Œé å°æœ¬ä¾†æº | ä¾†æºæ­¸å› åˆ†æ | å¯ä»¥æŒ‰ä¾†æºè¨­å®šä¸åŒçš„ gem ä¿¡ä»»åº¦ | Gems ä¾†æºåˆ†å¸ƒå‡å‹»ï¼Œç„¡æ³•å·®ç•°åŒ–è™•ç† |
| H4: Boosted RRF (æ–¹æ¡ˆ B) æ¯”æ¨™æº– RRF åœ¨ nDCG@10 ä¸Šæœ‰æå‡ | TREC PM è©•æ¸¬ | å‡ç´šåˆ°æ–¹æ¡ˆ B | ä¿æŒæ–¹æ¡ˆ C |

#### 9.10.5 å¯¦é©—é©—è­‰çµè«– (2026-02-15 å¯¦é©—æ•¸æ“š)

> ä»¥ä¸‹çµè«–åŸºæ–¼ Â§9.14 å®Œæ•´å¯¦é©—å ±å‘Šçš„æ•¸æ“šã€‚

**H1 é©—è­‰çµæœï¼šâœ… å…¨éƒ¨ 6 å€‹ä¾†æºçš† >20% ç¨å®¶**

| ä¾†æº | ç¨å®¶ç‡ | çµè«– |
|------|:------:|------|
| PubMed | 61.7% | Source Gems **æœ‰æ„ç¾©** â€” æ¯å€‹ä¾†æºéƒ½æœ‰å¤§é‡ç¨å®¶æ–‡ç«  |
| Semantic Scholar | 51.3% | |
| OpenAlex | 54.6% | |
| Europe PMC | 87.9% | |
| CORE | 93.8% | |
| CrossRef | 80.7% | |

ä½†æ³¨æ„ï¼š**ç¨å®¶ç‡éé«˜æœ¬èº«å°±æ˜¯å•é¡Œ**ï¼ˆè¦‹ Â§9.14.4 è¨­è¨ˆæ”¹é€²å»ºè­° #5ï¼‰ã€‚

**H3 é©—è­‰çµæœï¼šâš ï¸ éƒ¨åˆ†æˆç«‹**

ç¨å®¶æ–‡ç« åˆ†å¸ƒ**ç›¸å°å‡å‹»**ï¼ŒEurope PMC (21.3%) å’Œ CORE (19.3%) ä½”æ¯”æœ€é«˜ä½†æœªå½¢æˆå£“å€’æ€§å„ªå‹¢ã€‚CrossRef (18.2%) ä¹Ÿè²¢ç»äº†å¤§é‡ã€Œç¨å®¶ã€ï¼Œä½†å…¶æ’åºå“è³ªä½ï¼ˆå…ƒè³‡æ–™æœå°‹è€Œéå­¸è¡“æ’åºï¼‰ï¼Œé€™äº›ç¨å®¶æ›´å¯èƒ½æ˜¯å™ªéŸ³ã€‚

**â†’ æ±ºç­–ï¼šæ¡ç”¨æ–¹æ¡ˆ C (Hybrid) + ä»¥ä¸‹æ”¹é€²**

1. **Gems éœ€è¦å“è³ªé–€æª»**ï¼ˆéã€Œç¨å®¶å³ Gemã€ï¼‰
2. **CrossRef é™ç´šç‚ºå…ƒè³‡æ–™è£œå……**ï¼Œä¸åƒèˆ‡ RRF ä¸»æ’åº
3. **Topic-Adaptive Alpha** å–ä»£éœæ…‹ alphaï¼ˆè¦‹ Â§9.14.4 #2ï¼‰

**H2 èˆ‡ H4 ç‹€æ…‹ï¼š** éœ€è¦ ground truth æ¨™è¨»å’Œ TREC PM è©•æ¸¬ï¼Œæœ¬æ¬¡å¯¦é©—ç„¡æ³•é©—è­‰ã€‚

### 9.11 èˆ‡å…¶ä»–ç ”ç©¶æ–‡ä»¶æ¼”ç®—æ³•çš„éŠœæ¥

æœ¬ Spec å»ºç«‹çš„åŸºç¤è¨­æ–½å¯ç›´æ¥éŠœæ¥ Â§2 å’Œ Â§4 ä¸­çš„å…¶ä»–æ¼”ç®—æ³•ï¼š

```
æœ¬ Spec (Phase 1)          Phase 2                    Phase 3
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€         â”€â”€â”€â”€â”€â”€â”€                    â”€â”€â”€â”€â”€â”€â”€

FusionTurn.rank_map  â”€â”€â”€â†’  Smart Top-K (MMR)   â”€â”€â”€â†’  Result Digest
(æ¯è¼ªçš„æ’åå¿«ç…§)           Â§2.3 è§£æ³• 3                Â§2.3 è§£æ³• 1
                           ç”¨ MeSH Jaccard åš          MeSH åˆ†ç¾¤ +
                           å¤šæ¨£æ€§é¸å–                   ä»£è¡¨ä½œé¸å–

FusionTurn.rrf_scores â”€â”€â†’  BM25 æ•´åˆ            â”€â”€â”€â†’  Learning-to-Rank
(å¯ä½œç‚º relevance çš„       Â§4.1 Stage 1               Â§4.3 ç”¨ rrf_score
 ä¸€å€‹ç‰¹å¾µ)                æ›¿ä»£ term overlap            ä½œç‚ºä¸€å€‹ç‰¹å¾µ

calculate_overlaps() â”€â”€â”€â†’  Coverage Tracker
(overlap_vs_all)           Â§2.3 è§£æ³• 4
                           æ“´å±•ç‚º MeSH å­æ¨¹è¦†è“‹ç‡

source_specific_gems â”€â”€â”€â†’  Preprint Monitor
(ç¨å®¶ä¾†æºè¿½è¹¤)             è¿½è¹¤ç‰¹å®šä¾†æºçš„æ–°ç™¼ç¾
```

### 9.12 å¯¦ä½œä¼°ç®—

| æª”æ¡ˆ | é ä¼°è¡Œæ•¸ | é›£åº¦ | ä¾è³´ |
|------|:--------:|:----:|------|
| `domain/entities/fusion.py` | ~80 | ä½ | ç„¡ |
| `application/fusion/__init__.py` | ~20 | ä½ | ç„¡ |
| `application/fusion/rrf_engine.py` | ~120 | ä½ | ç„¡ï¼ˆç´”è¨ˆç®—ï¼‰ |
| `application/fusion/diff_engine.py` | ~100 | ä½ | ç„¡ï¼ˆç´”è¨ˆç®—ï¼‰ |
| `application/fusion/insight_categorizer.py` | ~80 | ä½ | ç„¡ |
| `application/session/manager.py` (ä¿®æ”¹) | ~30 | ä½ | ç¾æœ‰ Session |
| `presentation/mcp_server/tools/unified.py` (ä¿®æ”¹) | ~50 | ä¸­ | ä¸Šè¿°å…¨éƒ¨ |
| **æ¸¬è©¦** | ~400 | ä¸­ | pytest |
| **åˆè¨ˆ** | **~880** | | |

**é ä¼°å·¥æ™‚**: 2-3 å¤©ï¼ˆå«æ¸¬è©¦ï¼‰

**é›¶å¤–éƒ¨ä¾è³´**: æ­¤æ¨¡çµ„å®Œå…¨ç”±ç´” Python å¯¦ä½œï¼Œä¸éœ€è¦ä»»ä½•æ–°çš„ç¬¬ä¸‰æ–¹å¥—ä»¶ã€‚

### 9.13 é©—è­‰è¨ˆç•«

| é©—è­‰é …ç›® | æ–¹æ³• | æˆåŠŸæ¨™æº– |
|---------|------|----------|
| RRF æ­£ç¢ºæ€§ | æ‰‹å‹•æ§‹é€  3 çµ„æ’ååˆ—è¡¨ï¼Œé©—ç®— RRF åˆ†æ•¸ | åˆ†æ•¸èˆ‡æ‰‹ç®—ä¸€è‡´ |
| å»é‡ä¸€è‡´æ€§ | ç¢ºèª UID ç­–ç•¥èˆ‡ç¾æœ‰ Union-Find çš„çµæœç›¸å®¹ | 0 è¡çª |
| Diff é‚è¼¯ | æ¨¡æ“¬ 3 è¼ªæœå°‹ï¼Œé©—è­‰ NEW/HIGH_RISER åˆ†é¡ | åˆ†é¡ç¬¦åˆé æœŸ |
| Overlap è¨ˆç®— | Cold start + å¤šè¼ªæœå°‹çš„ Jaccard | æ•¸å€¼æ­£ç¢º |
| æ•ˆèƒ½ | 500 ç¯‡æ–‡ç« çš„èåˆæ™‚é–“ | < 50ms |
| æ•´åˆæ¸¬è©¦ | ç«¯åˆ°ç«¯ unified_search â†’ insights JSON | JSON schema åˆè¦ |

### 9.14 RRF Source Behavior å¯¦é©—å ±å‘Š

> **å¯¦é©—æ—¥æœŸ**: 2026-02-15  
> **å¯¦é©—è…³æœ¬**: `scripts/rrf_source_experiment.py`  
> **åŸå§‹æ•¸æ“š**: `scripts/_tmp/rrf_experiment_data.json`  
> **V2 å ±å‘Š**: `scripts/_tmp/rrf_experiment_report_v2.md`  
> **æ–‡ä»¶ç‰ˆæœ¬**: v1.4

#### 9.14.1 å¯¦é©—ç›®çš„

é©—è­‰ Â§9.10.4 æå‡ºçš„å››å€‹å‡è¨­ (H1-H4)ï¼Œä¸¦ç‚ºä»¥ä¸‹è¨­è¨ˆæ±ºç­–æä¾›æ•¸æ“šåŸºç¤ï¼š

1. RRF æ¬Šé‡ç­–ç•¥ï¼šStandard (A) vs Source-Boosted (B) vs Hybrid (C)
2. Source-Weighted RRF çš„ä¾†æºæ¬Šé‡æ ¡æº–
3. `source_specific_gems` æ˜¯å¦æ‡‰è©²ä¿ç•™
4. CrossRef å’Œ CORE åœ¨èåˆç®¡ç·šä¸­çš„è§’è‰²

#### 9.14.2 å¯¦é©—æ–¹æ³•

**æ¸¬è©¦ä¸»é¡Œ** (5 å€‹ï¼Œè¦†è“‹ä¸åŒé ˜åŸŸå’Œç‰¹å¾µ):

| ID | Query | ç‰¹å¾µ |
|----|-------|------|
| T1 | `machine learning diagnosis cancer` | å¯¬é ˜åŸŸã€é«˜é‡ |
| T2 | `remimazolam sedation ICU` | çª„é ˜åŸŸã€åˆ©åŸº |
| T3 | `CRISPR gene therapy sickle cell` | å°–ç«¯éºå‚³å­¸ |
| T4 | `COVID-19 long COVID neurological` | å¿«é€Ÿå‡ºç‰ˆé€±æœŸ |
| T5 | `gut microbiome obesity metabolic syndrome` | è·¨å­¸ç§‘ |

**æ¸¬è©¦ä¾†æº** (6 å€‹): PubMed, Semantic Scholar, OpenAlex, Europe PMC, CORE, CrossRef

**æ¯å€‹ä¾†æºå– Top 30 çµæœ**ï¼Œæ”¶é›†ï¼š
- æ–‡ç« æ¨™è­˜ç¬¦ (DOI, PMID, æ¨™é¡Œ)
- å…ƒè³‡æ–™å®Œæ•´åº¦ (Abstract, Citation Count)
- è·¨ä¾†æºé‡ç–Šç‡ (Jaccard Similarity)
- ç¨å®¶æ–‡ç« çµ±è¨ˆ

**UID Matching ç­–ç•¥**: Union-Find è·¨æ¬„ä½åŒ¹é…ï¼Œä»»æ„å…±äº« DOI/PMID/æ¨™æº–åŒ–æ¨™é¡Œå³åˆä½µ â€” èˆ‡ç”¢å“ç¢¼ `ResultAggregator` è¡Œç‚ºä¸€è‡´ã€‚

**å¯¦é©—ä¿®æ­£è¨˜éŒ„** (V1â†’V2):

| ä¿®æ­£ | V1 å•é¡Œ | V2 ä¿®æ­£ |
|------|---------|---------|
| EPMC Abstract | `result_type="lite"` ä¸å« abstract â†’ 0% | æ”¹ç”¨ `result_type="core"` â†’ 88% |
| CORE 301 Redirect | `BaseAPIClient` ä¸è·Ÿéš¨ redirect â†’ 0 çµæœ | åŠ å…¥ `follow_redirects=True` â†’ avg 25.2 çµæœ |
| UID Matching | ç°¡å–® `DOI>PMID>title` å–®ä¸€ fallback | Union-Find ä¸‰æ¬„ä½äº¤å‰åŒ¹é… |
| S2 Rate Limit | T3 ä¸‰æ¬¡ 429 å¾Œæ”¾æ£„ â†’ 0 çµæœ | ç¬¬ä¸‰æ¬¡ retry é–“éš”å¢åŠ  â†’ 30 çµæœ |

#### 9.14.3 å¯¦é©—çµæœ

##### A. ä¾†æºèƒ½åŠ›çŸ©é™£

| Source | Avg Count | DOI Rate | PMID Rate | Abstract Rate | Avg Latency | Role |
|--------|:---------:|:--------:|:---------:|:-------------:|:-----------:|------|
| PubMed | 30.0 | 99% | 100% | 95% | 9.7s | ğŸ¥‡ Gold Standard |
| Semantic Scholar | 30.0 | 99% | 75% | 77% | 4.8s | ğŸ¥ˆ SPECTER æ’åº |
| OpenAlex | 30.0 | 99% | 80% | 69% | 1.7s | ğŸ¥ˆ å¿«é€Ÿ+é«˜è¦†è“‹ |
| Europe PMC | 30.0 | 93% | 89% | 88% | 2.4s | å…¨æ–‡æœå°‹ |
| CORE | 25.2 | 67% | 15% | 92% | 1.7s | é–‹æ”¾å–ç”¨+é å°æœ¬ |
| CrossRef | 30.0 | 100% | 0% | 24% | 1.7s | âš ï¸ å…ƒè³‡æ–™æœå°‹ |

**é—œéµç™¼ç¾ï¼š**
- **PubMed** åœ¨æ‰€æœ‰æŒ‡æ¨™ä¸Šéƒ½æ˜¯æœ€å®Œæ•´çš„ï¼ˆ99% DOI, 100% PMID, 95% Abstractï¼‰
- **CORE** ç¾åœ¨èƒ½æ­£å¸¸å·¥ä½œï¼ˆV1 ä¿®æ­£ `follow_redirects` å¾Œï¼‰ï¼Œä½† DOI è¦†è“‹åªæœ‰ 67%ï¼ŒPMID 15%
- **CrossRef** DOI 100% ä½† PMID 0%ï¼ŒAbstract åªæœ‰ 24% â€” ç¢ºèªå…¶æœ¬è³ªæ˜¯å…ƒè³‡æ–™è¨»å†Šä¸­å¿ƒ
- **Europe PMC** æ”¹ç”¨ `result_type="core"` å¾Œ Abstract Rate å¾ 0% å‡è‡³ 88%

##### B. è·¨ä¾†æºé‡ç–ŠçŸ©é™£ (Avg Jaccard)

```
              PubMed   S2      OA      EPMC    CORE    CR
PubMed        1.000    0.171   0.194   0.023   0.010   0.049
S2            0.171    1.000   0.189   0.063   0.007   0.091
OpenAlex      0.194    0.189   1.000   0.015   0.014   0.073
Europe PMC    0.023    0.063   0.015   1.000   0.007   0.007
CORE          0.010    0.007   0.014   0.007   1.000   0.003
CrossRef      0.049    0.091   0.073   0.007   0.003   1.000
```

**å¹³å‡è·¨ä¾†æº Jaccard: 0.061** â€” æ¥µä½é‡ç–Šï¼Œå„ä¾†æºé«˜åº¦äº’è£œã€‚

**ä¾†æºèšé¡åˆ†æï¼š**
- **èšé¡ 1 (å­¸è¡“æœå°‹å¼•æ“)**: PubMed â†” S2 (0.171) â†” OpenAlex (0.194) â€” ç›¸äº’é‡ç–Šæœ€é«˜
- **èšé¡ 2 (ç¨ç«‹æ–‡ç»åº«)**: Europe PMC, CORE â€” èˆ‡æ‰€æœ‰ä¾†æºé‡ç–Šæ¥µä½
- **èšé¡ 3 (å…ƒè³‡æ–™)**: CrossRef â€” èˆ‡ S2 (0.091) å’Œ OA (0.073) æœ‰äº›é‡ç–Š

##### C. ç¨å®¶æ–‡ç« çµ±è¨ˆ

| ä¾†æº | ç¨å®¶ç‡ | ç¨å®¶æ•¸ (avg) | ä½”ç¸½ç¨å®¶% |
|------|:------:|:-----------:|:---------:|
| CORE | 93.8% | 23.4 | 19.3% |
| Europe PMC | 87.9% | 25.8 | 21.3% |
| CrossRef | 80.7% | 22.0 | 18.2% |
| PubMed | 61.7% | 18.4 | 15.2% |
| OpenAlex | 54.6% | 16.0 | 13.2% |
| Semantic Scholar | 51.3% | 15.4 | 12.7% |

**ç¸½ç¨å®¶æ–‡ç« æ•¸ (avg/topic)**: ~121 / 175 total = **69.1% ç¨å®¶ç‡**

##### D. çª„é ˜åŸŸ vs å¯¬é ˜åŸŸå·®ç•°

| æŒ‡æ¨™ | T2 (çª„: remimazolam) | T1 (å¯¬: ML cancer) | å€ç‡ |
|------|:---:|:---:|:---:|
| PubMed-S2 Jaccard | **0.481** | 0.053 | 9.1x |
| PubMed-OA Jaccard | **0.379** | 0.081 | 4.7x |
| PubMed ç¨å®¶ç‡ | **14%** | 87% | 0.16x |
| S2 ç¨å®¶ç‡ | **13%** | 90% | 0.14x |

**æ ¸å¿ƒæ´å¯Ÿ**ï¼šTopic é¡å‹å°ä¾†æºé‡ç–Šç‡çš„å½±éŸ¿**é å¤§æ–¼**ä¾†æºæœ¬èº«çš„æ’åºæ¼”ç®—æ³•å·®ç•°ã€‚

#### 9.14.4 æ•¸æ“šé©…å‹•çš„è¨­è¨ˆæ”¹é€²å»ºè­°

##### æ”¹é€² #1ï¼šä¾†æºè§’è‰²åˆ†é¡ (Source Roles)

åŸºæ–¼å¯¦é©—æ•¸æ“šï¼Œ6 å€‹ä¾†æºæ‡‰åˆ†ç‚ºä¸‰ç¨®è§’è‰²ï¼š

```python
SOURCE_ROLES = {
    # Primary Search â€” åƒèˆ‡ RRF èåˆæ’åº
    "pubmed": "primary",            # MeSH+BestMatch, æœ€å®Œæ•´
    "semantic_scholar": "primary",  # SPECTER èªæ„æ’åº
    "openalex": "primary",         # å¿«é€Ÿ, é«˜ DOI è¦†è“‹
    "europe_pmc": "primary",       # å…¨æ–‡æœå°‹, é«˜ PMID/Abstract

    # Supplementary â€” åƒèˆ‡ RRF ä½†é™æ¬Š
    "core": "supplementary",       # é–‹æ”¾å–ç”¨, DOI 67%, PMID 15%

    # Metadata Enrichment â€” ä¸åƒèˆ‡ RRF
    "crossref": "enrichment",      # DOI 100% ä½†ç„¡ PMID, æ’åºåŸºæ–¼å…ƒè³‡æ–™
}
```

**ç†ç”±**ï¼šCrossRef çš„ã€Œæ’åºã€æ˜¯åŸºæ–¼å…ƒè³‡æ–™æ–‡å­—åŒ¹é…ï¼Œä¸æ˜¯å­¸è¡“ relevance rankingã€‚å…¶ 80.7% ç¨å®¶ç‡æ›´å¯èƒ½åæ˜ çš„æ˜¯ã€Œæ‰¾åˆ°äº†å…¶ä»–ä¾†æºæ²’ç´¢å¼•çš„éå­¸è¡“æˆ–é‚Šç·£æ–‡ç»ã€è€Œéã€Œæ‰¾åˆ°äº†è¢«éºæ¼çš„é‡è¦è«–æ–‡ã€ã€‚

##### æ”¹é€² #2ï¼šTopic-Adaptive Alpha

éœæ…‹ `alpha=0.6` ç„¡æ³•é©æ‡‰çª„/å¯¬é ˜åŸŸçš„æ¥µç«¯å·®ç•°ï¼ˆJaccard å·® 9 å€ï¼‰ã€‚

```python
def compute_adaptive_alpha(
    uid_sets: dict[str, set[str]],
    base_alpha: float = 0.6,
) -> float:
    """æ ¹æ“šå¯¦éš›è§€æ¸¬çš„ä¾†æºé‡ç–Šç‡å‹•æ…‹èª¿æ•´ RRF vs Quality æ¬Šé‡

    é«˜é‡ç–Š â†’ ä¾†æºæœ‰å…±è­˜ â†’ ä¿¡ä»» RRF (alpha â†‘)
    ä½é‡ç–Š â†’ ä¾†æºå„è‡ªç¨ç«‹ â†’ ä¿¡ä»»å“è³ªæ’åº (alpha â†“)
    """
    # è¨ˆç®— primary source é–“çš„å¹³å‡ pairwise Jaccard
    primary_sources = [s for s in uid_sets if s in PRIMARY_SOURCES]
    if len(primary_sources) < 2:
        return base_alpha

    jaccards = []
    for i in range(len(primary_sources)):
        for j in range(i + 1, len(primary_sources)):
            a, b = uid_sets[primary_sources[i]], uid_sets[primary_sources[j]]
            if a and b:
                jaccards.append(len(a & b) / len(a | b))

    if not jaccards:
        return base_alpha

    avg_jaccard = sum(jaccards) / len(jaccards)

    # æ˜ å°„: Jaccard 0.0-0.5 â†’ alpha 0.4-0.85
    #   ä½é‡ç–Š (å¯¬Topic): avg_j â‰ˆ 0.05 â†’ alpha â‰ˆ 0.45 (å“è³ªä¸»å°)
    #   é«˜é‡ç–Š (çª„Topic): avg_j â‰ˆ 0.40 â†’ alpha â‰ˆ 0.76 (RRF ä¸»å°)
    alpha = base_alpha + (avg_jaccard - 0.1) * 0.9
    return max(0.3, min(0.9, alpha))  # clamp to [0.3, 0.9]
```

**å¯¦é©—æ•¸æ“šæ ¡æº–**:

| Topic é¡å‹ | avg Jaccard | Adaptive Alpha | èªæ„ |
|-----------|:-----------:|:--------------:|------|
| T2 çª„é ˜åŸŸ | ~0.30 | **0.78** | RRF å…±è­˜å¯é  |
| T3 å‰æ²¿é ˜åŸŸ | ~0.08 | **0.48** | å“è³ªæ’åºæ›´é‡è¦ |
| T1 å¯¬é ˜åŸŸ | ~0.05 | **0.45** | å„ä¾†æºç¨ç«‹åˆ¤æ–· |

##### æ”¹é€² #3ï¼šGems å“è³ªé–€æª»

ç•¶æ‰€æœ‰ä¾†æº 50-94% ç¨å®¶æ™‚ï¼Œã€Œç¨å®¶ + Top-10ã€ä¸å¤ ç¯©é¸ï¼Œéœ€è¦å“è³ªä¿¡è™Ÿï¼š

```python
def is_quality_gem(
    article: UnifiedArticle,
    rank_in_source: int,
    source: str,
    current_year: int,
) -> bool:
    """åˆ¤æ–·ç¨å®¶æ–‡ç« æ˜¯å¦å€¼å¾—ä½œç‚º Gem æ¨è–¦"""
    # å¿…è¦æ¢ä»¶
    if rank_in_source > 10:
        return False

    # å“è³ªä¿¡è™Ÿ (è‡³å°‘æ»¿è¶³ 1 å€‹)
    quality_signals = [
        article.citation_count is not None and article.citation_count > 0,
        bool(article.abstract),
        article.year is not None and article.year >= current_year - 3,
        bool(article.doi),  # æœ‰ DOI è¡¨ç¤ºæ­£å¼å‡ºç‰ˆ
    ]

    # ä¾†æºä¿¡ä»»åº¦ (CrossRef/CORE éœ€è¦æ›´å¤šå“è³ªä¿¡è™Ÿ)
    min_signals = {
        "pubmed": 1,
        "semantic_scholar": 1,
        "openalex": 1,
        "europe_pmc": 1,
        "core": 2,         # DOI è¦†è“‹ä½ï¼Œéœ€è¦æ›´å¤šå“è³ªä¿¡è™Ÿ
        "crossref": 3,     # ä¸åƒèˆ‡ RRFï¼Œgems é–€æª»æ›´é«˜
    }

    return sum(quality_signals) >= min_signals.get(source, 2)
```

##### æ”¹é€² #4ï¼šEPMC æ‡‰ä½¿ç”¨ `result_type="core"`

å¯¦é©—æ­ç¤ºï¼šEPMC é è¨­ `result_type="lite"` ä¸åŒ…å« `abstractText`ã€‚
åœ¨ `unified_search` ç®¡ç·šä¸­å‘¼å« EPMC æ™‚æ‡‰æŒ‡å®š `result_type="core"` ä»¥å–å¾—å®Œæ•´å…ƒè³‡æ–™ã€‚

**å½±éŸ¿**ï¼šå»¶é²å¾ ~1.6s å¢è‡³ ~2.4s (+50%)ï¼Œä½†æ›ä¾† 88% abstract è¦†è“‹ç‡ï¼Œå°å“è³ªæ’åºè‡³é—œé‡è¦ã€‚

##### æ”¹é€² #5ï¼šBaseAPIClient å•Ÿç”¨ redirect è·Ÿéš¨

å·²ä¿®æ­£ `base_client.py`ï¼š`httpx.AsyncClient(follow_redirects=True)`ã€‚
å½±éŸ¿æ‰€æœ‰ 8 å€‹ç¹¼æ‰¿çš„ source clientï¼Œè§£æ±º CORE API 301 redirect å•é¡Œã€‚

##### æ”¹é€² #6ï¼šRRF æ¬Šé‡æ¨å°

æ”¾æ£„éœæ…‹æ¬Šé‡ç²¾ç¢ºæ¨å°ï¼ˆç¼ºä¹ ground truth æ¨™è¨»ï¼‰ï¼Œæ”¹ç”¨**é‹è¡Œæ™‚è‡ªé©æ‡‰**ï¼š

```python
SOURCE_BASE_WEIGHTS = {
    # åŸºç¤æ¬Šé‡ï¼ˆæ’åºæ¼”ç®—æ³•å“è³ª Ã— è³‡æ–™å®Œæ•´åº¦ / PubMed åŸºæº–ï¼‰
    "pubmed": 1.0,            # Gold standard
    "semantic_scholar": 0.85,  # SPECTER + é«˜é‡ç–Š
    "openalex": 0.85,         # é«˜è¦†è“‹ + å¿«é€Ÿ
    "europe_pmc": 0.70,       # å…¨æ–‡æœå°‹ + é«˜ Abstract (ä¿®æ­£å¾Œ)
    "core": 0.40,             # ä½ DOI (67%), ä½ PMID (15%)
    # crossref: ä¸åƒèˆ‡ RRF
}

def get_runtime_weights(
    uid_sets: dict[str, set[str]],
    base_weights: dict[str, float] = SOURCE_BASE_WEIGHTS,
) -> dict[str, float]:
    """æ ¹æ“šæœ¬æ¬¡æœå°‹çš„å¯¦éš›è¡¨ç¾å¾®èª¿æ¬Šé‡

    å¦‚æœæŸä¾†æºèˆ‡ â‰¥2 å€‹å…¶ä»–ä¾†æºæœ‰ overlap â†’ å®ƒåœ¨æœåŒä¸€ç©ºé–“ â†’ ç•¥å¾®å¢æ¬Š
    å¦‚æœæŸä¾†æºå®Œå…¨ç¨å®¶ â†’ é™æ¬Šä½†ä¿ç•™åœ¨ gems ä¸­
    """
    adjusted = dict(base_weights)
    for source, uids in uid_sets.items():
        if source not in adjusted:
            continue
        overlap_count = 0
        for other_source, other_uids in uid_sets.items():
            if other_source != source and other_source in adjusted:
                if uids & other_uids:
                    overlap_count += 1
        if overlap_count >= 2:
            adjusted[source] = min(1.0, adjusted[source] * 1.1)
        elif overlap_count == 0:
            adjusted[source] *= 0.8
    return adjusted
```

#### 9.14.5 å¯¦é©—å±€é™æ€§

1. **æ¨£æœ¬é‡å°**ï¼šåƒ… 5 å€‹ topicï¼Œç„¡æ³•åšçµ±è¨ˆé¡¯è‘—æ€§æª¢å®š
2. **ç„¡ ground truth**ï¼šç„¡æ³•è©•ä¼°ç¨å®¶æ–‡ç« çš„ã€ŒçœŸæ­£ç›¸é—œæ€§ã€ï¼ˆH2 æœªé©—è­‰ï¼‰
3. **API ä¸ç©©å®š**ï¼šSemantic Scholar é »ç¹ 429ï¼ŒCORE çµæœæ•¸é‡æ³¢å‹•å¤§ (12-30)
4. **æ™‚åºä¾è³´**ï¼šæœå°‹çµæœæœƒéš¨æ™‚é–“æ”¹è®Šï¼ˆæ–°æ–‡ç« ç´¢å¼•ã€æ’åºæ¼”ç®—æ³•æ›´æ–°ï¼‰
5. **æœªæ¸¬è©¦é å°æœ¬**ï¼šå°šæœªåŠ å…¥ arXiv/medRxiv/bioRxiv é å°æœ¬ä¾†æº

#### 9.14.6 å¾ŒçºŒè¡Œå‹•

| # | è¡Œå‹• | ç‹€æ…‹ | å°æ‡‰æ”¹é€² |
|---|------|:----:|---------|
| 1 | `BaseAPIClient` åŠ  `follow_redirects=True` | âœ… å®Œæˆ | #5 |
| 2 | CORE client åŠ  zero-result warning log | âœ… å®Œæˆ | #5 |
| 3 | å¯¦ä½œ `compute_adaptive_alpha()` | å¾… Fusion Engine å¯¦ä½œæ™‚ | #2 |
| 4 | å¯¦ä½œ `is_quality_gem()` | å¾… Insight Categorizer å¯¦ä½œæ™‚ | #3 |
| 5 | CrossRef å¾ RRF ä¸­ç§»é™¤ | å¾… `unified_search` é‡æ§‹æ™‚ | #1 |
| 6 | EPMC search æ”¹ç”¨ `result_type="core"` | å¾…ç¢ºèªå»¶é²å½±éŸ¿ | #4 |
| 7 | Adaptive RRF weighting | å¾… Fusion Engine å¯¦ä½œæ™‚ | #6 |

### 9.15 å­¸è¡“ç ”ç©¶æ–¹æ³•è«–ï¼šå¦‚ä½•è­‰æ˜ã€Œæ›´å¥½ã€

> **å•é¡Œ**ï¼šå¦‚ä½•å¾å­¸è¡“è§’åº¦å¯¦ç¾ä¸€å€‹å¯é©—è­‰çš„æ›´å¥½çš„å­¸è¡“æœå°‹ MCPï¼Ÿ
> **æ—¥æœŸ**: 2026-02-15

#### 9.15.1 ç¾æœ‰ç”Ÿæ…‹ç³»çµ±èª¿æŸ¥

å° GitHub ä¸Š 59 å€‹ PubMed MCP repos + 43 å€‹ Scholar MCP repos çš„å®Œæ•´èª¿æŸ¥é¡¯ç¤ºï¼Œç¾æœ‰å­¸è¡“æœå°‹ MCP åˆ†ç‚ºä¸‰ç¨®æ¶æ§‹æ¨¡å¼ï¼Œ**æ²’æœ‰ä»»ä½•ä¸€å€‹åœ¨åšå¤šä¾†æºèåˆæ’åº**ï¼š

##### æ¨¡å¼ Aï¼šå–®ä¾†æºåŒ…è£å™¨ï¼ˆ90% çš„ reposï¼‰

| Repo | Stars | æ¶æ§‹ |
|------|:-----:|------|
| `andybrandt/mcp-simple-pubmed` | 156 | PubMed API è–„åŒ…è£ |
| `JackKuo666/Google-Scholar-MCP-Server` | 225 | Google Scholar è–„åŒ…è£ |
| `zongmin-yu/semantic-scholar-fastmcp-mcp-server` | 92 | S2 API è–„åŒ…è£ |
| `Darkroaster/pubmearch` | 144 | PubMed åˆ†æå‹ï¼ˆé—œéµè©è¶¨å‹¢ï¼‰ |
| `adityak74/mcp-scholarly` | 171 | Google Scholar è–„åŒ…è£ |

**å…±åŒé»**ï¼šä¸€å€‹ APIã€ä¸€å€‹ toolã€é›¶èåˆé‚è¼¯ã€‚

##### æ¨¡å¼ Bï¼šå¤šä¾†æºä½†ä¸èåˆï¼ˆã€Œäº¤çµ¦ Agent è‡ªå·±é¸ã€ï¼‰

| Repo | Stars | ä¾†æºæ•¸ | èåˆç­–ç•¥ |
|------|:-----:|:------:|---------|
| `Dianel555/paper-search-mcp-nodejs` | 95 | **14** | æ¯å€‹å¹³å°ä¸€å€‹ toolï¼›`platform="all"` æ™‚**éš¨æ©Ÿé¸ä¸€å€‹** |
| `afrise/academic-search-mcp-server` | 101 | 2 (S2+CrossRef) | å„ tool ç¨ç«‹ï¼Œä¸åˆä½µ |
| `JamesANZ/medical-mcp` | 58 | 4 (FDA+WHO+PubMed+Scholar) | å„ tool ç¨ç«‹ |

**è‡´å‘½å•é¡Œ**ï¼š14 å€‹å¹³å° Ã— 14 å€‹ tool = Agent éœ€è¦è‡ªå·±æ±ºå®šå‘¼å«å“ªå€‹ toolï¼Œç­‰åŒæ–¼æŠŠèåˆå•é¡Œä¸Ÿçµ¦ Agentã€‚Agent é€šå¸¸åªæœƒæŒ‘ 1-2 å€‹ä¾†æºå‘¼å«ï¼ŒéŒ¯éå…¶é¤˜ 12 å€‹ä¾†æºçš„ç¨å®¶æ–‡ç»ã€‚

##### æ¨¡å¼ Cï¼šæœ‰å»é‡ä½†æ¥µç°¡åŸå§‹ï¼ˆå…¨ GitHub å”¯ä¸€ï¼‰

| Repo | Stars | ä¾†æºæ•¸ | èåˆç­–ç•¥ |
|------|:-----:|:------:|---------|
| `Seelly/scholar_mcp_server` | 10 | 6 (Go) | DOI-only å»é‡ + å¼•ç”¨æ•¸æ’åº |

å¯¦éš›ç¨‹å¼ç¢¼ï¼ˆ`aggregator.go`ï¼‰ï¼š

```go
// å»é‡ï¼šDOI > æ¨™é¡Œï¼ˆæ¨™æº–åŒ–å¾Œï¼‰ï¼Œç„¡ cross-field matching
func generatePaperKey(paper) string {
    if paper.DOI != "" { return "doi:" + lower(paper.DOI) }
    if paper.Title != "" { return "title:" + lower(trim(paper.Title)) }
    return ""
}

// æ’åºï¼šå¼•ç”¨æ•¸ + é–‹æ”¾å–ç”¨çå‹µ 10 åˆ†ï¼Œç„¡ RRF
scoreI := papers[i].CitationCount
if papers[i].IsOpenAccess { scoreI += 10 }
```

**å•é¡Œ**ï¼šç„¡ RRFã€ç„¡ source weightingã€ç„¡ cross-field UID matchingã€ç„¡ adaptive åƒæ•¸ã€‚

##### å­¸è¡“ç ”ç©¶æ–¹é¢

| è«–æ–‡ | å¹´ä»½ | ç›¸é—œæ€§ |
|------|:----:|--------|
| Cormack et al. "RRF outperforms Condorcet" (SIGIR 2009) | 2009 | RRF åŸå§‹è«–æ–‡ï¼Œuniform weighting only |
| `ranx.fuse` (Bassani & Romelli, CIKM 2022) | 2022 | Python metasearch libraryï¼Œç”¨æ–¼åŒ corpus å¤šæ¨¡æ…‹èåˆ |
| Mmmorrf (Samuel et al., SIGIR 2025) | 2025 | Adaptive weighted RRFï¼Œä½†ç”¨æ–¼å½±ç‰‡æª¢ç´¢ |
| HySemRAG (Godinez, arXiv 2025) | 2025 | ç”¨ RRF èåˆå­¸è¡“æ–‡ç»ï¼Œä½†æœªåˆ†æ source overlap |
| Sun et al. (BMC Bioinformatics 2025) | 2025 | RRF for biomedical IRï¼ŒåŒä¸€ TREC è³‡æ–™é›† |
| MourÃ£o et al. "Inverse Square Rank Fusion" (2014) | 2014 | æ”¹é€² RRF å…¬å¼ï¼Œä»æ˜¯ uniform weighting |
| NovaSearch (TREC 2013 Federated Web Search) | 2013 | æœ€æ¥è¿‘ã€Œè¯é‚¦æœå°‹ã€ï¼Œä½†ç”¨æ–¼ web search |

**çµè«–**ï¼šæ²’æœ‰ä»»ä½•å·²ç™¼è¡¨ç ”ç©¶åŒæ™‚è™•ç† (1) è·¨å¤šå€‹å­¸è¡“è³‡æ–™åº«çš„ rank fusion with source-specific weighting, (2) query-dependent adaptive fusion, (3) source overlap åˆ†æä½œç‚ºæ¬Šé‡æ¨å°åŸºç¤, (4) ã€Œç¨å®¶ç™¼ç¾ã€(Gems) çš„è­˜åˆ¥ã€‚

#### 9.15.2 æ ¸å¿ƒé›£é¡Œï¼šGround Truth ä¸å­˜åœ¨

å­¸è¡“æœå°‹ä¸åƒ web search æœ‰ TREC/BEIR æ¨™æº– benchmarkã€‚æ ¹æœ¬å•é¡Œï¼š**æ²’æœ‰äººæ¨™è¨»éã€Œå°æ–¼ query Xï¼Œè·¨ 6 å€‹è³‡æ–™åº«çš„æœ€ä½³ Top-30 æ˜¯å“ªäº›è«–æ–‡ã€**ã€‚

å› æ­¤éœ€è¦**åŒæ™‚è§£æ±ºå…©å€‹å•é¡Œ**ï¼š
1. æå‡ºæ¯”ç¾æœ‰æ–¹æ¡ˆæ›´å¥½çš„èåˆæ¼”ç®—æ³•
2. è¨­è¨ˆä¸€å€‹å¯ä¿¡çš„è©•ä¼°æ–¹æ³•ä¾†è­‰æ˜ (1)

#### 9.15.3 ä¸‰å±¤è©•ä¼°æ–¹æ³•è«–

##### Layer 1ï¼šCitation-based Proxy Relevanceï¼ˆè‡ªå‹•åŒ–ã€å¤§è¦æ¨¡ï¼‰

**æ ¸å¿ƒæ´å¯Ÿ**ï¼šé«˜è¢«å¼• + è¿‘æœŸ + å¤šä¾†æºå…±è­˜çš„è«–æ–‡å¤§æ¦‚ç‡æ˜¯ç›¸é—œçš„ã€‚å¯æ§‹é€  pseudo-relevance judgmentsï¼š

```python
def compute_pseudo_relevance(article, query, current_year=2026):
    """åŸºæ–¼å®¢è§€ä¿¡è™Ÿä¼°è¨ˆæ–‡ç« ç›¸é—œæ€§ï¼ˆç„¡éœ€äººå·¥æ¨™è¨»ï¼‰"""
    signals = {
        # 1. å¼•ç”¨å½±éŸ¿åŠ›ï¼ˆRCR æ¯”åŸå§‹å¼•ç”¨æ•¸æ›´å…¬å¹³ï¼‰
        "rcr": min(article.relative_citation_ratio / 5.0, 1.0),

        # 2. æ¨™é¡Œ/æ‘˜è¦èˆ‡ query çš„èªæ„ç›¸ä¼¼åº¦
        "semantic_sim": cosine_sim(
            embed(query), embed(article.title + " " + article.abstract)
        ),

        # 3. æ™‚æ•ˆæ€§ï¼ˆé‡å°å¿«é€Ÿç™¼å±•é ˜åŸŸï¼‰
        "recency": max(0, 1 - (current_year - article.year) / 10),

        # 4. å…ƒè³‡æ–™å®Œæ•´åº¦ï¼ˆproxy for qualityï¼‰
        "completeness": sum([
            bool(article.doi), bool(article.abstract),
            bool(article.pmid), article.citation_count is not None
        ]) / 4,

        # 5. å¤šä¾†æºå…±è­˜ï¼ˆå‡ºç¾åœ¨è¶Šå¤šä¾†æº = è¶Šå¯èƒ½ç›¸é—œï¼‰
        "source_consensus": article.source_count / total_sources,
    }

    return (0.30 * signals["semantic_sim"] +
            0.25 * signals["rcr"] +
            0.20 * signals["source_consensus"] +
            0.15 * signals["recency"] +
            0.10 * signals["completeness"])
```

**å„ªé»**ï¼šå¯å¤§è¦æ¨¡è‡ªå‹•åŒ–ï¼ˆ1000+ queriesï¼‰ï¼Œå®Œå…¨å¯é‡ç¾ã€‚
**ç¼ºé»**ï¼šproxy â‰  true relevanceï¼Œéœ€åœ¨å°è¦æ¨¡ expert set ä¸Šé©—è­‰ã€‚

##### Layer 2ï¼šLLM-as-Judgeï¼ˆä¸­è¦æ¨¡ã€å¯æ“´å±•ï¼‰

```
æµç¨‹ï¼š
1. çµ¦ LLM (GPT-4/Claude) query + title + abstract
2. è¦æ±‚åˆ¤æ–· relevance (0-3 scale)
3. åœ¨ expert-annotated subset ä¸Šé©—è­‰ LLM åˆ¤æ–·çš„ä¸€è‡´æ€§
4. è‹¥ Cohen's Îº > 0.6ï¼Œå¯ä½œç‚ºå¤§è¦æ¨¡è©•ä¼°æ›¿ä»£
```

**å­¸è¡“ä¾æ“š**ï¼šThomas et al. (2024) "Large Language Models can Accurately Predict Searcher Preferences" (SIGIR 2024) å·²è­‰æ˜ LLM åœ¨ TREC-style relevance judgment ä¸Šèˆ‡äººé¡ annotator ä¸€è‡´æ€§é” Îº â‰ˆ 0.6-0.7ã€‚

**æˆæœ¬ä¼°ç®—**ï¼š7500 ç¯‡ Ã— ~$0.01/åˆ¤æ–· â‰ˆ $75ã€‚

##### Layer 3ï¼šExpert Annotationï¼ˆå°è¦æ¨¡ã€Gold Standardï¼‰

```
è¨­è¨ˆæµç¨‹ï¼š
1. é¸ 30-50 å€‹ queryï¼ˆè¦†è“‹çª„/å¯¬/è·¨å­¸ç§‘/å‰æ²¿/ç¶“å…¸ï¼‰
2. æ¯å€‹ query å¾ 6 ä¾†æºå„å– Top-30 â†’ åˆä½µå»é‡ â†’ ~120-150 ç¯‡/query
3. é‚€è«‹ 3+ ä½é ˜åŸŸå°ˆå®¶å°æ¯ç¯‡æ¨™è¨» relevance (0-3 scale)
4. è¨ˆç®— Fleiss' Îº (inter-annotator agreement)
5. ç”¨æ¨™è¨»çµæœç®— nDCG@k, MAP, Precision@k
```

**ç”¨é€”**ï¼šé©—è­‰ Layer 1 å’Œ Layer 2 çš„ proxy æœ‰æ•ˆæ€§ã€‚

#### 9.15.4 æ¼”ç®—æ³•å‰µæ–°é»

##### å‰µæ–° 1ï¼šSource-Aware Reciprocal Rank Fusion (SA-RRF)

åŸå§‹ RRF (Cormack 2009)ï¼š

```
RRF(d) = Î£_{sâˆˆS} 1/(k + rank_s(d))
```

SA-RRFï¼š

```
SA-RRF(d) = Î£_{sâˆˆS} w_s(q) Â· 1/(k + rank_s(d))
```

å…¶ä¸­ w_s(q) = w_s^base Â· Ï†_s(q)ï¼ŒÏ†_s(q) æ˜¯ä¾†æº s å° query q çš„ã€Œèƒ½åŠ›ä¼°è¨ˆã€ï¼š

- è©²ä¾†æºè¿”å›çš„çµæœæ•¸é‡ï¼ˆnormalizedï¼‰
- è¿”å›çµæœçš„å…ƒè³‡æ–™å®Œæ•´åº¦
- è©²ä¾†æºèˆ‡å…¶ä»–ä¾†æºçš„ overlap ç¨‹åº¦

**å­¸è¡“æ–°ç©æ€§**ï¼šRRF åŸå§‹è«–æ–‡åªè­‰æ˜ uniform weightingã€‚Mmmorrf (SIGIR 2025) åœ¨å½±ç‰‡æª¢ç´¢åšäº† adaptive weightingï¼Œä½†æ²’æœ‰äººåœ¨è·¨å­¸è¡“è³‡æ–™åº«å ´æ™¯åšéã€‚

##### å‰µæ–° 2ï¼šTopic-Adaptive Fusion Parameter

```
Î±*(q) = f( avg_pairwise_jaccard(S_1(q), S_2(q), ..., S_n(q)) )
```

**ç›´è¦º**ï¼š
- é«˜ overlapï¼ˆçª„é ˜åŸŸï¼‰â†’ ä¾†æºæœ‰å…±è­˜ â†’ ä¿¡ä»» RRF â†’ Î± â†‘
- ä½ overlapï¼ˆå¯¬é ˜åŸŸï¼‰â†’ ä¾†æºå„è‡ªç¨ç«‹ â†’ ä¿¡ä»» quality signals â†’ Î± â†“

Â§9.14 å¯¦é©—æ•¸æ“šï¼šT2 remimazolam Jaccard=0.481 vs T1 ML cancer=0.053ï¼Œå·® 9 å€ã€‚

##### å‰µæ–° 3ï¼šSource Complementarity Analysis Framework

ç´”åˆ†æè²¢ç»ï¼šå° 6 å€‹å­¸è¡“è³‡æ–™åº«åœ¨ N å€‹ query ä¸Šç³»çµ±æ€§é‡åŒ– overlapã€exclusivity rateã€metadata qualityï¼Œå»ºç«‹ã€Œä¾†æºèƒ½åŠ›çŸ©é™£ã€ã€‚

æœ¬èº«å³æœ‰åƒ¹å€¼çš„ benchmark contributionï¼Œé¡ä¼¼ BEIR å° retrieval model çš„è²¢ç»ã€‚

#### 9.15.5 å¯¦é©—è¨­è¨ˆ

##### A. Baselines

| ID | Baseline | æè¿° | ä»£è¡¨ |
|----|----------|------|------|
| B1 | Single-PubMed | åªç”¨ PubMed | 90% ç¾æœ‰ MCP |
| B2 | Best-Single | Oracle é¸æœ€å¥½çš„å–®ä¸€ä¾†æº | ç†è«–ä¸Šé™ |
| B3 | Naive Merge | åˆä½µå»é‡ + å¼•ç”¨æ•¸æ’åº | Seelly/scholar_mcp_server |
| B4 | Standard RRF | k=60, uniform weights | Cormack 2009 |
| B5 | LLM-Orchestrated | è®“ Agent é¸ tool | paper-search-mcp-nodejs å“²å­¸ |
| P1 | SA-RRF | Source-Aware RRF | æœ¬ç ”ç©¶ |
| P2 | SA-RRF + Adaptive Î± | å®Œæ•´æ–¹æ³• | æœ¬ç ”ç©¶ |

##### B. Query Set è¨­è¨ˆ

```
ä¾†æºï¼š
- 30 queries from systematic review protocols (Cochrane Library PICO)
- 30 queries from trending topics (NIH Reporter è¿‘æœŸè³‡åŠ©)
- 30 queries from cross-disciplinary topics (äººå·¥æ§‹é€ )
- 10 edge cases (very narrow / very broad / non-English terms)

æ¯å€‹ query æ¨™è¨»ï¼š
- Domain (bio/cs/chem/interdisciplinary)
- Specificity (narrow/medium/broad)
- Temporal profile (established/emerging/declining)
```

##### C. Metrics

| Metric | è¡¡é‡ä»€éº¼ | è¨ˆç®—æ–¹å¼ |
|--------|---------|---------|
| nDCG@10/20/50 | æ’åºå“è³ª | éœ€è¦ relevance judgments |
| Unique Relevant@k | èåˆç™¼ç¾çš„ç¨å®¶ç›¸é—œæ–‡ç« æ•¸ | è·¨ä¾†æºæ¯”è¼ƒ |
| Coverage | å¬å›äº†å¤šå°‘ ground truth ç›¸é—œæ–‡ç«  | Expert set |
| Diversity | çµæœçš„ä¸»é¡Œå¤šæ¨£æ€§ | Topic model entropy |
| Freshness | æ˜¯å¦åŒ…å«æœ€æ–°ç ”ç©¶ | Median publication year |
| Source Utilization | æ¯å€‹ä¾†æºå°æœ€çµ‚çµæœçš„è²¢ç» | ä½”æ¯”åˆ†æ |
| Latency | å¯¦ç”¨æ€§ | Wall clock time |

##### D. Statistical Rigor

- Paired t-test / Wilcoxon signed-rank testï¼ˆæ¯å€‹ query æ˜¯ paired sampleï¼‰
- Bonferroni correctionï¼ˆå¤šé‡æ¯”è¼ƒï¼‰
- Effect size (Cohen's d)
- 100 queries Ã— 7 methods = 700 runs â†’ è¶³å¤ çµ±è¨ˆåŠŸæ•ˆ
- Ablation studyï¼šé€ä¸€ç§»é™¤ SA-RRF çµ„ä»¶è§€å¯Ÿå½±éŸ¿

#### 9.15.6 ç™¼è¡¨è·¯ç·š

| è·¯ç·š | ç›®æ¨™ | å…§å®¹ | å·¥ä½œé‡ |
|------|------|------|--------|
| A: Systems Paper | JCDL / ECIR / CIKM resource track | å®Œæ•´ç³»çµ± + SA-RRF + ä¸‰å±¤è©•ä¼° | 3-4 å€‹æœˆ |
| B: Short Paper | JCDL Workshop / BIR@ECIR | åªåš Source Complementarity Analysis | 4-6 é€± |
| C: Benchmark | AcademicFuse benchmark (HuggingFace/Zenodo) | 100 queries + expert judgments + baselines | 2-3 å€‹æœˆ |

#### 9.15.7 æœ€å°å¯è¡Œå¯¦é©— (MVP)

```
Step 1: æ“´å¤§ query setï¼ˆ5 â†’ 50ï¼‰ï¼Œç”¨ Cochrane PICO åš seed
Step 2: è·‘ 50 queries Ã— 6 sources Ã— Top-50ï¼ˆ~300 API callsï¼‰
Step 3: LLM-as-Judge æ¨™è¨» relevanceï¼ˆ~7500 ç¯‡ Ã— $0.01 â‰ˆ $75ï¼‰
Step 4: éš¨æ©ŸæŠ½ 200 ç¯‡è‡ªå·±æ¨™è¨»ï¼Œé©—è­‰ LLM ä¸€è‡´æ€§
Step 5: è·‘ 7 baselines + ablationï¼Œæ¯”è¼ƒ nDCG@10, Coverage
Step 6: çµ±è¨ˆé¡¯è‘—æ€§æª¢å®š + å¯« paper
é è¨ˆæ™‚é–“ï¼š2-3 é€±æœ‰åˆæ­¥çµæœï¼Œ1-2 å€‹æœˆå¯æäº¤
```

### 9.16 Agent-Centric Designï¼šMCP æœå°‹çš„æ ¹æœ¬ä¸åŒ

> **æ ¸å¿ƒè§€å¯Ÿ**ï¼šMCP çš„ä½¿ç”¨è€…ä¸æ˜¯äººé¡ï¼Œæ˜¯ AI Agentã€‚
> é€™æ ¹æœ¬æ€§åœ°æ”¹è®Šäº†æœå°‹ç³»çµ±çš„è¨­è¨ˆç›®æ¨™ã€‚

#### 9.16.1 Agent â‰  Humanï¼šæœå°‹æ¶ˆè²»è€…çš„å·®ç•°

å‚³çµ±å­¸è¡“æœå°‹å¼•æ“ï¼ˆPubMedã€Google Scholarï¼‰ç‚ºäººé¡è¨­è¨ˆï¼š

```
Human User:
- èƒ½ç€è¦½ 10 é çµæœï¼Œè‡ªå·±åˆ¤æ–·ç›¸é—œæ€§
- èƒ½è®€æ¨™é¡Œ+æ‘˜è¦ï¼Œå¿«é€Ÿç¯©é¸
- æœ‰é ˜åŸŸçŸ¥è­˜ï¼Œèƒ½è¾¨åˆ¥ä½å“è³ª/é‚Šç·£çµæœ
- æœƒç”¨ç¯©é¸å™¨ï¼ˆå¹´ä»½ã€æœŸåˆŠã€æ–‡ç« é¡å‹ï¼‰è¿­ä»£æœå°‹
- èƒ½å®¹å¿å‡é™½æ€§ï¼ˆè·³éä¸ç›¸é—œæ–‡ç« æˆæœ¬æ¥µä½ï¼‰

AI Agent:
- åªçœ‹ä¸€æ¬¡çµæœï¼Œé€šå¸¸å– Top-10~30
- æ²’æœ‰æ·±å±¤é ˜åŸŸçŸ¥è­˜ï¼Œå®¹æ˜“è¢«å‡é™½æ€§èª¤å°  
- æœƒæŠŠæœå°‹çµæœç›´æ¥æ‘˜è¦çµ¦æœ€çµ‚ä½¿ç”¨è€…
- Token æœ‰é™ï¼Œå¤§æµ·æ’ˆé‡çš„æˆæœ¬æ˜¯ä¸Šä¸‹æ–‡æ±¡æŸ“
- ç„¡æ³•è‡ªä¸»åˆ¤æ–·ã€Œé€™ç¯‡å€¼ä¸å€¼å¾—æ·±å…¥ã€
- æœå°‹ä¸€æ¬¡å°±èµ°ï¼Œå¾ˆå°‘åš iterative refinement
```

#### 9.16.2 æ ¸å¿ƒå•é¡Œï¼šä¸Šä¸‹æ–‡æ±¡æŸ“ (Context Pollution)

Agent çš„æ ¹æœ¬é™åˆ¶ä¸æ˜¯ã€Œæ‰¾ä¸åˆ°å¥½æ–‡ç« ã€ï¼Œè€Œæ˜¯**å¥½æ–‡ç« è¢«æ·¹æ²’åœ¨é›œè¨Šä¸­**ã€‚

```
æƒ…å¢ƒé‡ç¾ï¼š

Agent å‘¼å« unified_search("remimazolam ICU sedation")
â†’ è¿”å› 30 ç¯‡æ–‡ç« 
â†’ Agent çš„å¯ç”¨ context window è¢« 30 ç¯‡æ–‡ç« çš„ metadata ä½”æ“š
â†’ å…¶ä¸­ 5 ç¯‡é«˜åº¦ç›¸é—œï¼Œ10 ç¯‡ç•¥ç›¸é—œï¼Œ15 ç¯‡å™ªéŸ³

çµæœï¼šAgent åœ¨æ‘˜è¦æ™‚æŠŠä¸å¤ªç›¸é—œçš„æ–‡ç« ä¹Ÿæ··å…¥å›ç­”
â†’ æœ€çµ‚ä½¿ç”¨è€…çœ‹åˆ°çš„æ˜¯è¢«å™ªéŸ³ç¨€é‡‹çš„å›ç­”
```

**é€™å°±æ˜¯ã€Œåœ¨ä¸åŒçš„å¤§æµ·ä¸­æ’ˆé‡ã€å•é¡Œ**ï¼š6 å€‹ä¾†æºå„è¿”å› 30 ç¯‡ = 180 ç¯‡å€™é¸ï¼ŒAgent çš„ context window æ‰¿å—ä¸äº†ï¼Œä½†ç°¡å–®æˆªæ–· Top-30 åˆå¯èƒ½éºæ¼æŸä¾†æºçš„ç¨å®¶é‡è¦ç™¼ç¾ã€‚

#### 9.16.3 Agent-Centric è¨­è¨ˆåŸå‰‡

##### åŸå‰‡ 1ï¼šSignal-to-Noise Ratio (SNR) æœ€å¤§åŒ–

> æœå°‹ç³»çµ±çš„ç›®æ¨™ä¸æ˜¯ã€Œå¬å›ç‡æœ€é«˜ã€ï¼Œè€Œæ˜¯**åœ¨ Agent çš„æœ‰é™ context budget å…§ï¼Œæœ€å¤§åŒ–æœ‰ç”¨è³‡è¨Šå¯†åº¦**ã€‚

```python
# å‚³çµ±ç›®æ¨™ï¼ˆäººé¡å„ªå…ˆï¼‰
maximize Recall@100  # è¶Šå¤šè¶Šå¥½ï¼Œäººé¡æœƒè‡ªå·±ç¯©

# Agent-Centric ç›®æ¨™
maximize Precision@k * Diversity@k  # åœ¨ k ç¯‡å…§ï¼Œæœ€å¤§åŒ–ç›¸é—œä¸”å¤šæ¨£
subject to k â‰¤ context_budget       # k å— Agent context window é™åˆ¶
```

**é‡åŒ– context budget**ï¼š

```
Agent å¯ç”¨ context â‰ˆ 128K tokens (Claude) / 128K (GPT-4o)
æ¯ç¯‡æ–‡ç«  metadata (title + authors + abstract + doi + year) â‰ˆ 300-500 tokens
ç³»çµ± prompt + instruction + ä¹‹å‰å°è©± â‰ˆ 10K-50K tokens
å¯ç”¨æ–¼æœå°‹çµæœçš„ç©ºé–“ â‰ˆ 30K-80K tokens
â†’ æœ‰æ•ˆæ‰¿è¼‰é‡ â‰ˆ 60-160 ç¯‡æ–‡ç« 

ä½† Agent çš„æ³¨æ„åŠ›é›†ä¸­åº¦é ä½æ–¼ context window å¤§å°ï¼š
å¯¦å‹™è§€å¯Ÿï¼šAgent é€šå¸¸åªæœ‰æ•ˆè™•ç† Top-10~20 ç¯‡çš„è³‡è¨Š
```

##### åŸå‰‡ 2ï¼šçµæ§‹åŒ–ä¿¡è™Ÿå„ªæ–¼åŸå§‹ç¾…åˆ—

Agent ä¸åƒäººé¡å¯ä»¥ã€Œæƒä¸€çœ¼æ¨™é¡Œå°±çŸ¥é“ç›¸ä¸ç›¸é—œã€ã€‚Agent éœ€è¦**æ˜ç¢ºçš„æ’åºä¿¡è™Ÿ**ï¼š

```python
# âŒ å‚³çµ±æ–¹å¼ï¼šä¸Ÿä¸€å †æ–‡ç« è®“ Agent è‡ªå·±åˆ¤æ–·
return [article1, article2, ..., article30]  # å…¨éƒ¨å¹³ç­‰å‘ˆç¾

# âœ… Agent-Centricï¼šåˆ†å±¤ + æ¨™è¨˜ + çµæ§‹åŒ–
return {
    "high_confidence": [       # å¤šä¾†æºå…±è­˜ + é«˜å“è³ªä¿¡è™Ÿ
        {"article": a1, "why": "ranked top-5 in 3/6 sources, RCR=8.2"},
        {"article": a2, "why": "ranked top-3 in PubMed+S2, 2025 review"},
    ],
    "source_gems": [           # ç¨å®¶ç™¼ç¾ä½†é«˜å“è³ª
        {"article": a3, "source": "CORE", "why": "only in CORE, OA preprint, 2025"},
    ],
    "supporting": [            # è£œå……æ€§çµæœ
        {"article": a4, "why": "related but lower confidence"},
    ],
    "meta_insights": {         # Agent å¯ä»¥ç›´æ¥å¼•ç”¨çš„æ´å¯Ÿ
        "topic_type": "narrow_niche",
        "source_agreement": "high (Jaccard=0.48)",
        "recommendation": "5 high-consensus papers + 2 unique gems from CORE"
    }
}
```

##### åŸå‰‡ 3ï¼šFusion å³æ˜¯æ‘˜è¦å‰è™•ç†

> æŠŠ RRF Fusion æƒ³æˆ Agent çš„ã€Œå‰é¡è‘‰çš®å±¤ã€â€” åœ¨è³‡è¨Šé€²å…¥ Agent çš„ã€Œå·¥ä½œè¨˜æ†¶ã€(context window) ä¹‹å‰ï¼Œå…ˆåšå¥½ç¯©é¸ã€æ’åºã€å»å™ªã€‚

```
å‚³çµ± IR pipeline:
  Query â†’ Retrieve â†’ Rank â†’ [Return to User]
                                    â†“
                              User è‡ªå·±çœ‹

Agent-Centric pipeline:
  Query â†’ Retrieve â†’ Rank â†’ Fuse â†’ Filter â†’ Structure â†’ [Return to Agent]
                                                              â†“
                                                        Agent ç›´æ¥æ‘˜è¦
                                                              â†“
                                                        æœ€çµ‚ä½¿ç”¨è€…çœ‹åˆ°

   ^^^^^^^^^^^^^^^^          ^^^^^^^^^^^^^^^^^^^^^^^^
   Server ç«¯è² è²¬              æ–°å¢çš„ Agent-Centric å±¤
   ï¼ˆå’Œå‚³çµ±ä¸€æ¨£ï¼‰              ï¼ˆæ¸›å°‘ Agent èªçŸ¥è² æ“”ï¼‰
```

#### 9.16.4 Agent-Centric çš„å…·é«”è¨­è¨ˆæ”¹é€²

##### æ”¹é€² 1ï¼šConfidence-Tiered Resultsï¼ˆä¿¡å¿ƒåˆ†å±¤ï¼‰

ä¸å†è¿”å›ä¸€å€‹æ‰å¹³çš„ ranked listï¼Œè€Œæ˜¯**ä¸‰å±¤çµæ§‹**ï¼š

```python
class TieredResults:
    """Agent-Centric åˆ†å±¤çµæœ"""

    tier_1_consensus: list[RankedArticle]
    # å®šç¾©ï¼šå‡ºç¾åœ¨ â‰¥2 å€‹ primary source ä¸­ï¼Œä¸” SA-RRF score > P75
    # Agent æŒ‡å¼•ï¼šã€Œé€™äº›æ–‡ç« æœ‰é«˜åº¦å…±è­˜ï¼Œå¯ä»¥ç›´æ¥å¼•ç”¨ã€
    # æ•¸é‡ï¼šé€šå¸¸ 3-8 ç¯‡

    tier_2_gems: list[GemArticle]
    # å®šç¾©ï¼šåƒ…å‡ºç¾åœ¨ 1 å€‹ä¾†æºï¼Œä½†é€šéå“è³ªé–€æª» (is_quality_gem)
    # Agent æŒ‡å¼•ï¼šã€Œé€™äº›æ˜¯ç¨å®¶ç™¼ç¾ï¼Œå€¼å¾—æåŠä½†éœ€æ¨™è¨»ä¾†æºã€  
    # æ•¸é‡ï¼šé€šå¸¸ 2-5 ç¯‡

    tier_3_supporting: list[RankedArticle]
    # å®šç¾©ï¼šå…¶é¤˜é€šéåŸºæœ¬å“è³ªç¯©é¸çš„æ–‡ç« 
    # Agent æŒ‡å¼•ï¼šã€Œå¦‚éœ€æ›´å¤šç´°ç¯€å¯åƒè€ƒï¼Œå¦å‰‡å¯å¿½ç•¥ã€
    # æ•¸é‡ï¼šé€šå¸¸ 10-20 ç¯‡

    meta: SearchMeta
    # topic_type, source_agreement, confidence_level, suggested_citation_count
```

**ç‚ºä»€éº¼é€™å° Agent é‡è¦**ï¼š

| è¨­è¨ˆ | Agent è¡Œç‚º | æœ€çµ‚ä½¿ç”¨è€…çš„é«”é©— |
|------|-----------|----------------|
| æ‰å¹³ 30 ç¯‡ | Agent å˜—è©¦æ‘˜è¦æ‰€æœ‰ 30 ç¯‡ï¼Œæ··å…¥å™ªéŸ³ | ã€Œå›ç­”å¾ˆé•·ä½†é‡é»ä¸æ¸…æ¥šã€ |
| åˆ†å±¤çµæ§‹ | Agent å…ˆå¼•ç”¨ Tier-1ï¼Œé¸æ“‡æ€§æåŠ Tier-2 | ã€Œå›ç­”ç²¾ç¢ºä¸”æœ‰ç¨åˆ°ç™¼ç¾ã€ |

##### æ”¹é€² 2ï¼šAgent-Readable Annotationsï¼ˆæ©Ÿå™¨å¯è®€æ¨™è¨˜ï¼‰

æ¯ç¯‡æ–‡ç« é™„åŠ **æ˜ç¢ºçš„ä¿¡è™Ÿæ¨™è¨˜**ï¼Œæ¸›å°‘ Agent è‡ªè¡Œåˆ¤æ–·çš„èªçŸ¥è² æ“”ï¼š

```python
class ArticleAnnotation:
    """Agent å¯ç›´æ¥æ¶ˆè²»çš„æ–‡ç« æ¨™è¨˜"""

    relevance_signals: dict = {
        "source_count": 3,           # å‡ºç¾åœ¨å¹¾å€‹ä¾†æº
        "best_rank": 2,              # åœ¨æ‰€æœ‰ä¾†æºä¸­çš„æœ€ä½³æ’å
        "has_abstract": True,        # Agent èƒ½å¦æ‘˜è¦æ­¤æ–‡
        "citation_tier": "high",     # high(>50)/medium(10-50)/low(<10)/unknown
        "recency": "recent",         # recent(â‰¤2yr)/established(3-5yr)/classic(>5yr)
        "open_access": True,         # å…¨æ–‡æ˜¯å¦å¯å–å¾—
        "study_type": "RCT",         # RCT/Meta-analysis/Review/Cohort/Case/Other
    }

    agent_guidance: str = (
        "Multi-source consensus article. "
        "Ranked top-5 in PubMed, S2, OpenAlex. "
        "2025 RCT with high RCR. Safe to cite."
    )
```

**é—œéµå·®åˆ¥**ï¼šäººé¡çœ‹åˆ° `citation_count=47` æœƒè‡ªå·±åˆ¤æ–·ã€Œé€™ç®—å¤šé‚„æ˜¯å°‘ã€ï¼ŒAgent ä¸æœƒã€‚çµ¦ Agent `citation_tier="high"` æ¯”çµ¦åŸå§‹æ•¸å­—æœ‰æ•ˆå¾—å¤šã€‚

##### æ”¹é€² 3ï¼šadaptive k â€” æ ¹æ“š topic é¡å‹èª¿æ•´è¿”å›æ•¸é‡

```python
def compute_optimal_k(
    topic_type: str,
    source_agreement: float,
    agent_context_budget: int = 30,
) -> dict[str, int]:
    """æ ¹æ“š topic ç‰¹æ€§æ±ºå®šå„å±¤è¿”å›å¤šå°‘ç¯‡

    çª„é ˜åŸŸä¸”é«˜å…±è­˜ â†’ å°‘è€Œç²¾ï¼ˆAgent ä¸éœ€è¦çœ‹å¾ˆå¤šï¼‰
    å¯¬é ˜åŸŸä¸”ä½å…±è­˜ â†’ å¤šè€Œå»£ï¼ˆæ¯å€‹ä¾†æºå¯èƒ½æœ‰ç¨å®¶ç™¼ç¾ï¼‰
    """

    if source_agreement > 0.3:  # çª„é ˜åŸŸ
        return {
            "tier_1_consensus": min(5, agent_context_budget // 3),
            "tier_2_gems": 2,
            "tier_3_supporting": 5,
            # ç¸½å…± ~12 ç¯‡ï¼Œç²¾ç°¡ä½†é«˜å“è³ª
        }
    elif source_agreement > 0.1:  # ä¸­é ˜åŸŸ
        return {
            "tier_1_consensus": min(8, agent_context_budget // 3),
            "tier_2_gems": 4,
            "tier_3_supporting": 10,
            # ç¸½å…± ~22 ç¯‡ï¼Œå¹³è¡¡
        }
    else:  # å¯¬é ˜åŸŸ
        return {
            "tier_1_consensus": min(10, agent_context_budget // 3),
            "tier_2_gems": 6,
            "tier_3_supporting": 14,
            # ç¸½å…± ~30 ç¯‡ï¼Œå»£æ³›è¦†è“‹
        }
```

##### æ”¹é€² 4ï¼šFusion Summary â€” Agent çš„æ±ºç­–æ”¯æ´

åœ¨æœå°‹çµæœä¹‹å‰æä¾›**ä¸€æ®µçµæ§‹åŒ–æ‘˜è¦**ï¼Œè®“ Agent ç„¡éœ€éæ­·æ‰€æœ‰æ–‡ç« å°±èƒ½åšåˆæ­¥åˆ¤æ–·ï¼š

```python
class FusionSummary:
    """æœå°‹çµæœçš„å…ƒæ‘˜è¦ â€” Agent è®€é€™æ®µå°±èƒ½æ±ºå®šæ€éº¼ç”¨çµæœ"""

    query_analysis: str
    # "æœå°‹ 'remimazolam ICU sedation' â€” çª„åˆ©åŸºä¸»é¡Œï¼Œ
    #  æ–‡ç»é›†ä¸­åœ¨ 2020-2026ï¼Œä»¥ RCT å’Œç¶œè¿°ç‚ºä¸»"

    source_landscape: str
    # "6 ä¾†æºé«˜åº¦ä¸€è‡´ (Jaccard=0.48)ï¼ŒPubMed å’Œ S2 é‡ç–Š 48%ï¼Œ
    #  CORE æä¾› 3 ç¯‡ç¨å®¶é–‹æ”¾å–ç”¨é å°æœ¬"

    top_findings: list[str]
    # ["5 ç¯‡å¤šä¾†æºå…±è­˜æ–‡ç« ç¢ºèª remimazolam åœ¨ ICU é®éœçš„å®‰å…¨æ€§",
    #  "2 ç¯‡ CORE ç¨å®¶é å°æœ¬é¡¯ç¤ºæ–°çš„åŠ‘é‡èª¿æ•´æ–¹æ¡ˆ",
    #  "1 ç¯‡ 2025 meta-analysis æ¶µè“‹ 12 å€‹ RCT"]

    suggested_narrative: str
    # "å»ºè­°å¼•ç”¨ Tier-1 çš„ 5 ç¯‡å…±è­˜æ–‡ç« ä½œç‚ºä¸»è¦è­‰æ“šï¼Œ
    #  æåŠ Tier-2 çš„ CORE é å°æœ¬ä½œç‚ºæœ€æ–°é€²å±•ï¼Œ
    #  ç¸½å…±å¼•ç”¨ 7-8 ç¯‡å³å¯å…¨é¢å›ç­”"

    confidence_level: str  # "high" / "medium" / "low"
    # "high â€” å¤šä¾†æºé«˜åº¦ä¸€è‡´ï¼Œæ–‡ç»å……è¶³"
```

**ç‚º Agent è§£æ±ºçš„å•é¡Œ**ï¼š

| æ²’æœ‰ FusionSummary | æœ‰ FusionSummary |
|---|---|
| Agent é€ç¯‡é–±è®€ 30 ç¯‡ metadata | Agent å…ˆè®€æ‘˜è¦ï¼Œæ±ºå®šå¼•ç”¨ç­–ç•¥ |
| ä¸çŸ¥é“å“ªäº›ä¾†æºé‡è¦ | æ˜ç¢ºçŸ¥é“ä¾†æºé–“çš„é—œä¿‚ |
| ä¸çŸ¥é“è©²å¼•ç”¨å¹¾ç¯‡ | æœ‰å»ºè­°çš„å¼•ç”¨æ•¸é‡å’Œç­–ç•¥ |
| å¯èƒ½éåº¦å¼•ç”¨æˆ–å¼•ç”¨ä¸è¶³ | å¼•ç”¨æ•¸é‡é©åˆ topic è¦æ¨¡ |

#### 9.16.5 Agent-Centric è©•ä¼°æŒ‡æ¨™

å‚³çµ± IR metrics ä¸å®Œå…¨é©ç”¨æ–¼ Agent-Centric å ´æ™¯ã€‚éœ€è¦æ–°æŒ‡æ¨™ï¼š

##### Metric 1ï¼šAgent Answer Quality (AAQ)

```
æµç¨‹ï¼š
1. çµ¦ Agent æœå°‹çµæœï¼ˆbaseline vs æˆ‘å€‘çš„æ–¹æ³•ï¼‰
2. Agent åŸºæ–¼çµæœç”Ÿæˆå›ç­”
3. ç”± expert / LLM-judge è©•ä¼° Agent å›ç­”çš„å“è³ª

AAQ ç¶­åº¦ï¼š
- Accuracy: å›ç­”ä¸­çš„äº‹å¯¦æ˜¯å¦æ­£ç¢ºï¼Ÿ
- Completeness: æ˜¯å¦æ¶µè“‹äº†ä¸»è¦é¢å‘ï¼Ÿ
- Relevance: å¼•ç”¨çš„è«–æ–‡æ˜¯å¦çœŸçš„æ”¯æŒè«–é»ï¼Ÿ
- Specificity: å›ç­”æ˜¯å¦è¶³å¤ å…·é«”ï¼ˆvs æ³›æ³›è€Œè«‡ï¼‰ï¼Ÿ
- Noise Ratio: æœ‰å¤šå°‘å¼•ç”¨æ˜¯ä¸ç›¸é—œçš„å™ªéŸ³ï¼Ÿ
```

**é€™æ˜¯æœ€è‡´å‘½çš„æŒ‡æ¨™**ï¼šä¸ç®¡ nDCG å¤šé«˜ï¼Œå¦‚æœ Agent ç”¨ä½ çš„çµæœç”Ÿæˆçš„å›ç­”æ¯”ç”¨ PubMed å–®ä¾†æºçš„é‚„å·®ï¼Œå°±æ²’æœ‰æ„ç¾©ã€‚

##### Metric 2ï¼šContext Efficiency (CE)

```
CE = (Agent å›ç­”ä¸­æ­£ç¢ºå¼•ç”¨çš„æ–‡ç« æ•¸) / (è¿”å›çµ¦ Agent çš„æ–‡ç« ç¸½æ•¸)

ç†æƒ³æƒ…æ³ï¼šCE â†’ 1.0ï¼ˆæ¯ç¯‡è¿”å›çš„æ–‡ç« éƒ½è¢«æœ‰æ•ˆä½¿ç”¨ï¼‰
ç¾å¯¦ä¸­ï¼šCE â‰ˆ 0.2-0.3ï¼ˆå¤§éƒ¨åˆ†çµæœæ˜¯å™ªéŸ³ï¼‰
ç›®æ¨™ï¼šCE â‰¥ 0.5ï¼ˆè‡³å°‘ä¸€åŠçš„çµæœè¢«æœ‰æ•ˆä½¿ç”¨ï¼‰
```

##### Metric 3ï¼šUnique Discovery Rate (UDR)

```
UDR = (Agent å¼•ç”¨çš„ä¾†è‡ªé PubMed ä¾†æºçš„ç›¸é—œæ–‡ç« æ•¸) / (Agent ç¸½å¼•ç”¨æ•¸)

å¦‚æœ UDR â‰ˆ 0ï¼šå¤šä¾†æºæœå°‹æ¯«ç„¡æ„ç¾©ï¼ŒPubMed å°±å¤ äº†
å¦‚æœ UDR > 0.2ï¼šå¤šä¾†æºæœå°‹æˆåŠŸå¸¶ä¾†äº†ã€Œå¦å‰‡ä¸æœƒè¢«ç™¼ç¾çš„æ–‡ç« ã€
```

##### Metric 4ï¼šCognitive Load Reduction (CLR)

```
CLR = 1 - (Agent ç”Ÿæˆå›ç­”æ‰€æ¶ˆè€—çš„ tokens) / (Baseline çš„ tokens)

å¦‚æœ CLR > 0ï¼šæˆ‘å€‘çš„çµæ§‹åŒ–çµæœè®“ Agent æ›´é«˜æ•ˆ
å¦‚æœ CLR < 0ï¼šçµæ§‹å¤ªè¤‡é›œåè€Œå¢åŠ äº† Agent çš„è™•ç†è² æ“”
```

#### 9.16.6 Agent-Centric å¯¦é©—è¨­è¨ˆ

##### å¯¦é©— 1ï¼šEnd-to-End Agent Quality Test

```
Setup:
- 50 å€‹ medical questionsï¼ˆsourced from BioASQ / PubMedQAï¼‰
- 3 å€‹ Agent configurationsï¼š
    A: Agent + PubMed only (baseline)
    B: Agent + 6 sources, flat list (standard multi-source)
    C: Agent + 6 sources, tiered + FusionSummary (our method)

Evaluation:
- æ¯å€‹å•é¡Œç”± 3 ä½é†«å­¸ç”Ÿè©•åˆ† (1-5 scale)
- ç¶­åº¦ï¼šaccuracy, completeness, citation quality
- çµ±è¨ˆï¼špaired Wilcoxon test on mean scores
```

##### å¯¦é©— 2ï¼šContext Pollution Measurement

```
Setup:
- å– Experiment 1 çš„åŒä¸€çµ„ questions
- æ¸¬é‡ Agent å›ç­”ä¸­ï¼š
    - å¼•ç”¨äº†å¤šå°‘ä¸ç›¸é—œçš„æ–‡ç« ï¼ˆFalse Citation Rateï¼‰
    - éºæ¼äº†å¤šå°‘é‡è¦æ–‡ç« ï¼ˆMissed Citation Rateï¼‰
    - å›ç­”ä¸­æœ‰å¤šå°‘æ®µè½æ˜¯åŸºæ–¼å™ªéŸ³æ–‡ç« çš„ï¼ˆNoise Propagation Rateï¼‰

å‡è¨­ï¼š
- Tiered results æ‡‰é¡¯è‘—é™ä½ False Citation Rate
- FusionSummary æ‡‰é™ä½ Missed Citation Rate
```

##### å¯¦é©— 3ï¼šAblation â€” å“ªå€‹ Agent-Centric çµ„ä»¶æœ€é‡è¦ï¼Ÿ

```
Conditions:
C0: Flat list (no agent-centric features)
C1: + Tiered results
C2: + Article annotations
C3: + Adaptive k
C4: + FusionSummary
C5: All features (full method)

é æ¸¬ï¼š
- C4 (FusionSummary) æœƒå¸¶ä¾†æœ€å¤§çš„ AAQ æå‡
  ï¼ˆå› ç‚º Agent çš„ä¸»è¦ç“¶é ¸æ˜¯ã€Œä¸çŸ¥é“æ€éº¼ç”¨çµæœã€ï¼‰
- C1 (Tiered) æœƒå¸¶ä¾†æœ€å¤§çš„ CE æå‡
  ï¼ˆå› ç‚ºæ¸›å°‘äº† Agent éœ€è¦è™•ç†çš„å™ªéŸ³é‡ï¼‰
```

#### 9.16.7 èˆ‡ Â§9.15 å‚³çµ±è©•ä¼°çš„æ•´åˆ

å®Œæ•´è©•ä¼°æ¡†æ¶éœ€è¦**å…©å€‹ç¶­åº¦**ï¼š

```
                    å‚³çµ± IR è©•ä¼°          Agent-Centric è©•ä¼°
                    (Â§9.15)              (Â§9.16)
                    â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Level 1 (æ’åºå“è³ª)ï¼šnDCG@10              Agent Answer Quality
Level 2 (ç™¼ç¾èƒ½åŠ›)ï¼šUnique Relevant@k    Unique Discovery Rate
Level 3 (æ•ˆç‡)ï¼š   Latency              Context Efficiency
Level 4 (å¯¦ç”¨æ€§)ï¼š  Coverage             Cognitive Load Reduction
```

**è«–æ–‡ framing**ï¼š

> æˆ‘å€‘è­‰æ˜ SA-RRF ä¸åƒ…åœ¨å‚³çµ± IR æŒ‡æ¨™ä¸Šå„ªæ–¼ standard RRFï¼ˆnDCG@10 æå‡ X%ï¼‰ï¼Œ
> æ›´é—œéµçš„æ˜¯ï¼Œç•¶æœå°‹çµæœä»¥ agent-centric åˆ†å±¤çµæ§‹è¿”å›æ™‚ï¼Œ
> ä¸‹æ¸¸ AI Agent ç”Ÿæˆçš„å›ç­”å“è³ª (AAQ) æå‡äº† Y%ï¼Œ
> åŒæ™‚ä¸Šä¸‹æ–‡æ•ˆç‡ (CE) å¾ 0.23 æå‡è‡³ 0.51ã€‚

é€™æ¯”å–®ç´”å ±å‘Š nDCG çš„æå‡æœ‰æ›´å¼·çš„å¯¦éš›å½±éŸ¿åŠ›ã€‚

#### 9.16.8 é€™æ”¹è®Šäº†ä»€éº¼

å›åˆ°æœ€åˆçš„å•é¡Œï¼š**ã€Œä¸è¦åœ¨ä¸åŒçš„å¤§æµ·ä¸­æ‰¾åˆ°é‡ã€**

| å•é¡Œ | å‚³çµ±è§£æ³• | Agent-Centric è§£æ³• |
|------|---------|-------------------|
| 6 ä¾†æºå„ 30 ç¯‡ = 180 ç¯‡å€™é¸ | èåˆæ’åºå– Top-30 | åˆ†å±¤ï¼š5 å…±è­˜ + 3 Gems + 10 æ”¯æŒ |
| Agent ä¸çŸ¥é“å“ªç¯‡é‡è¦ | é æ’åï¼ˆä½† Agent ä¸ä¸€å®šä¿¡ä»»æ’åï¼‰ | æ¯ç¯‡é™„å¸¶ `agent_guidance` èªªæ˜ |
| Agent ä¸çŸ¥é“å¼•ç”¨å¹¾ç¯‡ | ç„¡æŒ‡å¼• | FusionSummary å»ºè­°å¼•ç”¨ç­–ç•¥ |
| ç¨å®¶æ–‡ç»è¢«æ·¹æ²’ | æ··åœ¨ Top-30 ä¸­ | Tier-2 Gems ç¨ç«‹å±•ç¤º |
| Topic é¡å‹å½±éŸ¿æœ€ä½³ç­–ç•¥ | å›ºå®š k=30 | Adaptive k æ ¹æ“šå…±è­˜åº¦èª¿æ•´ |
| è©•ä¼°åªçœ‹æ’åºå“è³ª | nDCG@k | nDCG + AAQ + CE + UDR |

**æ ¹æœ¬æ€ç¶­è½‰è®Š**ï¼š

```
å‚³çµ±æ€ç¶­ï¼šæœå°‹ç³»çµ±çš„å·¥ä½œåˆ°ã€Œè¿”å›æ’åºçµæœã€å°±çµæŸäº†ã€‚
Agent-Centric æ€ç¶­ï¼šæœå°‹ç³»çµ±çš„å·¥ä½œåˆ°ã€ŒAgent èƒ½æœ‰æ•ˆä½¿ç”¨çµæœã€æ‰çµæŸã€‚
```

é€™æ‰æ˜¯å­¸è¡“æœå°‹ MCP æ‡‰è©²è¦è§£æ±ºçš„çœŸæ­£å•é¡Œï¼šä¸æ˜¯ã€Œèƒ½æœåˆ°å¤šå°‘ã€ï¼Œè€Œæ˜¯**ã€ŒAgent èƒ½ç”¨å¤šå¥½ã€**ã€‚
